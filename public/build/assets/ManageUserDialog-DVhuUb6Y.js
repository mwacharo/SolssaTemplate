import{r as f,j as A,P as le,k as te,s as I,z as oe,l as s,c as C,o as x,w as n,b as a,a as V,t as q,y as ne,e as F,u as L,f as j}from"./app-AR8EAdS3.js";import{u as ie}from"./users-qrkLwpth.js";import{u as se}from"./countries-DJxmobnm.js";import{_ as de}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={__name:"ManageUserDialog",props:{modelValue:{type:Boolean,default:!1},user:{type:Object,default:null}},emits:["update:modelValue","user-saved"],setup(M,{emit:R}){const r=M,S=R,b=ie(),T=se(),g=f(!1),c=f([]),E=async()=>{try{g.value=!0,await T.fetchCountries(),c.value=T.countries.filter(t=>t.status===1).map(t=>({id:t.id,name:t.name,code:t.code,phone_code:t.phone_code}))}catch(t){console.error("Failed to load countries:",t),c.value=[]}finally{g.value=!1}},p=A({get:()=>r.modelValue,set:t=>S("update:modelValue",t)}),v=f(null),w=f(!1),y=f(!1),u=A(()=>r.user&&r.user.id),l=le({name:"",email:"",password:"",client_name:"",address:"",city:"",state:"",token:"",username:"",phone_number:"",alt_number:"",country_id:"",time_zone:"",language:"en",is_active:!0,two_factor_enabled:!1,timezone:"UTC"}),O=[t=>!!t||"Name is required",t=>t&&t.length>=2||"Name must be at least 2 characters"],G=[t=>!!t||"Email is required",t=>/.+@.+\..+/.test(t)||"Email must be valid"],J=A(()=>u.value?[]:[t=>!!t||"Password is required",t=>t&&t.length>=8||"Password must be at least 8 characters"]),K=[{title:"UTC",value:"UTC"},{title:"America/New_York (EST)",value:"America/New_York"},{title:"America/Los_Angeles (PST)",value:"America/Los_Angeles"},{title:"Europe/London (GMT)",value:"Europe/London"},{title:"Europe/Paris (CET)",value:"Europe/Paris"},{title:"Asia/Tokyo (JST)",value:"Asia/Tokyo"},{title:"Asia/Shanghai (CST)",value:"Asia/Shanghai"},{title:"Asia/Kolkata (IST)",value:"Asia/Kolkata"},{title:"Australia/Sydney (AEDT)",value:"Australia/Sydney"},{title:"Africa/Nairobi (EAT)",value:"Africa/Nairobi"}],Y=[{title:"English",value:"en"},{title:"Spanish",value:"es"},{title:"French",value:"fr"},{title:"German",value:"de"},{title:"Italian",value:"it"},{title:"Portuguese",value:"pt"},{title:"Russian",value:"ru"},{title:"Chinese",value:"zh"},{title:"Japanese",value:"ja"},{title:"Arabic",value:"ar"},{title:"Swahili",value:"sw"}],N=()=>{Object.assign(l,{name:"",email:"",password:"",client_name:"",address:"",city:"",state:"",token:"",username:"",phone_number:"",alt_number:"",country_id:"",time_zone:"",language:"en",is_active:!0,two_factor_enabled:!1,timezone:"UTC"}),v.value&&v.value.resetValidation()},P=t=>{t&&(Object.keys(l).forEach(e=>{t[e]!==void 0&&(l[e]=t[e])}),l.is_active=!!t.is_active,l.two_factor_enabled=!!t.two_factor_enabled)},z=async()=>{if(!v.value)return;const{valid:t}=await v.value.validate();if(t)try{let e;const m={...l};u.value&&!m.password&&delete m.password,u.value?e=await b.updateUser(r.user.id,m):e=await b.createUser(m),S("user-saved",e),U()}catch(e){console.error("Error saving user:",e)}},U=()=>{p.value=!1,N()};return te(async()=>{c.value.length===0&&await E()}),I(()=>r.user,t=>{t&&p.value&&oe(()=>{P(t)})},{immediate:!0}),I(p,t=>{t&&(c.value.length===0&&E(),r.user?P(r.user):N())}),(t,e)=>{const m=s("v-spacer"),k=s("v-btn"),$=s("v-card-title"),_=s("v-divider"),i=s("v-col"),d=s("v-text-field"),h=s("v-autocomplete"),H=s("v-textarea"),B=s("v-select"),D=s("v-switch"),Q=s("v-row"),W=s("v-form"),X=s("v-card-text"),Z=s("v-card-actions"),ee=s("v-card"),ae=s("v-dialog");return x(),C(ae,{modelValue:p.value,"onUpdate:modelValue":e[18]||(e[18]=o=>p.value=o),"max-width":"800px",persistent:""},{default:n(()=>[a(ee,null,{default:n(()=>[a($,{class:"text-h5 pa-4"},{default:n(()=>[V("span",null,q(u.value?"Edit User":"Create New User"),1),a(m),a(k,{icon:"mdi-close",variant:"text",onClick:U})]),_:1}),a(_),a(X,{class:"pa-4"},{default:n(()=>[a(W,{ref_key:"form",ref:v,modelValue:w.value,"onUpdate:modelValue":e[17]||(e[17]=o=>w.value=o),onSubmit:ne(z,["prevent"])},{default:n(()=>[a(Q,null,{default:n(()=>[a(i,{cols:"12"},{default:n(()=>e[19]||(e[19]=[V("h6",{class:"text-h6 mb-3"},"Basic Information",-1)])),_:1,__:[19]}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.name,"onUpdate:modelValue":e[0]||(e[0]=o=>l.name=o),label:"Full Name *",rules:O,"prepend-inner-icon":"mdi-account",variant:"outlined",density:"compact",required:""},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.username,"onUpdate:modelValue":e[1]||(e[1]=o=>l.username=o),label:"Username","prepend-inner-icon":"mdi-account-circle",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.email,"onUpdate:modelValue":e[2]||(e[2]=o=>l.email=o),label:"Email Address *",rules:G,"prepend-inner-icon":"mdi-email",variant:"outlined",density:"compact",type:"email",required:""},null,8,["modelValue"])]),_:1}),u.value?F("",!0):(x(),C(i,{key:0,cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.password,"onUpdate:modelValue":e[3]||(e[3]=o=>l.password=o),label:"Password *",rules:J.value,"prepend-inner-icon":"mdi-lock","append-inner-icon":y.value?"mdi-eye":"mdi-eye-off",type:y.value?"text":"password","onClick:appendInner":e[4]||(e[4]=o=>y.value=!y.value),variant:"outlined",density:"compact",required:""},null,8,["modelValue","rules","append-inner-icon","type"])]),_:1})),a(i,{cols:"12"},{default:n(()=>[a(_,{class:"my-3"}),e[20]||(e[20]=V("h6",{class:"text-h6 mb-3"},"Client & Contact Information",-1))]),_:1,__:[20]}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.client_name,"onUpdate:modelValue":e[5]||(e[5]=o=>l.client_name=o),label:"Client Name","prepend-inner-icon":"mdi-domain",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.phone_number,"onUpdate:modelValue":e[6]||(e[6]=o=>l.phone_number=o),label:"Phone Number","prepend-inner-icon":"mdi-phone",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.alt_number,"onUpdate:modelValue":e[7]||(e[7]=o=>l.alt_number=o),label:"Alternative Number","prepend-inner-icon":"mdi-phone-plus",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(h,{modelValue:l.country_id,"onUpdate:modelValue":e[8]||(e[8]=o=>l.country_id=o),label:"Country",items:c.value,"item-title":"name","item-value":"id","prepend-inner-icon":"mdi-flag",variant:"outlined",density:"compact",loading:g.value,clearable:""},null,8,["modelValue","items","loading"])]),_:1}),a(i,{cols:"12"},{default:n(()=>[a(_,{class:"my-3"}),e[21]||(e[21]=V("h6",{class:"text-h6 mb-3"},"Address Information",-1))]),_:1,__:[21]}),a(i,{cols:"12"},{default:n(()=>[a(H,{modelValue:l.address,"onUpdate:modelValue":e[9]||(e[9]=o=>l.address=o),label:"Address","prepend-inner-icon":"mdi-map-marker",variant:"outlined",density:"compact",rows:"2"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.city,"onUpdate:modelValue":e[10]||(e[10]=o=>l.city=o),label:"City","prepend-inner-icon":"mdi-city",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(d,{modelValue:l.state,"onUpdate:modelValue":e[11]||(e[11]=o=>l.state=o),label:"State/Province","prepend-inner-icon":"mdi-map",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12"},{default:n(()=>[a(_,{class:"my-3"}),e[22]||(e[22]=V("h6",{class:"text-h6 mb-3"},"Settings",-1))]),_:1,__:[22]}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(B,{modelValue:l.timezone,"onUpdate:modelValue":e[12]||(e[12]=o=>l.timezone=o),label:"Timezone",items:K,"prepend-inner-icon":"mdi-clock",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(B,{modelValue:l.language,"onUpdate:modelValue":e[13]||(e[13]=o=>l.language=o),label:"Language",items:Y,"prepend-inner-icon":"mdi-translate",variant:"outlined",density:"compact"},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(D,{modelValue:l.is_active,"onUpdate:modelValue":e[14]||(e[14]=o=>l.is_active=o),label:"Active User",color:"primary",inset:""},null,8,["modelValue"])]),_:1}),a(i,{cols:"12",md:"6"},{default:n(()=>[a(D,{modelValue:l.two_factor_enabled,"onUpdate:modelValue":e[15]||(e[15]=o=>l.two_factor_enabled=o),label:"Two Factor Authentication",color:"primary",inset:""},null,8,["modelValue"])]),_:1}),u.value?(x(),C(i,{key:1,cols:"12"},{default:n(()=>[a(d,{modelValue:l.token,"onUpdate:modelValue":e[16]||(e[16]=o=>l.token=o),label:"Token","prepend-inner-icon":"mdi-key",variant:"outlined",density:"compact",readonly:""},null,8,["modelValue"])]),_:1})):F("",!0)]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(_),a(Z,{class:"pa-4"},{default:n(()=>[a(m),a(k,{color:"grey",variant:"text",onClick:U,disabled:L(b).loading},{default:n(()=>e[23]||(e[23]=[j(" Cancel ")])),_:1,__:[23]},8,["disabled"]),a(k,{color:"primary",variant:"elevated",onClick:z,loading:L(b).loading,disabled:!w.value},{default:n(()=>[j(q(u.value?"Update User":"Create User"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},ve=de(re,[["__scopeId","data-v-bb3ae7d8"]]);export{ve as default};
