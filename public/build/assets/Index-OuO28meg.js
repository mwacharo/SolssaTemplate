import{r as v,j as P,k as H,i as j,s as J,l as T,c as z,o as i,w as Y,a as e,d as u,e as F,t as l,b as p,f as M,u as d,A as c,B as g,C as Z,F as D,g as U,n as C,y as ee}from"./app-CsZZBQNQ.js";import{_ as te}from"./AppLayout-9R4LZT2z.js";import{u as se}from"./orderStore-Bx2a5PxH.js";import{P as le,C as oe,E as ne,S as ae,a as ie}from"./square-pen-CYtlhQIL.js";import{S as re,F as de}from"./search-ocamrxYD.js";import{T as ue,P as pe}from"./truck-DnNOupUo.js";import{c as ce}from"./createLucideIcon-BhNNUGDW.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-Wn5RoFGc.js";import"./africastalking-pZrYtOG3.js";import"./IncomingCallDialog-CSJaBo63.js";/* empty css                                                                           *//**
 * @license lucide-vue-next v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const me=ce("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ve={class:"min-h-screen bg-gray-50 p-6"},ge={class:"max-w-7xl mx-auto"},be={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},xe={class:"flex justify-between items-center mb-6"},ye={class:"text-gray-600 mt-1"},fe={class:"flex flex-col md:flex-row gap-4"},_e={class:"flex-1 relative"},he={class:"flex items-center gap-2"},we={class:"bg-white rounded-lg shadow-sm overflow-hidden"},ke={class:"overflow-x-auto"},Ce={class:"w-full"},Ve={class:"px-4 py-3"},Se={class:"px-4 py-3"},Ee={class:"flex items-center gap-2"},Pe={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm"},De={class:"px-4 py-3"},Ue={class:"px-4 py-3"},Ae={class:"px-4 py-3"},Ne={class:"text-orange-600 hover:text-orange-700"},qe={class:"px-4 py-3"},ze={class:"flex items-center gap-2"},Fe={class:"text-2xl"},Me={class:"text-sm"},$e={class:"px-4 py-3"},je={class:"px-4 py-3"},Te={class:"px-4 py-3"},Oe={class:"px-4 py-3"},Be={class:"px-4 py-3"},Ie={class:"px-4 py-3"},Le={class:"px-4 py-3"},We={class:"text-sm"},Ke={class:"px-4 py-3"},Qe={class:"flex gap-2"},Re=["onClick"],Xe={class:"p-2 hover:bg-gray-100 rounded-lg",title:"Edit"},Ge={class:"border-t p-4 flex justify-between items-center"},He={class:"text-sm text-gray-600"},Je={class:"flex gap-2"},Ye=["disabled"],Ze=["onClick"],et=["disabled"],tt={key:0,class:"fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50 p-4"},st={class:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto"},lt={class:"grid grid-cols-2 gap-4"},ot={class:"bg-gray-50 rounded-lg p-4"},nt={class:"overflow-x-auto mt-4"},at={class:"w-full text-sm"},it={class:"px-3 py-2"},rt={class:"px-3 py-2"},dt=["onUpdate:modelValue"],ut={class:"px-3 py-2"},pt=["onClick"],ct={key:0},mt={class:"pt-4 flex justify-between items-center"},vt={class:"text-sm text-gray-600"},gt={class:"flex gap-3 justify-end pt-4"},bt={key:1,class:"fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50 p-4"},xt={class:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto"},yt={class:"sticky top-0 bg-white border-b p-6"},ft={class:"flex justify-between items-center"},_t={class:"text-2xl font-bold"},ht={class:"p-6 space-y-6"},wt={class:"bg-gray-50 rounded-lg p-4"},kt={class:"grid grid-cols-2 gap-4"},Ct={class:"font-semibold"},Vt={class:"font-semibold"},St={class:"font-semibold"},Et={class:"font-semibold"},Pt={class:"font-semibold"},Dt={class:"font-semibold"},Ut={class:"font-semibold"},At={class:"font-semibold"},Nt={class:"font-semibold"},qt={class:"bg-gray-50 rounded-lg p-4"},zt={class:"font-semibold text-lg mb-4"},Ft={class:"space-y-3"},Mt={class:"font-medium"},$t={class:"text-sm text-gray-600"},jt={class:"bg-gray-50 rounded-lg p-4"},Tt={class:"grid grid-cols-2 gap-4"},Ot={class:"font-semibold"},V=6,ts={__name:"Index",setup(Bt){const y=se();v(null);const O=o=>{const t=y.productOptions.find(m=>m.sku===o.product.sku);t&&(o.product.name=t.product_name)},B=o=>{n.value.shipment_items.splice(o,1)},f=v([]),a=v(null),S=v(!1),A=v(!1),_=v(""),h=v("all"),r=v(1),I=P(()=>y.vendorOptions),N=v(null),n=v({source_country:"",destination:"",warehouse_id:null,shipment_date:"",arrival_date:"",transporter_name:"",tracking_number:"",packages_number:1,weight:0,shipment_fees:0,vendor_id:null,shipment_items:[]});H(async()=>{try{await y.fetchDropdownOptions()}catch(o){console.error("Failed to load vendors:",o)}try{const o=await j.get("/api/v1/expeditions");f.value=o.data.expeditions.data??[]}catch(o){console.error("Failed to load expeditions:",o),f.value=[]}});const w=P(()=>{let o=f.value;if(_.value){const t=_.value.toLowerCase();o=o.filter(m=>{var E,k,s;return((E=m.tracking_number)==null?void 0:E.toLowerCase().includes(t))||((k=m.source_country)==null?void 0:k.toLowerCase().includes(t))||((s=m.transporter_name)==null?void 0:s.toLowerCase().includes(t))})}return h.value!=="all"&&(o=o.filter(t=>t.shipment_status===h.value)),o}),q=P(()=>Math.ceil(w.value.length/V)),L=P(()=>{const o=(r.value-1)*V,t=r.value*V;return w.value.slice(o,t)});J([_,h],()=>{r.value=1});const W=o=>({expedited:"bg-orange-500",delivered:"bg-green-500",pending:"bg-yellow-500",cancelled:"bg-red-500"})[o]||"bg-gray-500",K=o=>({approved:"bg-green-500",pending:"bg-yellow-500",draft:"bg-gray-500"})[o]||"bg-gray-500",Q=o=>({Nigeria:"ðŸ‡³ðŸ‡¬",China:"ðŸ‡¨ðŸ‡³"})[o]||"ðŸŒ",R=o=>{n.value.vendor_id=o},X=async()=>{var o;try{const m=(await j.post("/api/v1/expeditions",n.value)).data.expedition;f.value=[m,...f.value],S.value=!1,n.value={source_country:"",destination:"",warehouse_id:null,shipment_date:"",arrival_date:"",transporter_name:"",tracking_number:"",packages_number:1,weight:0,shipment_fees:0,vendor_id:null,shipment_items:[]},N.value=null}catch(t){console.error("Failed to create expedition:",t),((o=t.response)==null?void 0:o.status)===422&&console.log("Validation Errors:",t.response.data.errors)}},G=o=>{a.value=o,A.value=!0};return(o,t)=>{const m=T("v-select"),E=T("v-autocomplete");return i(),z(te,null,{default:Y(()=>{var k;return[e("div",ve,[e("div",ge,[e("div",be,[e("div",xe,[e("div",null,[t[18]||(t[18]=e("h1",{class:"text-3xl font-bold text-gray-800"}," Expeditions ",-1)),e("p",ye,l(w.value.length)+" total expeditions ",1)]),e("button",{onClick:t[0]||(t[0]=s=>S.value=!0),class:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"},[p(d(le),{size:20}),t[19]||(t[19]=M(" Add Expedition "))])]),e("div",fe,[e("div",_e,[p(d(re),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c(e("input",{type:"text",placeholder:"Search by tracking, country, or transporter...",class:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[1]||(t[1]=s=>_.value=s)},null,512),[[g,_.value]])]),e("div",he,[p(d(de),{size:20,class:"text-gray-400"}),c(e("select",{class:"border rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[2]||(t[2]=s=>h.value=s)},t[20]||(t[20]=[e("option",{value:"all"},"All Status",-1),e("option",{value:"expedited"},"Expedited",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"delivered"},"Delivered",-1),e("option",{value:"cancelled"},"Cancelled",-1)]),512),[[Z,h.value]])])])]),e("div",we,[e("div",ke,[e("table",Ce,[t[21]||(t[21]=e("thead",{class:"bg-blue-600 text-white"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left"},"ID"),e("th",{class:"px-4 py-3 text-left"},"Vendor"),e("th",{class:"px-4 py-3 text-left"},"Weight"),e("th",{class:"px-4 py-3 text-left"}," Packages "),e("th",{class:"px-4 py-3 text-left"},"Details"),e("th",{class:"px-4 py-3 text-left"},"From"),e("th",{class:"px-4 py-3 text-left"},"To"),e("th",{class:"px-4 py-3 text-left"}," Expedition Date "),e("th",{class:"px-4 py-3 text-left"}," Arrival Date "),e("th",{class:"px-4 py-3 text-left"},"Fees"),e("th",{class:"px-4 py-3 text-left"},"Status"),e("th",{class:"px-4 py-3 text-left"}," Approval "),e("th",{class:"px-4 py-3 text-left"}," Remittance "),e("th",{class:"px-4 py-3 text-left"},"Actions")])],-1)),e("tbody",null,[(i(!0),u(D,null,U(L.value,(s,b)=>{var x,$;return i(),u("tr",{key:s.id,class:C(b%2===0?"bg-amber-50":"bg-white")},[e("td",Ve,l(s.id),1),e("td",Se,[e("div",Ee,[e("div",Pe,l(((x=s.vendor)==null?void 0:x.name)||"N/A"),1)])]),e("td",De,l(s.weight),1),e("td",Ue,l(s.packages_number),1),e("td",Ae,[e("button",Ne,l(s.shipment_items.length)+" products ",1)]),e("td",qe,[e("div",ze,[e("span",Fe,l(Q(s.source_country)),1),e("span",Me,l(s.source_country),1)])]),e("td",$e,l(($=s.warehouse)==null?void 0:$.name),1),e("td",je,l(s.shipment_date),1),e("td",Te,l(s.arrival_date.split(" ")[0]),1),e("td",Oe,l(s.shipment_fees)+" KES ",1),e("td",Be,[e("span",{class:C(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs text-white",W(s.shipment_status)])},[p(d(ue),{size:12}),M(" "+l(s.shipment_status),1)],2)]),e("td",Ie,[e("span",{class:C(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs text-white",K(s.approval_status)])},[s.approval_status==="approved"?(i(),z(d(oe),{key:0,size:12})):(i(),z(d(me),{key:1,size:12})),M(" "+l(s.approval_status),1)],2)]),e("td",Le,[e("span",We,l(s.transporter_reimbursement_status==="paid"?"Paid by vendor":"Not paid"),1)]),e("td",Ke,[e("div",Qe,[e("button",{onClick:It=>G(s),class:"p-2 hover:bg-gray-100 rounded-lg",title:"View Details"},[p(d(ne),{size:18,class:"text-gray-600"})],8,Re),e("button",Xe,[p(d(ae),{size:18,class:"text-gray-600"})])])])],2)}),128))])])]),e("div",Ge,[e("div",He," Showing "+l((r.value-1)*V+1)+" to "+l(Math.min(r.value*V,w.value.length))+" of "+l(w.value.length)+" expeditions ",1),e("div",Je,[e("button",{onClick:t[3]||(t[3]=s=>r.value=Math.max(1,r.value-1)),disabled:r.value===1,class:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,Ye),(i(!0),u(D,null,U(q.value,s=>(i(),u("button",{key:s,onClick:b=>r.value=s,class:C(["px-4 py-2 rounded-lg",r.value===s?"bg-blue-600 text-white":"border hover:bg-gray-50"])},l(s),11,Ze))),128)),e("button",{onClick:t[4]||(t[4]=s=>r.value=Math.min(q.value,r.value+1)),disabled:r.value===q.value,class:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,et)])])])]),S.value?(i(),u("div",tt,[e("div",st,[t[35]||(t[35]=e("div",{class:"sticky top-0 bg-white border-b p-6"},[e("h2",{class:"text-2xl font-bold"},"Add New Expedition")],-1)),e("form",{onSubmit:ee(X,["prevent"]),class:"p-6 space-y-4"},[e("div",lt,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium mb-2"},"Source Country",-1)),c(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[5]||(t[5]=s=>n.value.source_country=s)},null,512),[[g,n.value.source_country]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium mb-2"},"Destination",-1)),p(m,{modelValue:n.value.warehouse_id,"onUpdate:modelValue":t[6]||(t[6]=s=>n.value.warehouse_id=s),items:d(y).warehouseOptions,"item-title":"name","item-value":"id",label:"Destination Warehouse","prepend-inner-icon":"mdi-warehouse",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium mb-2"},"Shipment Date",-1)),c(e("input",{type:"date",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[7]||(t[7]=s=>n.value.shipment_date=s)},null,512),[[g,n.value.shipment_date]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium mb-2"},"Expected Arrival",-1)),c(e("input",{type:"date",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[8]||(t[8]=s=>n.value.arrival_date=s)},null,512),[[g,n.value.arrival_date]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium mb-2"},"Transporter",-1)),c(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[9]||(t[9]=s=>n.value.transporter_name=s)},null,512),[[g,n.value.transporter_name]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium mb-2"},"Tracking Number",-1)),c(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[10]||(t[10]=s=>n.value.tracking_number=s)},null,512),[[g,n.value.tracking_number]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium mb-2"},"Packages",-1)),c(e("input",{type:"number",min:"1",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[11]||(t[11]=s=>n.value.packages_number=s)},null,512),[[g,n.value.packages_number,void 0,{number:!0}]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium mb-2"},"Weight (kg)",-1)),c(e("input",{type:"number",min:"0",step:"0.1",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[12]||(t[12]=s=>n.value.weight=s)},null,512),[[g,n.value.weight,void 0,{number:!0}]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium mb-2"},"Shipment Fees (KES)",-1)),c(e("input",{type:"number",min:"0",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[13]||(t[13]=s=>n.value.shipment_fees=s)},null,512),[[g,n.value.shipment_fees,void 0,{number:!0}]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium mb-2"},"Vendor ",-1)),p(m,{modelValue:N.value,"onUpdate:modelValue":[t[14]||(t[14]=s=>N.value=s),R],items:I.value,"item-title":"name","item-value":"id",label:"Vendor","prepend-inner-icon":"mdi-domain",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),e("div",ot,[e("div",nt,[e("table",at,[t[33]||(t[33]=e("thead",null,[e("tr",{class:"text-left bg-gray-100"},[e("th",{class:"px-3 py-2 w-1/2"}," Product "),e("th",{class:"px-3 py-2 w-32"}," Quantity "),e("th",{class:"px-3 py-2 w-32"}," Actions ")])],-1)),e("tbody",null,[(i(!0),u(D,null,U(n.value.shipment_items,(s,b)=>(i(),u("tr",{key:b,class:"bg-white even:bg-gray-50"},[e("td",it,[p(E,{modelValue:s.product.id,"onUpdate:modelValue":[x=>s.product.id=x,x=>O(s)],items:d(y).productOptions,"item-title":"product_name","item-value":"id",placeholder:"Select product",density:"compact","hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),e("td",rt,[c(e("input",{type:"number",min:"1",class:"w-full border rounded px-2 py-1","onUpdate:modelValue":x=>s.quantity_sent=x},null,8,dt),[[g,s.quantity_sent,void 0,{number:!0}]])]),e("td",ut,[e("button",{type:"button",class:"px-3 py-1 border rounded hover:bg-gray-100",onClick:x=>B(b)}," Remove ",8,pt)])]))),128)),n.value.shipment_items.length?F("",!0):(i(),u("tr",ct,t[32]||(t[32]=[e("td",{colspan:"3",class:"px-3 py-4 text-gray-500 text-center"}," No products added yet. ",-1)])))])])]),e("div",mt,[e("button",{type:"button",class:"mt-3 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:t[15]||(t[15]=s=>{n.value.shipment_items=n.value.shipment_items||[],n.value.shipment_items.push({product:{name:""},quantity_sent:1,product:{sku:""},product:{id:""}})})}," + Add Product "),e("div",vt," Total units: "+l((n.value.shipment_items||[]).reduce((s,b)=>s+(Number(b.quantity_sent)||0),0)),1)])]),e("div",gt,[e("button",{type:"button",onClick:t[16]||(t[16]=s=>S.value=!1),class:"px-4 py-2 border rounded-lg hover:bg-gray-50"}," Cancel "),t[34]||(t[34]=e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Create Expedition ",-1))])],32)])])):F("",!0),A.value&&a.value?(i(),u("div",bt,[e("div",xt,[e("div",yt,[e("div",ft,[e("h2",_t," Expedition Details #"+l(a.value.id),1),e("button",{onClick:t[17]||(t[17]=s=>A.value=!1),class:"text-gray-500 hover:text-gray-700"},[p(d(ie),{size:24})])])]),e("div",ht,[e("div",wt,[t[46]||(t[46]=e("h3",{class:"font-semibold text-lg mb-4"}," Shipment Information ",-1)),e("div",kt,[e("div",null,[t[36]||(t[36]=e("p",{class:"text-sm text-gray-600"}," Tracking Number ",-1)),e("p",Ct,l(a.value.tracking_number),1)]),e("div",null,[t[37]||(t[37]=e("p",{class:"text-sm text-gray-600"}," Transporter ",-1)),e("p",Vt,l(a.value.transporter_name),1)]),e("div",null,[t[38]||(t[38]=e("p",{class:"text-sm text-gray-600"}," Source Country ",-1)),e("p",St,l(a.value.source_country),1)]),e("div",null,[t[39]||(t[39]=e("p",{class:"text-sm text-gray-600"}," Destination ",-1)),e("p",Et,l((k=a.value.warehouse)==null?void 0:k.name)+", ",1)]),e("div",null,[t[40]||(t[40]=e("p",{class:"text-sm text-gray-600"}," Shipment Date ",-1)),e("p",Pt,l(a.value.shipment_date),1)]),e("div",null,[t[41]||(t[41]=e("p",{class:"text-sm text-gray-600"}," Arrival Date ",-1)),e("p",Dt,l(a.value.arrival_date),1)]),e("div",null,[t[42]||(t[42]=e("p",{class:"text-sm text-gray-600"},"Weight",-1)),e("p",Ut,l(a.value.weight)+" kg ",1)]),e("div",null,[t[43]||(t[43]=e("p",{class:"text-sm text-gray-600"}," Packages ",-1)),e("p",At,l(a.value.packages_number),1)]),e("div",null,[t[44]||(t[44]=e("p",{class:"text-sm text-gray-600"},"Fees",-1)),e("p",Nt,l(a.value.shipment_fees)+" KES ",1)]),e("div",null,[t[45]||(t[45]=e("p",{class:"text-sm text-gray-600"}," Payment Status ",-1)),e("span",{class:C(["inline-block px-2 py-1 rounded text-xs text-white",a.value.transporter_reimbursement_status==="paid"?"bg-green-500":"bg-red-500"])},l(a.value.transporter_reimbursement_status),3)])])]),e("div",qt,[e("h3",zt," Products ("+l(a.value.shipment_items.length)+") ",1),e("div",Ft,[(i(!0),u(D,null,U(a.value.shipment_items,(s,b)=>(i(),u("div",{key:b,class:"bg-white rounded-lg p-3 flex justify-between items-center"},[e("div",null,[e("p",Mt,l(s.product.product_name),1),e("p",$t," Quantity: "+l(s.quantity_sent)+" units ",1)]),p(d(pe),{class:"text-blue-500",size:20})]))),128))])]),e("div",jt,[t[49]||(t[49]=e("h3",{class:"font-semibold text-lg mb-4"}," Vendor Information ",-1)),e("div",Tt,[e("div",null,[t[47]||(t[47]=e("p",{class:"text-sm text-gray-600"},"Name",-1)),e("p",Ot,l(a.value.vendor.name),1)]),t[48]||(t[48]=e("div",null,[e("p",{class:"text-sm text-gray-600"}," Username ")],-1))])])])])])):F("",!0)])]}),_:1})}}};export{ts as default};
