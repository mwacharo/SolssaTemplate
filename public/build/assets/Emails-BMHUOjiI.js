import{E as se,i as ae,r as D,j as M,k as le,l as re,c as ne,o as d,w as oe,a as t,d as u,e as h,F as E,g as k,n as P,f as ie,t as c,y as de,A as g,B as _,b as ue,u as C,C as j,D as ce}from"./app-D6iZLtu0.js";import{u as me}from"./users-Bw1B4IMe.js";import{_ as pe}from"./AppLayout-Vu3oW43b.js";import{n as f}from"./toast-VWdPEFBe.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-DpEupPYr.js";import"./africastalking-BLKEMTWA.js";import"./IncomingCallDialog-BPts2SSf.js";/* empty css                                                                           */const fe="/api/v1",w=ae.create({baseURL:fe});w.interceptors.response.use(a=>a,a=>{var e;return console.error("API Error:",((e=a.response)==null?void 0:e.data)||a.message),Promise.reject(a)});const be=se("email",{state:()=>({sentEmails:[],drafts:[],templates:[],templatesPagination:{current_page:1,last_page:1,per_page:15,total:0},clients:[],isLoading:!1,isSending:!1,isLoadingTemplates:!1,isLoadingDrafts:!1,isLoadingSentEmails:!1,error:null,templateError:null,draftError:null,sentEmailError:null}),getters:{draftsCount:a=>a.drafts.length,sentEmailsCount:a=>a.sentEmails.length,templatesCount:a=>a.templates.length,getEmailsByClient:a=>e=>a.sentEmails.filter(r=>r.client_id===e),getEmailsByDateRange:a=>(e,r)=>a.sentEmails.filter(i=>{const n=new Date(i.sent_at||i.created_at),b=new Date(e),S=new Date(r);return n>=b&&n<=S}),recentEmails:a=>{const e=new Date;return e.setDate(e.getDate()-7),a.sentEmails.filter(r=>new Date(r.sent_at||r.created_at)>=e).sort((r,i)=>new Date(i.sent_at||i.created_at)-new Date(r.sent_at||r.created_at))},getTemplateById:a=>e=>a.templates.find(r=>r.id===parseInt(e)),getDraftById:a=>e=>a.drafts.find(r=>r.id===parseInt(e)),getSentEmailById:a=>e=>a.sentEmails.find(r=>r.id===parseInt(e)),hasMoreTemplates:a=>a.templatesPagination.current_page<a.templatesPagination.last_page},actions:{handleError(a,e){var i,n;const r=((n=(i=a.response)==null?void 0:i.data)==null?void 0:n.message)||a.message||"An error occurred";return e&&(this[e]=r),this.error=r,console.error("Store Error:",r),r},clearErrors(){this.error=null,this.templateError=null,this.draftError=null,this.sentEmailError=null},async fetchTemplates(a=1){this.isLoadingTemplates=!0,this.templateError=null;try{const e=await w.get(`/email-templates?page=${a}`);return a===1?this.templates=e.data.data:this.templates.push(...e.data.data),this.templatesPagination={current_page:e.data.meta.current_page,last_page:e.data.meta.last_page,per_page:e.data.meta.per_page,total:e.data.meta.total},e.data}catch(e){throw this.handleError(e,"templateError"),e}finally{this.isLoadingTemplates=!1}},async saveTemplate(a){this.isLoading=!0,this.templateError=null;try{const e=await w.post("/email-templates",a);return this.templates.unshift(e.data),e.data}catch(e){throw this.handleError(e,"templateError"),e}finally{this.isLoading=!1}},async updateTemplate(a,e){this.isLoading=!0,this.templateError=null;try{const r=await w.put(`/email-templates/${a}`,e),i=this.templates.findIndex(n=>n.id===parseInt(a));return i!==-1&&(this.templates[i]=r.data),r.data}catch(r){throw this.handleError(r,"templateError"),r}finally{this.isLoading=!1}},async deleteTemplate(a){this.isLoading=!0,this.templateError=null;try{await w.delete(`/email-templates/${a}`);const e=this.templates.findIndex(r=>r.id===parseInt(a));return e!==-1&&(this.templates.splice(e,1),this.templatesPagination.total--),!0}catch(e){throw this.handleError(e,"templateError"),e}finally{this.isLoading=!1}},async fetchDrafts(){this.isLoadingDrafts=!0,this.draftError=null;try{const a=await w.get("/drafts");return this.drafts=a.data.data||a.data,a.data}catch(a){throw this.handleError(a,"draftError"),a}finally{this.isLoadingDrafts=!1}},async saveDraft(a){this.isLoading=!0,this.draftError=null;try{const e=await w.post("/drafts",a),r=this.drafts.findIndex(i=>i.id===e.data.id);return r!==-1?this.drafts[r]=e.data:this.drafts.unshift(e.data),e.data}catch(e){throw this.handleError(e,"draftError"),e}finally{this.isLoading=!1}},async deleteDraft(a){this.isLoading=!0,this.draftError=null;try{await w.delete(`/drafts/${a}`);const e=this.drafts.findIndex(r=>r.id===parseInt(a));return e!==-1&&this.drafts.splice(e,1),!0}catch(e){throw this.handleError(e,"draftError"),e}finally{this.isLoading=!1}},async fetchSentEmails(){this.isLoadingSentEmails=!0,this.sentEmailError=null;try{const a=await w.get("/sent");return this.sentEmails=a.data.data||a.data,a.data}catch(a){throw this.handleError(a,"sentEmailError"),a}finally{this.isLoadingSentEmails=!1}},async sendEmail(a){this.isSending=!0,this.error=null;try{const e=await w.post("/send",a);return this.sentEmails.unshift(e.data),e.data}catch(e){throw this.handleError(e),e}finally{this.isSending=!1}},async sendBulkEmails(a){this.isSending=!0,this.error=null;try{const e=await w.post("/bulk-send",a);return e.data.sent_emails&&Array.isArray(e.data.sent_emails)&&this.sentEmails.unshift(...e.data.sent_emails),e.data}catch(e){throw this.handleError(e),e}finally{this.isSending=!1}},async initializeData(){this.isLoading=!0;try{await Promise.allSettled([this.fetchTemplates(),this.fetchDrafts(),this.fetchSentEmails()])}catch(a){this.handleError(a)}finally{this.isLoading=!1}},personalizeMail(a,e={}){let r=a;return Object.keys(e).forEach(i=>{const n=new RegExp(`\\{\\{${i}\\}\\}`,"g");r=r.replace(n,e[i]||"")}),r=r.replace(/\{\{date\}\}/g,new Date().toLocaleDateString()).replace(/\{\{time\}\}/g,new Date().toLocaleTimeString()),r},searchEmails(a,e="sent"){const r=e==="sent"?this.sentEmails:this.drafts;if(!a||a.trim()==="")return r;const i=a.toLowerCase();return r.filter(n=>n.subject&&n.subject.toLowerCase().includes(i)||n.body&&n.body.toLowerCase().includes(i)||n.to&&n.to.toLowerCase().includes(i)||n.from&&n.from.toLowerCase().includes(i))},searchTemplates(a){if(!a||a.trim()==="")return this.templates;const e=a.toLowerCase();return this.templates.filter(r=>r.name&&r.name.toLowerCase().includes(e)||r.subject&&r.subject.toLowerCase().includes(e)||r.body&&r.body.toLowerCase().includes(e))},getEmailStats(){const a=new Date,e=new Date(a.getTime()-7*24*60*60*1e3),r=new Date(a.getFullYear(),a.getMonth(),1);return{total:this.sentEmails.length,thisWeek:this.sentEmails.filter(i=>new Date(i.sent_at||i.created_at)>=e).length,thisMonth:this.sentEmails.filter(i=>new Date(i.sent_at||i.created_at)>=r).length,delivered:this.sentEmails.filter(i=>i.status==="sent").length,failed:this.sentEmails.filter(i=>i.status==="failed").length,scheduled:this.sentEmails.filter(i=>i.status==="scheduled").length,drafts:this.drafts.length,templates:this.templates.length}},exportEmails(a="sent",e="json"){const r=a==="sent"?this.sentEmails:this.drafts;if(e==="csv"){const i=["Date","From","To","Subject","Status"],n=r.map(b=>[new Date(b.sent_at||b.created_at).toLocaleDateString(),b.from||"",b.to||"",b.subject||"",b.status||"draft"]);return[i,...n]}return r},exportTemplates(a="json"){if(a==="csv"){const e=["Name","Subject","Placeholders","Created Date"],r=this.templates.map(i=>[i.name,i.subject,i.placeholders?i.placeholders.join(", "):"",new Date(i.created_at).toLocaleDateString()]);return[e,...r]}return this.templates},async deleteBulkDrafts(a){this.isLoading=!0;const e=[];try{for(const r of a)try{await this.deleteDraft(r),e.push({id:r,success:!0})}catch(i){e.push({id:r,success:!1,error:i.message})}return e}finally{this.isLoading=!1}},async deleteBulkTemplates(a){this.isLoading=!0;const e=[];try{for(const r of a)try{await this.deleteTemplate(r),e.push({id:r,success:!0})}catch(i){e.push({id:r,success:!1,error:i.message})}return e}finally{this.isLoading=!1}},async refreshTemplates(){this.templatesPagination.current_page=1,await this.fetchTemplates(1)},async refreshDrafts(){await this.fetchDrafts()},async refreshSentEmails(){await this.fetchSentEmails()},async refreshAll(){await this.initializeData()},clearCache(){this.templates=[],this.drafts=[],this.sentEmails=[],this.templatesPagination={current_page:1,last_page:1,per_page:15,total:0},this.clearErrors()}}}),ge={class:"p-6 bg-gray-50 min-h-screen"},he={class:"bg-white rounded-lg shadow-sm mb-6"},ye={class:"border-b border-gray-200"},ve={class:"-mb-px flex space-x-8 px-6"},xe=["onClick"],we={key:0,class:"ml-2 bg-gray-100 text-gray-600 py-0.5 px-2 rounded-full text-xs"},_e={key:0,class:"p-6"},Ee={class:"max-w-4xl mx-auto"},ke={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},Ce=["value"],De={class:"flex items-center space-x-4"},Te={key:0,class:"text-sm text-gray-600"},je={key:0,class:"mt-2"},Se={class:"text-sm"},Le=["onClick"],Ae={key:1,class:"p-6"},Ie={class:"space-y-3"},Be={class:"flex justify-between items-start"},Ve={class:"flex-1"},Ue={class:"font-medium text-gray-900"},Me={class:"text-sm text-gray-600 mt-1"},Pe={class:"text-sm text-gray-500 mt-2"},Fe={class:"text-xs text-gray-400 mt-2"},$e={class:"flex space-x-2 ml-4"},Ne=["onClick"],ze=["onClick"],Re={key:0,class:"text-center py-8 text-gray-500"},Oe={key:2,class:"p-6"},Qe={class:"flex justify-between items-center mb-4"},We={class:"flex space-x-4"},Ge=["value"],He={class:"space-y-3"},Ye={class:"flex justify-between items-start"},Je={class:"flex-1"},Ke={class:"font-medium text-gray-900"},Xe={class:"text-sm text-gray-600 mt-1"},Ze={class:"text-sm text-gray-600"},qe={class:"text-sm text-gray-500 mt-2"},et={class:"flex items-center space-x-4 mt-2"},tt={class:"text-xs text-gray-400"},st={key:0,class:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded"},at=["onClick"],lt={key:0,class:"text-center py-8 text-gray-500"},rt={key:3,class:"p-6"},nt={class:"flex justify-between items-center mb-4"},ot={key:0,class:"mb-6 p-4 border border-gray-200 rounded-lg bg-gray-50"},it={class:"space-y-3"},dt={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ut={class:"font-medium text-gray-900 mb-2"},ct={class:"text-sm text-gray-600 mb-2"},mt={class:"text-sm text-gray-500 mb-3"},pt={class:"flex space-x-2"},ft=["onClick"],bt=["onClick"],gt=["onClick"],ht={key:1,class:"text-center py-8 text-gray-500"},yt={key:4,class:"p-6"},vt={class:"max-w-4xl mx-auto"},xt={class:"space-y-4"},wt={class:"grid grid-cols-2 md:grid-cols-3 gap-2"},_t=["value"],Et={class:"text-sm"},kt=["value"],Ct={key:0},Dt={class:"border border-gray-200 rounded-md p-4 bg-gray-50"},Tt={class:"font-medium"},jt={class:"text-sm text-gray-600 mt-2"},St={class:"flex space-x-4"},Lt=["disabled"],At=["disabled"],zt={__name:"Emails",setup(a){me();const e=be(),r=D("compose"),i=M(()=>[{key:"compose",name:"Compose",count:null},{key:"drafts",name:"Drafts",count:e.drafts.length},{key:"outbox",name:"Outbox",count:e.sentEmails.length},{key:"templates",name:"Templates",count:e.templates.length},{key:"bulk",name:"Bulk Email",count:null}]),n=D({to:"",subject:"",body:"",client:"",attachments:[]}),b=D(""),S=o=>{const s=Array.from(o.target.files);n.value.attachments=[...n.value.attachments,...s]},F=o=>{n.value.attachments.splice(o,1)},$=o=>{if(o===0)return"0 Bytes";const s=1024,x=["Bytes","KB","MB","GB"],l=Math.floor(Math.log(o)/Math.log(s));return parseFloat((o/Math.pow(s,l)).toFixed(2))+" "+x[l]},N=()=>{if(!n.value.to||!n.value.subject){f.failed("Please fill in required fields","error");return}e.sendEmail({...n.value,id:Date.now(),sentAt:new Date,status:"sent"}),f.success("Email sent successfully!","success"),L()},z=()=>{if(!n.value.to&&!n.value.subject&&!n.value.body){f.failed("Cannot save empty draft","error");return}e.saveDraft({...n.value,id:Date.now(),createdAt:new Date}),f.sucess("Draft saved successfully!","success"),L()},L=()=>{n.value={to:"",subject:"",body:"",client:"",attachments:[]},b.value=""},I=()=>{if(!b.value)return;const o=e.templates.find(s=>s.id===parseInt(b.value));o&&(n.value.subject=o.subject,n.value.body=o.body)},T=D(!1),p=D({name:"",subject:"",body:""}),R=()=>{if(!p.value.name||!p.value.subject||!p.value.body){f.error("Please fill in all template fields");return}p.value.id?(e.updateTemplate(p.value.id,{name:p.value.name,subject:p.value.subject,body:p.value.body,updatedAt:new Date}),f.success("Template updated successfully!")):(e.saveTemplate({...p.value,id:Date.now(),createdAt:new Date}),f.success("Template saved successfully!")),B()},B=()=>{T.value=!1,p.value={name:"",subject:"",body:""}},O=o=>{b.value=o.id.toString(),I(),r.value="compose",f.success("Template loaded in compose tab","success")},Q=o=>{p.value={...o},T.value=!0},W=o=>{confirm("Are you sure you want to delete this template?")&&(e.deleteTemplate(o),f.success("Template deleted successfully!","success"))},G=o=>{n.value={...o},r.value="compose",e.deleteDraft(o.id),f.success("Draft loaded for editing","success")},H=o=>{confirm("Are you sure you want to delete this draft?")&&(e.deleteDraft(o),f.success("Draft deleted successfully!","success"))},v=D({client:"",dateFrom:"",dateTo:""}),V=M(()=>{let o=e.sentEmails;if(v.value.client&&(o=o.filter(s=>s.clientId===v.value.client)),v.value.dateFrom){const s=new Date(v.value.dateFrom);o=o.filter(x=>new Date(x.sentAt)>=s)}if(v.value.dateTo){const s=new Date(v.value.dateTo);s.setHours(23,59,59,999),o=o.filter(x=>new Date(x.sentAt)<=s)}return o}),m=D({selectedClients:[],templateId:"",subject:"",body:""}),Y=()=>{m.value.selectedClients=e.clients.map(o=>o.id)},J=()=>{m.value.selectedClients=[]},K=()=>{if(!m.value.templateId)return;const o=e.templates.find(s=>s.id===parseInt(m.value.templateId));o&&(m.value.subject=o.subject,m.value.body=o.body)},X=()=>{if(!m.value.selectedClients.length){f.error("Please select at least one client","error");return}if(!m.value.templateId){f.error("Please select a template","error");return}m.value.selectedClients.forEach(o=>{const s=e.clients.find(x=>x.id===o);e.sendEmail({to:s.email,subject:m.value.subject.replace("{{client_name}}",s.name),body:m.value.body.replace("{{client_name}}",s.name).replace("{{date}}",new Date().toLocaleDateString()),clientId:o,id:Date.now()+Math.random(),sentAt:new Date,status:"sent"})}),f.success(`Bulk email sent to ${m.value.selectedClients.length} clients!`,"success"),m.value.selectedClients=[]},Z=()=>{f.success("Preview functionality would open detailed preview","info")},A=(o,s)=>o?o.length>s?o.substring(0,s)+"...":o:"",U=o=>new Date(o).toLocaleString(),q=o=>{const s=e.clients.find(x=>x.id===o);return s?s.name:"Unknown"},ee=o=>{f("Email details would open in a modal","info")};return le(()=>{e.initializeData()}),(o,s)=>{const x=re("vue-autocomplete");return d(),ne(pe,{title:"Email Dashboard"},{default:oe(()=>[t("div",ge,[s[39]||(s[39]=t("div",{class:"mb-6"},[t("h1",{class:"text-3xl font-bold text-gray-900 mb-2"},"Email Management"),t("p",{class:"text-gray-600"},"Manage your emails, templates, and communications")],-1)),t("div",he,[t("div",ye,[t("nav",ve,[(d(!0),u(E,null,k(i.value,l=>(d(),u("button",{key:l.key,onClick:y=>r.value=l.key,class:P(["py-4 px-1 border-b-2 font-medium text-sm whitespace-nowrap",r.value===l.key?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"])},[ie(c(l.name)+" ",1),l.count?(d(),u("span",we,c(l.count),1)):h("",!0)],10,xe))),128))])]),r.value==="compose"?(d(),u("div",_e,[t("div",Ee,[s[28]||(s[28]=t("h2",{class:"text-xl font-semibold mb-4"},"Compose Email",-1)),t("form",{onSubmit:de(N,["prevent"]),class:"space-y-4"},[t("div",ke,[t("div",null,[s[18]||(s[18]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"To",-1)),g(t("input",{"onUpdate:modelValue":s[0]||(s[0]=l=>n.value.to=l),type:"email",multiple:"",placeholder:"recipient@example.com",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,n.value.to]])]),t("div",null,[s[19]||(s[19]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"CC",-1)),g(t("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>n.value.cc=l),type:"email",multiple:"",placeholder:"cc@example.com",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,n.value.cc]])]),t("div",null,[s[20]||(s[20]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"BCC",-1)),g(t("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>n.value.bcc=l),type:"email",multiple:"",placeholder:"bcc@example.com",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,n.value.bcc]])]),t("div",null,[s[21]||(s[21]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Client",-1)),g(t("select",{"onUpdate:modelValue":s[4]||(s[4]=l=>n.value.client=l),class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[ue(x,{modelValue:n.value.client,"onUpdate:modelValue":s[3]||(s[3]=l=>n.value.client=l),items:C(e).clients,"item-text":"name","item-value":"id",multiple:"",placeholder:"Select Client(s)",class:"w-full"},null,8,["modelValue","items"])],512),[[j,n.value.client]])])]),t("div",null,[s[22]||(s[22]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Subject",-1)),g(t("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>n.value.subject=l),type:"text",placeholder:"Email subject",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,n.value.subject]])]),t("div",null,[s[24]||(s[24]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Email Template",-1)),g(t("select",{"onUpdate:modelValue":s[6]||(s[6]=l=>b.value=l),onChange:I,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[s[23]||(s[23]=t("option",{value:""},"Select Template",-1)),(d(!0),u(E,null,k(C(e).templates,l=>(d(),u("option",{key:l.id,value:l.id},c(l.name),9,Ce))),128))],544),[[j,b.value]])]),t("div",null,[s[25]||(s[25]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Message",-1)),g(t("textarea",{"onUpdate:modelValue":s[7]||(s[7]=l=>n.value.body=l),rows:"10",placeholder:"Type your message here...",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,n.value.body]])]),t("div",null,[s[26]||(s[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Attachments",-1)),t("div",De,[t("input",{ref:"fileInput",type:"file",multiple:"",onChange:S,class:"hidden"},null,544),t("button",{type:"button",onClick:s[8]||(s[8]=l=>o.$refs.fileInput.click()),class:"px-4 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 hover:bg-gray-50"}," Add Files "),n.value.attachments.length?(d(),u("div",Te,c(n.value.attachments.length)+" file(s) selected ",1)):h("",!0)]),n.value.attachments.length?(d(),u("div",je,[(d(!0),u(E,null,k(n.value.attachments,(l,y)=>(d(),u("div",{key:y,class:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded mb-1"},[t("span",Se,c(l.name)+" ("+c($(l.size))+")",1),t("button",{onClick:te=>F(y),class:"text-red-600 hover:text-red-800 text-sm"},"Remove",8,Le)]))),128))])):h("",!0)]),t("div",{class:"flex space-x-4"},[s[27]||(s[27]=t("button",{type:"submit",class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500"}," Send Email ",-1)),t("button",{type:"button",onClick:z,class:"px-6 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500"}," Save as Draft "),t("button",{type:"button",onClick:L,class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Clear ")])],32)])])):h("",!0),r.value==="drafts"?(d(),u("div",Ae,[s[29]||(s[29]=t("div",{class:"flex justify-between items-center mb-4"},[t("h2",{class:"text-xl font-semibold"},"Draft Emails")],-1)),t("div",Ie,[(d(!0),u(E,null,k(C(e).drafts,l=>(d(),u("div",{key:l.id,class:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50"},[t("div",Be,[t("div",Ve,[t("h3",Ue,c(l.subject||"No Subject"),1),t("p",Me,"To: "+c(l.to),1),t("p",Pe,c(A(l.body,100)),1),t("p",Fe,"Saved: "+c(U(l.createdAt)),1)]),t("div",$e,[t("button",{onClick:y=>G(l),class:"text-blue-600 hover:text-blue-800 text-sm"},"Edit",8,Ne),t("button",{onClick:y=>H(l.id),class:"text-red-600 hover:text-red-800 text-sm"},"Delete",8,ze)])])]))),128))]),C(e).drafts.length?h("",!0):(d(),u("div",Re," No drafts found "))])):h("",!0),r.value==="outbox"?(d(),u("div",Oe,[t("div",Qe,[s[31]||(s[31]=t("h2",{class:"text-xl font-semibold"},"Sent Emails",-1)),t("div",We,[g(t("select",{"onUpdate:modelValue":s[9]||(s[9]=l=>v.value.client=l),class:"px-3 py-1 border border-gray-300 rounded text-sm"},[s[30]||(s[30]=t("option",{value:""},"All Clients",-1)),(d(!0),u(E,null,k(C(e).clients,l=>(d(),u("option",{key:l.id,value:l.id},c(l.name),9,Ge))),128))],512),[[j,v.value.client]]),g(t("input",{"onUpdate:modelValue":s[10]||(s[10]=l=>v.value.dateFrom=l),type:"date",class:"px-3 py-1 border border-gray-300 rounded text-sm",placeholder:"From Date"},null,512),[[_,v.value.dateFrom]]),g(t("input",{"onUpdate:modelValue":s[11]||(s[11]=l=>v.value.dateTo=l),type:"date",class:"px-3 py-1 border border-gray-300 rounded text-sm",placeholder:"To Date"},null,512),[[_,v.value.dateTo]])])]),t("div",He,[(d(!0),u(E,null,k(V.value,l=>{var y;return d(),u("div",{key:l.id,class:"border border-gray-200 rounded-lg p-4"},[t("div",Ye,[t("div",Je,[t("h3",Ke,c(l.subject),1),t("p",Xe,"To: "+c(l.to),1),t("p",Ze,"Client: "+c(q(l.clientId)),1),t("p",qe,c(A(l.body,100)),1),t("div",et,[t("p",tt,"Sent: "+c(U(l.sentAt)),1),(y=l.attachments)!=null&&y.length?(d(),u("span",st,c(l.attachments.length)+" attachment(s) ",1)):h("",!0),t("span",{class:P(["text-xs px-2 py-1 rounded",l.status==="delivered"?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"])},c(l.status),3)])]),t("button",{onClick:te=>ee(l),class:"text-blue-600 hover:text-blue-800 text-sm"},"View",8,at)])])}),128))]),V.value.length?h("",!0):(d(),u("div",lt," No sent emails found "))])):h("",!0),r.value==="templates"?(d(),u("div",rt,[t("div",nt,[s[32]||(s[32]=t("h2",{class:"text-xl font-semibold"},"Email Templates",-1)),t("button",{onClick:s[12]||(s[12]=l=>T.value=!0),class:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"}," New Template ")]),T.value?(d(),u("div",ot,[s[33]||(s[33]=t("h3",{class:"font-medium mb-3"},"Create New Template",-1)),t("div",it,[g(t("input",{"onUpdate:modelValue":s[13]||(s[13]=l=>p.value.name=l),type:"text",placeholder:"Template name",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,p.value.name]]),g(t("input",{"onUpdate:modelValue":s[14]||(s[14]=l=>p.value.subject=l),type:"text",placeholder:"Email subject",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,p.value.subject]]),g(t("textarea",{"onUpdate:modelValue":s[15]||(s[15]=l=>p.value.body=l),rows:"6",placeholder:"Email body (use {{client_name}}, {{date}} for variables)",class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[_,p.value.body]]),t("div",{class:"flex space-x-3"},[t("button",{onClick:R,class:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"}," Save Template "),t("button",{onClick:B,class:"px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50"}," Cancel ")])])])):h("",!0),t("div",dt,[(d(!0),u(E,null,k(C(e).templates,l=>(d(),u("div",{key:l.id,class:"border border-gray-200 rounded-lg p-4"},[t("h3",ut,c(l.name),1),t("p",ct,"Subject: "+c(l.subject),1),t("p",mt,c(A(l.body,80)),1),t("div",pt,[t("button",{onClick:y=>O(l),class:"text-blue-600 hover:text-blue-800 text-sm"},"Use",8,ft),t("button",{onClick:y=>Q(l),class:"text-green-600 hover:text-green-800 text-sm"},"Edit",8,bt),t("button",{onClick:y=>W(l.id),class:"text-red-600 hover:text-red-800 text-sm"},"Delete",8,gt)])]))),128))]),!C(e).templates.length&&!T.value?(d(),u("div",ht," No templates found. Create your first template to get started. ")):h("",!0)])):h("",!0),r.value==="bulk"?(d(),u("div",yt,[t("div",vt,[s[38]||(s[38]=t("h2",{class:"text-xl font-semibold mb-4"},"Bulk Email",-1)),t("div",xt,[t("div",null,[s[34]||(s[34]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Recipients",-1)),t("div",{class:"flex space-x-4 mb-2"},[t("button",{onClick:Y,class:"px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700"}," Select All Clients "),t("button",{onClick:J,class:"px-3 py-1 border border-gray-300 text-gray-700 text-sm rounded hover:bg-gray-50"}," Clear All ")]),t("div",wt,[(d(!0),u(E,null,k(C(e).clients,l=>(d(),u("label",{key:l.id,class:"flex items-center space-x-2"},[g(t("input",{"onUpdate:modelValue":s[16]||(s[16]=y=>m.value.selectedClients=y),value:l.id,type:"checkbox",class:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"},null,8,_t),[[ce,m.value.selectedClients]]),t("span",Et,c(l.name),1)]))),128))])]),t("div",null,[s[36]||(s[36]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Template",-1)),g(t("select",{"onUpdate:modelValue":s[17]||(s[17]=l=>m.value.templateId=l),onChange:K,class:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"},[s[35]||(s[35]=t("option",{value:""},"Select Template",-1)),(d(!0),u(E,null,k(C(e).templates,l=>(d(),u("option",{key:l.id,value:l.id},c(l.name),9,kt))),128))],544),[[j,m.value.templateId]])]),m.value.templateId?(d(),u("div",Ct,[s[37]||(s[37]=t("label",{class:"block text-sm font-medium text-gray-700 mb-1"},"Preview",-1)),t("div",Dt,[t("p",Tt,c(m.value.subject),1),t("p",jt,c(m.value.body),1)])])):h("",!0),t("div",St,[t("button",{onClick:X,disabled:!m.value.selectedClients.length||!m.value.templateId,class:"px-6 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"}," Send to "+c(m.value.selectedClients.length)+" Client(s) ",9,Lt),t("button",{onClick:Z,disabled:!m.value.selectedClients.length||!m.value.templateId,class:"px-6 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Preview All ",8,At)])])])])):h("",!0)])])]),_:1})}}};export{zt as default};
