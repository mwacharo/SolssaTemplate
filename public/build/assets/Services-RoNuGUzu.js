import{E as z,i as w,X as R,r as h,k as X,c as G,o as c,w as H,a as e,d as v,e as g,f as D,u,t as p,F as J,g as K,n as A,y as x,A as E,B as F,D as O}from"./app-DwcUnp-P.js";import{_ as P}from"./AppLayout-Df0YMLYe.js";import{_ as Q}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-aKCnVd6T.js";import"./africastalking-BtuhVGs9.js";import"./IncomingCallDialog-B4HomNh5.js";/* empty css                                                                           */const W=z("services",{state:()=>({services:[],pagination:null,loading:!1,error:null}),actions:{async fetchServices(l=1,o=15){var n,s;this.loading=!0,this.error=null;try{const i=await w.get("/api/v1/services",{params:{page:l,per_page:o}});this.services=i.data.data.data||[],this.pagination={current_page:i.data.data.current_page,last_page:i.data.data.last_page,per_page:i.data.data.per_page,total:i.data.data.total,from:i.data.data.from,to:i.data.data.to}}catch(i){this.error=((s=(n=i.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to fetch services",console.error("Fetch services error:",i)}finally{this.loading=!1}},async createService(l){var o,n;this.loading=!0,this.error=null;try{const s=await w.post("/api/v1/services",l);return this.services.unshift(s.data.data),this.pagination&&(this.pagination.total+=1),s.data}catch(s){throw this.error=((n=(o=s.response)==null?void 0:o.data)==null?void 0:n.message)||"Failed to create service",console.error("Error creating service:",s),s}finally{this.loading=!1}},async updateService(l,o){var n,s;this.loading=!0,this.error=null;try{const i=await w.put(`/api/v1/services/${l}`,o),_=this.services.findIndex(m=>m.id===l);return _!==-1&&(this.services[_]=i.data.data),i.data}catch(i){throw this.error=((s=(n=i.response)==null?void 0:n.data)==null?void 0:s.message)||"Failed to update service",console.error("Error updating service:",i),i}finally{this.loading=!1}},async deleteService(l){var o,n;this.loading=!0,this.error=null;try{await w.delete(`/api/v1/services/${l}`),this.services=this.services.filter(s=>s.id!==l),this.pagination&&(this.pagination.total-=1)}catch(s){throw this.error=((n=(o=s.response)==null?void 0:o.data)==null?void 0:n.message)||"Failed to delete service",console.error("Error deleting service:",s),s}finally{this.loading=!1}},async toggleServiceStatus(l){const o=this.services.find(s=>s.id===l);if(!o)return;const n=o.is_active;o.is_active=!o.is_active;try{await this.updateService(l,{service_name:o.service_name,description:o.description,is_active:o.is_active})}catch(s){throw o.is_active=n,console.error("Error toggling service status:",s),s}},clearError(){this.error=null}}}),Y={class:"services-container"},Z={key:0,class:"loading"},ee={key:1,class:"error-message"},te={key:2,class:"table-container"},ae={class:"services-table"},se={class:"service-name"},oe={class:"description"},re={class:"date"},ie={class:"actions"},ne=["onClick","disabled","title"],le={key:0},de={key:1},ce=["onClick","disabled"],ue=["onClick","disabled"],ve={key:0},pe={class:"modal"},me={class:"modal-header"},_e={class:"form-group"},fe={key:0,class:"error"},he={class:"form-group"},ge={class:"form-group checkbox-group"},be={class:"checkbox-label"},ye={class:"modal-footer"},Se=["disabled"],ke={class:"modal modal-small"},Ce={class:"modal-header"},we={class:"modal-body"},De={class:"modal-footer"},xe=["disabled"],Ee={__name:"Services",setup(l){const o=W(),{services:n,loading:s,error:i}=R(o),_=h(!1),m=h(!1),b=h(!1),k=h(null),y=h(null),d=h({service_name:"",description:"",is_active:!0}),f=h({});X(async()=>{await o.fetchServices()});const M=()=>{d.value={service_name:"",description:"",is_active:!0},f.value={}},$=()=>{M(),b.value=!1,k.value=null,_.value=!0},I=r=>{if(!r||!r.id){console.error("Invalid service object");return}d.value={service_name:r.service_name,description:r.description||"",is_active:r.is_active},b.value=!0,k.value=r.id,_.value=!0},C=()=>{_.value=!1,M()},T=()=>(f.value={},d.value.service_name.trim()?d.value.service_name.length>255?(f.value.service_name="Service name must be less than 255 characters",!1):!0:(f.value.service_name="Service name is required",!1)),V=async()=>{var r,t;if(T())try{b.value&&k.value?await o.updateService(k.value,d.value):await o.createService(d.value),C()}catch(S){(t=(r=S.response)==null?void 0:r.data)!=null&&t.errors&&(f.value=S.response.data.errors)}},B=r=>{if(!r||!r.id){console.error("Invalid service object");return}y.value=r,m.value=!0},U=async()=>{var r;if((r=y.value)!=null&&r.id)try{await o.deleteService(y.value.id),m.value=!1,y.value=null}catch(t){console.error("Delete failed:",t)}},j=async r=>{if(!r||!r.id){console.error("Invalid service object");return}try{await o.toggleServiceStatus(r.id)}catch(t){console.error("Toggle status failed:",t)}},L=()=>{o.clearError()},q=r=>r?new Date(r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"N/A";return(r,t)=>(c(),G(P,null,{default:H(()=>{var S;return[e("div",Y,[e("div",{class:"header"},[t[7]||(t[7]=e("h1",{class:"title"},"Services Management",-1)),e("button",{onClick:$,class:"btn btn-primary"},t[6]||(t[6]=[e("span",{class:"icon"},"+",-1),D(" Add New Service ")]))]),u(s)&&!u(n).length?(c(),v("div",Z," Loading services... ")):g("",!0),u(i)?(c(),v("div",ee,[D(p(u(i))+" ",1),e("button",{onClick:L,class:"btn-clear-error"},"Ã—")])):g("",!0),!u(s)||u(n).length?(c(),v("div",te,[e("table",ae,[t[9]||(t[9]=e("thead",null,[e("tr",null,[e("th",null,"Service Name"),e("th",null,"Description"),e("th",null,"Status"),e("th",null,"Created At"),e("th",null,"Actions")])],-1)),e("tbody",null,[(c(!0),v(J,null,K(u(n),a=>(c(),v("tr",{key:(a==null?void 0:a.id)||Math.random()},[e("td",se,p((a==null?void 0:a.service_name)||"N/A"),1),e("td",oe,p((a==null?void 0:a.description)||"No description"),1),e("td",null,[e("span",{class:A(["status-badge",a!=null&&a.is_active?"active":"inactive"])},p(a!=null&&a.is_active?"Active":"Inactive"),3)]),e("td",re,p(q(a==null?void 0:a.created_at)),1),e("td",ie,[e("button",{onClick:N=>j(a),class:A(["btn-action","btn-toggle"]),disabled:!a,title:a!=null&&a.is_active?"Deactivate":"Activate"},[a!=null&&a.is_active?(c(),v("span",le,"â¸")):(c(),v("span",de,"â–¶"))],8,ne),e("button",{onClick:N=>I(a),class:"btn-action btn-edit",disabled:!a,title:"Edit"}," âœï¸ ",8,ce),e("button",{onClick:N=>B(a),class:"btn-action btn-delete",disabled:!a,title:"Delete"}," ðŸ—‘ï¸ ",8,ue)])]))),128)),u(n).length?g("",!0):(c(),v("tr",ve,t[8]||(t[8]=[e("td",{colspan:"5",class:"empty-state"}," No services found. Create your first service to get started. ",-1)])))])])])):g("",!0),_.value?(c(),v("div",{key:3,class:"modal-overlay",onClick:x(C,["self"])},[e("div",pe,[e("div",me,[e("h2",null,p(b.value?"Edit Service":"Create New Service"),1),e("button",{onClick:C,class:"btn-close"},"Ã—")]),e("form",{onSubmit:x(V,["prevent"]),class:"modal-body"},[e("div",_e,[t[10]||(t[10]=e("label",{for:"service_name"},"Service Name *",-1)),E(e("input",{id:"service_name","onUpdate:modelValue":t[0]||(t[0]=a=>d.value.service_name=a),type:"text",required:"",class:"form-control",placeholder:"Enter service name"},null,512),[[F,d.value.service_name]]),f.value.service_name?(c(),v("span",fe,p(f.value.service_name),1)):g("",!0)]),e("div",he,[t[11]||(t[11]=e("label",{for:"description"},"Description",-1)),E(e("textarea",{id:"description","onUpdate:modelValue":t[1]||(t[1]=a=>d.value.description=a),class:"form-control",rows:"4",placeholder:"Enter service description (optional)"},null,512),[[F,d.value.description]])]),e("div",ge,[e("label",be,[E(e("input",{"onUpdate:modelValue":t[2]||(t[2]=a=>d.value.is_active=a),type:"checkbox",class:"checkbox"},null,512),[[O,d.value.is_active]]),t[12]||(t[12]=e("span",null,"Active Service",-1))])]),e("div",ye,[e("button",{type:"button",onClick:C,class:"btn btn-secondary"}," Cancel "),e("button",{type:"submit",disabled:u(s),class:"btn btn-primary"},p(u(s)?"Saving...":b.value?"Update":"Create"),9,Se)])],32)])])):g("",!0),m.value?(c(),v("div",{key:4,class:"modal-overlay",onClick:t[5]||(t[5]=x(a=>m.value=!1,["self"]))},[e("div",ke,[e("div",Ce,[t[13]||(t[13]=e("h2",null,"Confirm Delete",-1)),e("button",{onClick:t[3]||(t[3]=a=>m.value=!1),class:"btn-close"}," Ã— ")]),e("div",we,[e("p",null,[t[14]||(t[14]=D(' Are you sure you want to delete "')),e("strong",null,p((S=y.value)==null?void 0:S.service_name),1),t[15]||(t[15]=D('"? '))]),t[16]||(t[16]=e("p",{class:"warning-text"}," This action cannot be undone. ",-1))]),e("div",De,[e("button",{onClick:t[4]||(t[4]=a=>m.value=!1),class:"btn btn-secondary"}," Cancel "),e("button",{onClick:U,disabled:u(s),class:"btn btn-danger"},p(u(s)?"Deleting...":"Delete"),9,xe)])])])):g("",!0)])]}),_:1}))}},Ve=Q(Ee,[["__scopeId","data-v-c519c7fc"]]);export{Ve as default};
