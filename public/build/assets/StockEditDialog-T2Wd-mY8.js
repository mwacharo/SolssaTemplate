import{P as S,j as _,s as g,d as p,e as T,o as k,a as t,t as d,A as i,C as m,B as b,F as w,g as h,y as I}from"./app-Cngp4Ga2.js";import{_ as N}from"./_plugin-vue_export-helper-DlAUqK2U.js";const C={class:"dialog-header"},E={class:"dialog-content"},O={class:"stock-stats"},D={class:"stat-card"},U={class:"stat-label"},P={class:"stat-value"},V={class:"value"},x={class:"stat-card current"},A={class:"stat-label"},B={class:"stat-value"},j={class:"value"},q={class:"stat-card defected"},M={class:"stat-label"},R={class:"stat-value"},Y={class:"value"},F={class:"form-section"},K={class:"form-row"},H={class:"form-group"},L={class:"form-group"},Q={class:"form-group"},W={class:"form-row"},$={class:"form-group full-width"},z=["value"],G={__name:"StockEditDialog",props:{isOpen:{type:Boolean,default:!1},productId:{type:[String,Number],required:!0},productName:{type:String,default:"Unknown Product"},warehouseId:{type:[String,Number],default:null},currentStock:{type:Number,default:0},committedStock:{type:Number,default:0},defectedStock:{type:Number,default:0},historicalStock:{type:Number,default:0},warehouses:{type:Array,default:()=>[]}},emits:["close","save"],setup(c,{emit:f}){const a=c,l=f,e=S({stockType:"current",operationType:"in",current_stock:"",warehouseId:a.warehouseId||""}),v=_(()=>a.currentStock+a.committedStock+a.historicalStock),n=()=>{l("close")},y=async()=>{const r={product_id:a.productId,warehouse_id:e.warehouseId,current_stock:a.currentStock,committed_stock:a.committedStock,defected_stock:a.defectedStock,historical_stock:a.historicalStock,stock:{type:e.operationType,stock_type:e.stockType,current_stock:e.current_stock}};try{const o=await axios.put(`/api/v1/products/${r.product_id}`,r);console.log("Stock updated successfully:",o.data);const s=o.data.product;if(s.stocks&&s.stocks.length>0){const u=s.stocks[0];l("save",{current_stock:u.current_stock,committed_stock:u.committed_stock,defected_stock:u.defected_stock})}else l("save",r);n()}catch(o){console.error("Error updating stock:",o)}};return g(()=>a.isOpen,r=>{r&&(e.stockType="current",e.operationType="in",e.current_stock=0,e.warehouseId=a.warehouseId||"")}),(r,o)=>c.isOpen?(k(),p("div",{key:0,class:"dialog-overlay",onClick:n},[t("div",{class:"dialog-container",onClick:o[4]||(o[4]=I(()=>{},["stop"]))},[t("div",C,[t("h2",null,'Edit Stock for "'+d(c.productName)+'"',1)]),t("div",E,[t("div",O,[t("div",D,[t("div",U,"Total received: "+d(v.value),1),t("div",P,[o[5]||(o[5]=t("span",{class:"home-icon"},"🏠",-1)),o[6]||(o[6]=t("span",{class:"flag-icon"},"🏁",-1)),t("span",V,d(v.value),1)])]),t("div",x,[t("div",A,"Current: "+d(c.currentStock),1),t("div",B,[o[7]||(o[7]=t("span",{class:"home-icon"},"🏠",-1)),o[8]||(o[8]=t("span",{class:"flag-icon"},"🏁",-1)),t("span",j,d(c.currentStock),1)])]),t("div",q,[t("div",M,"Total defected: "+d(c.defectedStock),1),t("div",R,[o[9]||(o[9]=t("span",{class:"home-icon"},"🏠",-1)),o[10]||(o[10]=t("span",{class:"flag-icon"},"🏁",-1)),t("span",Y,d(c.defectedStock),1)])])]),t("div",F,[t("div",K,[t("div",H,[o[12]||(o[12]=t("label",{for:"stockType"},"STOCK TYPE",-1)),i(t("select",{id:"stockType","onUpdate:modelValue":o[0]||(o[0]=s=>e.stockType=s),class:"form-select"},o[11]||(o[11]=[t("option",{value:"current"},"current",-1),t("option",{value:"committed"},"committed",-1),t("option",{value:"defected"},"defected",-1),t("option",{value:"historical"},"historical",-1)]),512),[[m,e.stockType]])]),t("div",L,[o[14]||(o[14]=t("label",{for:"operationType"},"OPERATION TYPE",-1)),i(t("select",{id:"operationType","onUpdate:modelValue":o[1]||(o[1]=s=>e.operationType=s),class:"form-select"},o[13]||(o[13]=[t("option",{value:"in"},"in",-1),t("option",{value:"out"},"out",-1),t("option",{value:"adjust"},"adjust",-1)]),512),[[m,e.operationType]])]),t("div",Q,[o[15]||(o[15]=t("label",{for:"quantity"},"QUANTITY",-1)),i(t("input",{id:"quantity",type:"number","onUpdate:modelValue":o[2]||(o[2]=s=>e.current_stock=s),class:"form-input",min:"0"},null,512),[[b,e.current_stock,void 0,{number:!0}]])])]),t("div",W,[t("div",$,[o[17]||(o[17]=t("label",{for:"warehouse"},"WAREHOUSE STOCK",-1)),i(t("select",{id:"warehouse","onUpdate:modelValue":o[3]||(o[3]=s=>e.warehouseId=s),class:"form-select"},[o[16]||(o[16]=t("option",{value:""},"Select warehouse for stock",-1)),(k(!0),p(w,null,h(c.warehouses,s=>(k(),p("option",{key:s.id,value:s.id},d(s.name),9,z))),128))],512),[[m,e.warehouseId]])])])])]),t("div",{class:"dialog-footer"},[t("button",{onClick:n,class:"btn-cancel"},"Cancel"),t("button",{onClick:y,class:"btn-save"},"Save")])])])):T("",!0)}},Z=N(G,[["__scopeId","data-v-72ba31fb"]]);export{Z as default};
