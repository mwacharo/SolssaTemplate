import{E as _,i as x,r as d,j as v}from"./app-gl8GMY4q.js";const i=x.create({baseURL:"/api/v1",headers:{Accept:"application/json","Content-Type":"application/json"}}),A=_("countries",()=>{const l=d([]),u=d({}),s=d(!1),n=d(null),p=v(()=>e=>l.value.find(t=>t.id===e)),g=v(()=>e=>l.value.find(t=>t.code===e)),m=v(()=>l.value.filter(e=>e.is_active)),C=v(()=>l.value.length),w=async()=>{var e,t;s.value=!0,n.value=null;try{const{data:a}=await i.get("/countries");l.value=a.data||a}catch(a){n.value=((t=(e=a.response)==null?void 0:e.data)==null?void 0:t.message)||a.message,console.error("Error fetching countries:",a),l.value=[]}finally{s.value=!1}},S=async e=>{var t,a;s.value=!0,n.value=null;try{if(!e.name||!e.code||!e.phone_code)throw new Error("Name, code, and phone code are required");if(g.value(e.code.toUpperCase()))throw new Error("Country code already exists");const r={name:e.name.trim(),code:e.code.toUpperCase().trim(),phone_code:e.phone_code.trim(),is_active:e.is_active??!0},{data:o}=await i.post("/countries",r);l.value.unshift(o.data||o)}catch(r){throw n.value=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message,console.error("Error creating country:",r),r}finally{s.value=!1}},f=async(e,t)=>{var a,r;s.value=!0,n.value=null;try{if(!t.name||!t.code||!t.phone_code)throw new Error("Name, code, and phone code are required");const o=g.value(t.code.toUpperCase());if(o&&o.id!==e)throw new Error("Country code already exists");const c={name:t.name.trim(),code:t.code.toUpperCase().trim(),phone_code:t.phone_code.trim(),is_active:t.is_active??!0},{data:y}=await i.put(`/countries/${e}`,c),h=l.value.findIndex(E=>E.id===e);h!==-1&&(l.value[h]=y.data||y)}catch(o){throw n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||o.message,console.error("Error updating country:",o),o}finally{s.value=!1}};return{countries:l,countrySettings:u,loading:s,error:n,getCountryById:p,getCountryByCode:g,activeCountries:m,totalCountries:C,fetchCountries:w,createCountry:S,updateCountry:f,deleteCountry:async e=>{var t,a;s.value=!0,n.value=null;try{await i.delete(`/countries/${e}`);const r=l.value.findIndex(o=>o.id===e);r!==-1&&l.value.splice(r,1),u.value[e]&&delete u.value[e]}catch(r){throw n.value=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message,console.error("Error deleting country:",r),r}finally{s.value=!1}},toggleCountryStatus:async e=>{const t=p.value(e);t&&await f(e,{...t,is_active:!t.is_active})},getCountrySettings:async e=>{try{if(u.value[e])return u.value[e];const{data:t}=await i.get(`/countries/${e}/settings`);let a=t.data||t;if(a.options&&typeof a.options=="string")try{a.options=JSON.parse(a.options)}catch{a.options={}}return u.value[e]=a,a}catch(t){return console.error("Error fetching country settings:",t),u.value[e]=defaultSettings,defaultSettings}},saveCountrySettings:async(e,t)=>{var a,r;s.value=!0,n.value=null;try{const{data:o}=await i.post(`/countries/${e}/settings`,t),c=o.data||o;return u.value[e]=c,c}catch(o){throw n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||o.message,console.error("Error saving country settings:",o),o}finally{s.value=!1}},updateCountrySettings:async(e,t)=>{var a,r;s.value=!0,n.value=null;try{const{data:o}=await i.put(`/countries/${e}/settings`,t),c=o.data||o;return u.value[e]=c,c}catch(o){throw n.value=((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.message)||o.message,console.error("Error updating country settings:",o),o}finally{s.value=!1}},deleteCountrySettings:async e=>{var t,a;s.value=!0,n.value=null;try{await i.delete(`/countries/${e}/settings`),u.value[e]&&delete u.value[e]}catch(r){throw n.value=((a=(t=r.response)==null?void 0:t.data)==null?void 0:a.message)||r.message,console.error("Error deleting country settings:",r),r}finally{s.value=!1}},uploadLogo:async e=>{var a;const t=new FormData;t.append("logo",e);try{const{data:r}=await i.post("/upload/logo",t,{headers:{"Content-Type":"multipart/form-data"}});return r.url||((a=r.data)==null?void 0:a.url)}catch(r){throw console.error("Error uploading logo:",r),r}},resetStore:()=>{l.value=[],u.value={},s.value=!1,n.value=null}}});export{A as u};
