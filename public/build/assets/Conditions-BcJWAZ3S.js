import{j as y,r as c,k as B,c as R,o as a,w as D,a as e,d as n,e as f,t as i,y as $,A as r,F as _,g,C as x,B as v}from"./app-DtzzgwNC.js";import{_ as j}from"./AppLayout-Dy1KRmk2.js";import{u as q}from"./servicesStore-Dh21g1D8.js";import{u as L}from"./conditionTypeStore-BOp-k1RU.js";import{u as z}from"./condition-GoBd3AeH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-Cu55nJDA.js";import"./africastalking-bEyHLJvt.js";import"./IncomingCallDialog-DJ-xxL2l.js";/* empty css                                                                           */const G={class:"p-6"},H={class:"flex justify-between items-center mb-6"},I={key:0,class:"bg-gray-50 p-6 rounded mb-8 border"},J={class:"text-lg font-semibold mb-4"},K={class:"grid grid-cols-2 gap-4"},O=["value"],Q=["value"],W={class:"mt-4 flex gap-2"},X=["disabled"],Y={class:"bg-white rounded border overflow-x-auto"},Z={class:"w-full"},ee={class:"p-3"},te={class:"p-3"},le={class:"p-3"},oe={class:"p-3"},se={class:"p-3"},ie={class:"p-3"},ae={class:"p-3"},ne={class:"p-3"},re={class:"p-3"},ue={class:"p-3"},de={class:"flex gap-2"},ve=["onClick"],pe=["onClick"],me={key:0},he={__name:"Conditions",setup(ce){const w=q(),k=L(),p=z(),C=y(()=>p.conditions),U=y(()=>w.services),T=y(()=>k.conditionTypes),u=c(!1),d=c(!1),m=c(!1),S={id:null,service_id:"",condition_type_id:"",min_value:"",max_value:"",rate:"",rate_type:"",value:"",priority:"",unit:""},o=c({...S}),b=()=>{o.value={...S},d.value=!1},F=()=>{u.value&&b(),u.value=!u.value},A=()=>{b(),u.value=!1},E=s=>{u.value=!0,d.value=!0,o.value={id:s.id,service_id:s.service_id,condition_type_id:s.condition_type_id,min_value:s.min_value,max_value:s.max_value,rate:s.rate,rate_type:s.rate_type,value:s.value,priority:s.priority,unit:s.unit}},M=async()=>{m.value=!0;try{const s={service_id:o.value.service_id,condition_type_id:o.value.condition_type_id,min_value:o.value.min_value,max_value:o.value.max_value,rate:o.value.rate,rate_type:o.value.rate_type,value:o.value.value,priority:o.value.priority,unit:o.value.unit};d.value?await p.updateCondition(o.value.id,s):await p.createCondition(s),b(),u.value=!1}catch(s){console.error("Error submitting form:",s),alert("Failed to save condition. Please try again.")}finally{m.value=!1}},P=async s=>{if(confirm("Are you sure you want to delete this condition?"))try{await p.deleteCondition(s)}catch(t){console.error("Error deleting condition:",t),alert("Failed to delete condition. Please try again.")}};return B(async()=>{try{await Promise.all([w.fetchServices(),k.fetchAll(),p.fetchConditions()])}catch(s){console.error("Error loading data:",s)}}),(s,t)=>(a(),R(j,null,{default:D(()=>[e("div",G,[e("div",H,[t[9]||(t[9]=e("h1",{class:"text-2xl font-bold"},"Pricing Conditions",-1)),e("button",{onClick:F,class:"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700"},i(u.value?"Close":"Add Condition"),1)]),u.value?(a(),n("div",I,[e("h2",J,i(d.value?"Edit Condition":"Add New Condition"),1),e("form",{onSubmit:$(M,["prevent"])},[e("div",K,[e("div",null,[t[11]||(t[11]=e("label",{class:"block mb-1 font-medium"},"Service",-1)),r(e("select",{"onUpdate:modelValue":t[0]||(t[0]=l=>o.value.service_id=l),class:"w-full border rounded p-2",required:""},[t[10]||(t[10]=e("option",{value:""},"Select Service",-1)),(a(!0),n(_,null,g(U.value,l=>(a(),n("option",{key:l.id,value:l.id},i(l.service_name),9,O))),128))],512),[[x,o.value.service_id]])]),e("div",null,[t[13]||(t[13]=e("label",{class:"block mb-1 font-medium"},"Condition Type",-1)),r(e("select",{"onUpdate:modelValue":t[1]||(t[1]=l=>o.value.condition_type_id=l),class:"w-full border rounded p-2",required:""},[t[12]||(t[12]=e("option",{value:""},"Select Type",-1)),(a(!0),n(_,null,g(T.value,l=>(a(),n("option",{key:l.id,value:l.id},i(l.name),9,Q))),128))],512),[[x,o.value.condition_type_id]])]),e("div",null,[t[14]||(t[14]=e("label",{class:"block mb-1 font-medium"},"Min Value",-1)),r(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=l=>o.value.min_value=l),class:"w-full border rounded p-2",step:"any"},null,512),[[v,o.value.min_value,void 0,{number:!0}]])]),e("div",null,[t[15]||(t[15]=e("label",{class:"block mb-1 font-medium"},"Max Value",-1)),r(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=l=>o.value.max_value=l),class:"w-full border rounded p-2",step:"any"},null,512),[[v,o.value.max_value,void 0,{number:!0}]])]),e("div",null,[t[16]||(t[16]=e("label",{class:"block mb-1 font-medium"},"Rate",-1)),r(e("input",{type:"number",step:"0.01","onUpdate:modelValue":t[4]||(t[4]=l=>o.value.rate=l),class:"w-full border rounded p-2"},null,512),[[v,o.value.rate,void 0,{number:!0}]])]),e("div",null,[t[18]||(t[18]=e("label",{class:"block mb-1 font-medium"},"Rate Type",-1)),r(e("select",{"onUpdate:modelValue":t[5]||(t[5]=l=>o.value.rate_type=l),class:"w-full border rounded p-2"},t[17]||(t[17]=[e("option",{value:""},"Select Rate Type",-1),e("option",{value:"fixed"},"Fixed",-1),e("option",{value:"percentage"},"Percentage",-1),e("option",{value:"per_unit"},"Per Unit",-1)]),512),[[x,o.value.rate_type]])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block mb-1 font-medium"},"Value",-1)),r(e("input",{type:"number",step:"0.01","onUpdate:modelValue":t[6]||(t[6]=l=>o.value.value=l),class:"w-full border rounded p-2",placeholder:"e.g. 100 or 0.15"},null,512),[[v,o.value.value,void 0,{number:!0}]])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block mb-1 font-medium"},"Priority",-1)),r(e("input",{type:"number","onUpdate:modelValue":t[7]||(t[7]=l=>o.value.priority=l),class:"w-full border rounded p-2",min:"0",placeholder:"Lower = higher priority"},null,512),[[v,o.value.priority,void 0,{number:!0}]])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block mb-1 font-medium"},"Unit",-1)),r(e("input",{"onUpdate:modelValue":t[8]||(t[8]=l=>o.value.unit=l),placeholder:"kg, %, km",class:"w-full border rounded p-2"},null,512),[[v,o.value.unit]])])]),e("div",W,[e("button",{type:"submit",disabled:m.value,class:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50"},i(m.value?"Saving...":d.value?"Update Condition":"Save Condition"),9,X),d.value?(a(),n("button",{key:0,type:"button",onClick:A,class:"bg-gray-400 text-white px-4 py-2 rounded hover:bg-gray-500"}," Cancel ")):f("",!0)])],32)])):f("",!0),e("div",Y,[e("table",Z,[t[23]||(t[23]=e("thead",{class:"bg-gray-100"},[e("tr",null,[e("th",{class:"p-3 text-left"},"Service"),e("th",{class:"p-3 text-left"},"Type"),e("th",{class:"p-3 text-left"},"Min"),e("th",{class:"p-3 text-left"},"Max"),e("th",{class:"p-3 text-left"},"Rate"),e("th",{class:"p-3 text-left"},"Rate Type"),e("th",{class:"p-3 text-left"},"Value"),e("th",{class:"p-3 text-left"},"Priority"),e("th",{class:"p-3 text-left"},"Unit"),e("th",{class:"p-3 text-left"},"Actions")])],-1)),e("tbody",null,[(a(!0),n(_,null,g(C.value,l=>{var h,V;return a(),n("tr",{key:l.id,class:"border-t hover:bg-gray-50"},[e("td",ee,i(((h=l.service)==null?void 0:h.service_name)||"N/A"),1),e("td",te,i(((V=l.condition_type)==null?void 0:V.name)||"N/A"),1),e("td",le,i(l.min_value??"-"),1),e("td",oe,i(l.max_value??"-"),1),e("td",se,i(l.rate??"-"),1),e("td",ie,i(l.rate_type||"-"),1),e("td",ae,i(l.value??"-"),1),e("td",ne,i(l.priority??"-"),1),e("td",re,i(l.unit||"-"),1),e("td",ue,[e("div",de,[e("button",{onClick:N=>E(l),class:"text-blue-600 hover:underline"}," Edit ",8,ve),e("button",{onClick:N=>P(l.id),class:"text-red-600 hover:underline"}," Delete ",8,pe)])])])}),128)),C.value.length===0?(a(),n("tr",me,t[22]||(t[22]=[e("td",{colspan:"10",class:"p-4 text-center text-gray-500"}," No conditions created yet. ",-1)]))):f("",!0)])])])])]),_:1}))}};export{he as default};
