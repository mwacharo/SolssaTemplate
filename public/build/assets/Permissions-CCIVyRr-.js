import{i as V,r as d,j as R,k as fe,l as i,c as _e,o as ge,w as t,b as l,a as u,f as s,t as c,y as ye,p as be,q as Ve}from"./app-C_yBjHfN.js";import{_ as xe}from"./AppLayout-COhCKyEA.js";import{n as _}from"./toast-C1GfgDIa.js";import{_ as we}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-DoEMwg0E.js";import"./africastalking-CTQoAx1q.js";import"./IncomingCallDialog-Cx1T0jth.js";/* empty css                                                                           */const Pe={class:"d-flex align-center"},Ce={class:"font-weight-medium"},ke={class:"text-caption text-medium-emphasis"},De={class:"text-caption"},Ue={class:"d-flex gap-1"},Fe={class:"text-center py-8"},Se={class:"text-h5"},he={__name:"Permissions",setup(Ae){V.defaults.withCredentials=!0,V.defaults.headers.common.Accept="application/json";const v=d([]),C=d(!1),g=d(!1),S=d(null),x=d(null),w=d(!1),k=d(!1),r=d({name:"",description:"",guard_name:"sanctum",icon:"mdi-key",color:"primary",active:!0}),h=d(!1),p=d(null),y=d(null),m=d({search:"",status:"",guard:""}),D=d(null),H=[{title:"Permission",value:"name",sortable:!0},{title:"Description",value:"description",sortable:!1},{title:"Status",value:"active",sortable:!0},{title:"Guard",value:"guard_name",sortable:!0},{title:"Actions",value:"actions",sortable:!1,width:"120px"}],A={required:o=>!!o||"This field is required",minLength:o=>o&&o.length>=2||"Minimum 2 characters required"},J=[{title:"Active",value:!0},{title:"Inactive",value:!1}],$=[{title:"Sanctum",value:"sanctum"},{title:"Web",value:"web"},{title:"API",value:"api"}],Q=[{title:"Key",value:"mdi-key"},{title:"Shield",value:"mdi-shield"},{title:"Account",value:"mdi-account"},{title:"Cog",value:"mdi-cog"},{title:"Database",value:"mdi-database"},{title:"Eye",value:"mdi-eye"},{title:"Pencil",value:"mdi-pencil"},{title:"Delete",value:"mdi-delete"},{title:"Plus",value:"mdi-plus"},{title:"Chart",value:"mdi-chart-line"}],X=[{title:"Primary",value:"primary"},{title:"Success",value:"success"},{title:"Info",value:"info"},{title:"Warning",value:"warning"},{title:"Error",value:"error"},{title:"Green",value:"green"},{title:"Blue",value:"blue"},{title:"Purple",value:"purple"},{title:"Orange",value:"orange"}],E=R(()=>p.value!==null),B=R(()=>{let o=v.value;if(m.value.search){const e=m.value.search.toLowerCase();o=o.filter(n=>n.name&&n.name.toLowerCase().includes(e)||n.description&&n.description.toLowerCase().includes(e))}return m.value.status!==""&&(o=o.filter(e=>e.active===m.value.status)),m.value.guard&&(o=o.filter(e=>e.guard_name===m.value.guard)),o});async function Y(){C.value=!0;try{const{data:o}=await V.get("/api/v1/admin/permissions");v.value=o}catch(o){_.error("Failed to load permissions"),console.error("Error fetching permissions:",o)}finally{C.value=!1}}async function Z(){g.value=!0;try{const{data:o}=await V.post("/api/v1/admin/permissions",r.value);v.value.push(o),_.success("Permission created successfully"),z()}catch(o){_.error("Failed to create permission"),console.error("Error creating permission:",o)}finally{g.value=!1}}async function ee(){g.value=!0,S.value=p.value;try{const{data:o}=await V.put(`/api/v1/admin/permissions/${p.value}`,r.value),e=v.value.findIndex(n=>n.id===p.value);e!==-1&&(v.value[e]=o),_.success("Permission updated successfully"),z()}catch(o){_.error("Failed to update permission"),console.error("Error updating permission:",o)}finally{g.value=!1,S.value=null}}async function le(){x.value=y.value.id;try{await V.delete(`/api/v1/admin/permissions/${y.value.id}`),v.value=v.value.filter(o=>o.id!==y.value.id),_.success("Permission deleted successfully"),G()}catch(o){_.error("Failed to delete permission"),console.error("Error deleting permission:",o)}finally{x.value=null}}function te(){D.value.validate()&&(E.value?ee():Z())}function ae(){I(),p.value=null,w.value=!0}function oe(o){I(),r.value={name:o.name,description:o.description||"",guard_name:o.guard_name,icon:o.icon||"mdi-key",color:o.color||"primary",active:o.active},p.value=o.id,w.value=!0}function ie(o){y.value=o,k.value=!0}function z(){w.value=!1,I(),p.value=null}function G(){k.value=!1,y.value=null}function I(){r.value={name:"",description:"",guard_name:"sanctum",icon:"mdi-key",color:"primary",active:!0},D.value&&D.value.resetValidation()}function ne(o){return o.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase())}return fe(()=>{Y()}),(o,e)=>{const n=i("v-col"),f=i("v-btn"),N=i("v-row"),b=i("v-icon"),U=i("v-card-title"),M=i("v-text-field"),P=i("v-select"),q=i("v-card-text"),F=i("v-card"),se=i("v-divider"),L=i("v-chip"),re=i("v-skeleton-loader"),ue=i("v-data-table"),de=i("v-textarea"),me=i("v-list-item"),ce=i("v-switch"),T=i("v-container"),j=i("v-spacer"),W=i("v-card-actions"),ve=i("v-form"),K=i("v-dialog"),pe=i("v-alert");return ge(),_e(xe,null,{default:t(()=>[l(T,null,{default:t(()=>[l(N,{class:"mb-4 align-center"},{default:t(()=>[l(n,null,{default:t(()=>e[12]||(e[12]=[u("h2",{class:"text-h4"},"Permissions Management",-1)])),_:1,__:[12]}),l(n,{cols:"auto"},{default:t(()=>[l(f,{color:"primary","prepend-icon":"mdi-plus",onClick:ae,loading:C.value},{default:t(()=>e[13]||(e[13]=[s(" Create Permission ")])),_:1,__:[13]},8,["loading"])]),_:1})]),_:1}),l(F,{class:"mb-4",variant:"outlined"},{default:t(()=>[l(U,{class:"text-subtitle-1 pb-2"},{default:t(()=>[l(b,{left:""},{default:t(()=>e[14]||(e[14]=[s("mdi-filter")])),_:1,__:[14]}),e[15]||(e[15]=s(" Search & Filter "))]),_:1,__:[15]}),l(q,null,{default:t(()=>[l(N,null,{default:t(()=>[l(n,{cols:"12",md:"6"},{default:t(()=>[l(M,{modelValue:m.value.search,"onUpdate:modelValue":e[0]||(e[0]=a=>m.value.search=a),label:"Search permissions...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",hint:"Search by permission name","persistent-hint":""},null,8,["modelValue"])]),_:1}),l(n,{cols:"12",md:"3"},{default:t(()=>[l(P,{modelValue:m.value.status,"onUpdate:modelValue":e[1]||(e[1]=a=>m.value.status=a),label:"Status",items:J,variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1}),l(n,{cols:"12",md:"3"},{default:t(()=>[l(P,{modelValue:m.value.guard,"onUpdate:modelValue":e[2]||(e[2]=a=>m.value.guard=a),label:"Guard",items:$,variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(F,null,{default:t(()=>[l(U,{class:"text-subtitle-1"},{default:t(()=>[l(b,{left:""},{default:t(()=>e[16]||(e[16]=[s("mdi-key")])),_:1,__:[16]}),s(" All Permissions ("+c(B.value.length)+") ",1)]),_:1}),l(se),l(ue,{headers:H,items:B.value,loading:C.value,"item-value":"id",class:"elevation-0","items-per-page":25},{"item.name":t(({item:a})=>[u("div",Pe,[l(b,{icon:a.icon||"mdi-key",color:a.color||"primary",class:"mr-2",size:"small"},null,8,["icon","color"]),u("div",null,[u("div",Ce,c(ne(a.name)),1),u("div",ke,c(a.name),1)])])]),"item.description":t(({item:a})=>[u("span",De,c(a.description||"No description available"),1)]),"item.active":t(({item:a})=>[l(L,{color:a.active?"success":"error",size:"small",variant:"flat"},{default:t(()=>[s(c(a.active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.guard_name":t(({item:a})=>[l(L,{color:"info",size:"small",variant:"outlined"},{default:t(()=>[s(c(a.guard_name),1)]),_:2},1024)]),"item.actions":t(({item:a})=>[u("div",Ue,[l(f,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:O=>oe(a),loading:S.value===a.id},null,8,["onClick","loading"]),l(f,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:O=>ie(a),loading:x.value===a.id},null,8,["onClick","loading"])])]),loading:t(()=>[l(re,{type:"table-row@10"})]),"no-data":t(()=>[u("div",Fe,[l(b,{size:"64",color:"grey-lighten-1"},{default:t(()=>e[17]||(e[17]=[s("mdi-key-off")])),_:1,__:[17]}),e[18]||(e[18]=u("div",{class:"text-h6 mt-4"},"No permissions found",-1)),e[19]||(e[19]=u("div",{class:"text-caption"},"Create your first permission to get started",-1))])]),_:1},8,["items","loading"])]),_:1}),l(K,{modelValue:w.value,"onUpdate:modelValue":e[10]||(e[10]=a=>w.value=a),"max-width":"600px",persistent:""},{default:t(()=>[l(F,null,{default:t(()=>[l(U,null,{default:t(()=>[u("span",Se,c(E.value?"Edit Permission":"Create New Permission"),1)]),_:1}),l(ve,{ref_key:"permissionForm",ref:D,modelValue:h.value,"onUpdate:modelValue":e[9]||(e[9]=a=>h.value=a),onSubmit:ye(te,["prevent"])},{default:t(()=>[l(q,null,{default:t(()=>[l(T,null,{default:t(()=>[l(N,null,{default:t(()=>[l(n,{cols:"12"},{default:t(()=>[l(M,{modelValue:r.value.name,"onUpdate:modelValue":e[3]||(e[3]=a=>r.value.name=a),label:"Permission Name *",rules:[A.required,A.minLength],variant:"outlined",density:"comfortable",placeholder:"e.g., manage_users, create_posts",hint:"Use snake_case format for permission names","persistent-hint":""},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"12"},{default:t(()=>[l(de,{modelValue:r.value.description,"onUpdate:modelValue":e[4]||(e[4]=a=>r.value.description=a),label:"Description",variant:"outlined",density:"comfortable",rows:"3",placeholder:"Describe what this permission allows users to do"},null,8,["modelValue"])]),_:1}),l(n,{cols:"12",md:"6"},{default:t(()=>[l(P,{modelValue:r.value.guard_name,"onUpdate:modelValue":e[5]||(e[5]=a=>r.value.guard_name=a),label:"Guard Name *",items:$,rules:[A.required],variant:"outlined",density:"comfortable"},null,8,["modelValue","rules"])]),_:1}),l(n,{cols:"12",md:"6"},{default:t(()=>[l(P,{modelValue:r.value.icon,"onUpdate:modelValue":e[6]||(e[6]=a=>r.value.icon=a),label:"Icon",items:Q,variant:"outlined",density:"comfortable"},{selection:t(({item:a})=>[l(b,{icon:a.value,class:"mr-2"},null,8,["icon"]),s(" "+c(a.title),1)]),item:t(({props:a,item:O})=>[l(me,be(Ve(a)),{prepend:t(()=>[l(b,{icon:O.value},null,8,["icon"])]),_:2},1040)]),_:1},8,["modelValue"])]),_:1}),l(n,{cols:"12",md:"6"},{default:t(()=>[l(P,{modelValue:r.value.color,"onUpdate:modelValue":e[7]||(e[7]=a=>r.value.color=a),label:"Color",items:X,variant:"outlined",density:"comfortable"},{selection:t(({item:a})=>[l(L,{color:a.value,size:"small",class:"mr-2"},null,8,["color"]),s(" "+c(a.title),1)]),_:1},8,["modelValue"])]),_:1}),l(n,{cols:"12",md:"6"},{default:t(()=>[l(ce,{modelValue:r.value.active,"onUpdate:modelValue":e[8]||(e[8]=a=>r.value.active=a),label:"Active",color:"success",inset:""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1}),l(W,null,{default:t(()=>[l(j),l(f,{variant:"text",onClick:z,disabled:g.value},{default:t(()=>e[20]||(e[20]=[s(" Cancel ")])),_:1,__:[20]},8,["disabled"]),l(f,{color:"primary",variant:"flat",type:"submit",loading:g.value,disabled:!h.value},{default:t(()=>[s(c(E.value?"Update":"Create"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),l(K,{modelValue:k.value,"onUpdate:modelValue":e[11]||(e[11]=a=>k.value=a),"max-width":"400px"},{default:t(()=>[l(F,null,{default:t(()=>[l(U,{class:"text-h5"},{default:t(()=>e[21]||(e[21]=[s(" Confirm Delete ")])),_:1,__:[21]}),l(q,null,{default:t(()=>{var a;return[e[23]||(e[23]=s(" Are you sure you want to delete the permission ")),u("strong",null,'"'+c((a=y.value)==null?void 0:a.name)+'"',1),e[24]||(e[24]=s("? ")),e[25]||(e[25]=u("br",null,null,-1)),e[26]||(e[26]=u("br",null,null,-1)),l(pe,{color:"warning",variant:"outlined",class:"mt-3"},{default:t(()=>e[22]||(e[22]=[s(" This action cannot be undone and may affect users with this permission. ")])),_:1,__:[22]})]}),_:1,__:[23,24,25,26]}),l(W,null,{default:t(()=>[l(j),l(f,{variant:"text",onClick:G,disabled:x.value},{default:t(()=>e[27]||(e[27]=[s(" Cancel ")])),_:1,__:[27]},8,["disabled"]),l(f,{color:"error",variant:"flat",onClick:le,loading:x.value},{default:t(()=>e[28]||(e[28]=[s(" Delete ")])),_:1,__:[28]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}},Be=we(he,[["__scopeId","data-v-04b228e2"]]);export{Be as default};
