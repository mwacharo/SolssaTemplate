import{r as m,j as P,k as Y,s as Z,l as F,c as T,o as i,w as ee,a as e,d as p,e as $,t as l,b as d,f as M,u,A as c,B as v,C as te,F as U,g as A,n as V,y as se}from"./app-CHoQCFC8.js";import{_ as le}from"./AppLayout-B0_kK10Y.js";import{u as oe}from"./orderStore-CvNFQ3dN.js";import{P as ne,C as ae,E as ie,S as re,a as de}from"./square-pen-LnSw_L6Y.js";import{S as ue,F as pe}from"./search-BpzDZTzU.js";import{T as ce,P as me}from"./truck-DcFZ7nPP.js";import{c as ve}from"./createLucideIcon-BBwNIU4y.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-DaCV71Qm.js";import"./africastalking-Xr3Uw7Gj.js";import"./IncomingCallDialog-RiAuKaDL.js";/* empty css                                                                           */import"./toast-Q9R16pnq.js";/**
 * @license lucide-vue-next v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=ve("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),be={class:"min-h-screen bg-gray-50 p-6"},xe={class:"max-w-7xl mx-auto"},ye={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},_e={class:"flex justify-between items-center mb-6"},fe={class:"text-gray-600 mt-1"},he={class:"flex flex-col md:flex-row gap-4"},we={class:"flex-1 relative"},ke={class:"flex items-center gap-2"},Ce={class:"bg-white rounded-lg shadow-sm overflow-hidden"},Ve={class:"overflow-x-auto"},Se={class:"w-full"},De={class:"px-4 py-3"},Ee={class:"px-4 py-3"},Pe={class:"flex items-center gap-2"},Ue={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm"},Ae={class:"px-4 py-3"},ze={class:"px-4 py-3"},Ne={class:"px-4 py-3"},qe={class:"text-orange-600 hover:text-orange-700"},Fe={class:"px-4 py-3"},Te={class:"flex items-center gap-2"},$e={class:"text-2xl"},Me={class:"text-sm"},je={class:"px-4 py-3"},Oe={class:"px-4 py-3"},Be={class:"px-4 py-3"},Ie={class:"px-4 py-3"},Le={class:"px-4 py-3"},We={class:"px-4 py-3"},Ke={class:"px-4 py-3"},Qe={class:"text-sm"},Re={class:"px-4 py-3"},Xe={class:"flex gap-2"},Ge=["onClick"],He={class:"p-2 hover:bg-gray-100 rounded-lg",title:"Edit"},Je=["onClick"],Ye={class:"border-t p-4 flex justify-between items-center"},Ze={class:"text-sm text-gray-600"},et={class:"flex gap-2"},tt=["disabled"],st=["onClick"],lt=["disabled"],ot={key:0,class:"fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50 p-4"},nt={class:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto"},at={class:"grid grid-cols-2 gap-4"},it={class:"bg-gray-50 rounded-lg p-4"},rt={class:"overflow-x-auto mt-4"},dt={class:"w-full text-sm"},ut={class:"px-3 py-2"},pt={class:"px-3 py-2"},ct=["onUpdate:modelValue"],mt={class:"px-3 py-2"},vt=["onClick"],gt={key:0},bt={class:"pt-4 flex justify-between items-center"},xt={class:"text-sm text-gray-600"},yt={class:"flex gap-3 justify-end pt-4"},_t={key:1,class:"fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50 p-4"},ft={class:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto"},ht={class:"sticky top-0 bg-white border-b p-6"},wt={class:"flex justify-between items-center"},kt={class:"text-2xl font-bold"},Ct={class:"p-6 space-y-6"},Vt={class:"bg-gray-50 rounded-lg p-4"},St={class:"grid grid-cols-2 gap-4"},Dt={class:"font-semibold"},Et={class:"font-semibold"},Pt={class:"font-semibold"},Ut={class:"font-semibold"},At={class:"font-semibold"},zt={class:"font-semibold"},Nt={class:"font-semibold"},qt={class:"font-semibold"},Ft={class:"font-semibold"},Tt={class:"bg-gray-50 rounded-lg p-4"},$t={class:"font-semibold text-lg mb-4"},Mt={class:"space-y-3"},jt={class:"font-medium"},Ot={class:"text-sm text-gray-600"},Bt={class:"bg-gray-50 rounded-lg p-4"},It={class:"grid grid-cols-2 gap-4"},Lt={class:"font-semibold"},S=6,os={__name:"Index",setup(Wt){const y=oe();m(null);const O=o=>{window.confirm("Are you sure you want to delete this expense?")&&(expenses.value=expenses.value.filter(t=>t.id!==o))},B=o=>{const t=y.productOptions.find(g=>g.sku===o.product.sku);t&&(o.product.name=t.product_name)},I=o=>{n.value.shipment_items.splice(o,1)},_=m([]),a=m(null),D=m(!1),z=m(!1),f=m(""),h=m("all"),r=m(1),L=P(()=>y.vendorOptions),N=m(null),n=m({source_country:"",destination:"",warehouse_id:null,shipment_date:"",arrival_date:"",transporter_name:"",tracking_number:"",packages_number:1,weight:0,shipment_fees:0,vendor_id:null,shipment_items:[]});Y(async()=>{try{await y.fetchDropdownOptions()}catch(o){console.error("Failed to load vendors:",o)}try{const o=await axios.get("/api/v1/expeditions");_.value=o.data.expeditions.data??[]}catch(o){console.error("Failed to load expeditions:",o),_.value=[]}});const w=P(()=>{let o=_.value;if(f.value){const t=f.value.toLowerCase();o=o.filter(g=>{var k,E,C;return((k=g.tracking_number)==null?void 0:k.toLowerCase().includes(t))||((E=g.source_country)==null?void 0:E.toLowerCase().includes(t))||((C=g.transporter_name)==null?void 0:C.toLowerCase().includes(t))})}return h.value!=="all"&&(o=o.filter(t=>t.shipment_status===h.value)),o}),q=P(()=>Math.ceil(w.value.length/S)),W=P(()=>{const o=(r.value-1)*S,t=r.value*S;return w.value.slice(o,t)});Z([f,h],()=>{r.value=1});const K=o=>({expedited:"bg-orange-500",delivered:"bg-green-500",pending:"bg-yellow-500",cancelled:"bg-red-500"})[o]||"bg-gray-500",Q=o=>({approved:"bg-green-500",pending:"bg-yellow-500",draft:"bg-gray-500"})[o]||"bg-gray-500",R=o=>({Nigeria:"ðŸ‡³ðŸ‡¬",China:"ðŸ‡¨ðŸ‡³"})[o]||"ðŸŒ",X=o=>{n.value.vendor_id=o},G=async()=>{var o;try{const g=(await axios.post("/api/v1/expeditions",n.value)).data.expedition;_.value=[g,..._.value],D.value=!1,n.value={source_country:"",destination:"",warehouse_id:null,shipment_date:"",arrival_date:"",transporter_name:"",tracking_number:"",packages_number:1,weight:0,shipment_fees:0,vendor_id:null,shipment_items:[]},N.value=null}catch(t){console.error("Failed to create expedition:",t),((o=t.response)==null?void 0:o.status)===422&&console.log("Validation Errors:",t.response.data.errors)}},H=o=>{a.value=o,z.value=!0};return(o,t)=>{const g=F("Trash2"),k=F("v-select"),E=F("v-autocomplete");return i(),T(le,null,{default:ee(()=>{var C;return[e("div",be,[e("div",xe,[e("div",ye,[e("div",_e,[e("div",null,[t[18]||(t[18]=e("h1",{class:"text-3xl font-bold text-gray-800"}," Expeditions ",-1)),e("p",fe,l(w.value.length)+" total expeditions ",1)]),e("button",{onClick:t[0]||(t[0]=s=>D.value=!0),class:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"},[d(u(ne),{size:20}),t[19]||(t[19]=M(" Add Expedition "))])]),e("div",he,[e("div",we,[d(u(ue),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),c(e("input",{type:"text",placeholder:"Search by tracking, country, or transporter...",class:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s)},null,512),[[v,f.value]])]),e("div",ke,[d(u(pe),{size:20,class:"text-gray-400"}),c(e("select",{class:"border rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[2]||(t[2]=s=>h.value=s)},t[20]||(t[20]=[e("option",{value:"all"},"All Status",-1),e("option",{value:"expedited"},"Expedited",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"delivered"},"Delivered",-1),e("option",{value:"cancelled"},"Cancelled",-1)]),512),[[te,h.value]])])])]),e("div",Ce,[e("div",Ve,[e("table",Se,[t[21]||(t[21]=e("thead",{class:"bg-blue-600 text-white"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left"},"ID"),e("th",{class:"px-4 py-3 text-left"},"Vendor"),e("th",{class:"px-4 py-3 text-left"},"Weight"),e("th",{class:"px-4 py-3 text-left"}," Packages "),e("th",{class:"px-4 py-3 text-left"},"Details"),e("th",{class:"px-4 py-3 text-left"},"From"),e("th",{class:"px-4 py-3 text-left"},"To"),e("th",{class:"px-4 py-3 text-left"}," Expedition Date "),e("th",{class:"px-4 py-3 text-left"}," Arrival Date "),e("th",{class:"px-4 py-3 text-left"},"Fees"),e("th",{class:"px-4 py-3 text-left"},"Status"),e("th",{class:"px-4 py-3 text-left"}," Approval "),e("th",{class:"px-4 py-3 text-left"}," Remittance "),e("th",{class:"px-4 py-3 text-left"},"Actions")])],-1)),e("tbody",null,[(i(!0),p(U,null,A(W.value,(s,b)=>{var x,j;return i(),p("tr",{key:s.id,class:V(b%2===0?"bg-amber-50":"bg-white")},[e("td",De,l(s.id),1),e("td",Ee,[e("div",Pe,[e("div",Ue,l(((x=s.vendor)==null?void 0:x.name)||"N/A"),1)])]),e("td",Ae,l(s.weight),1),e("td",ze,l(s.packages_number),1),e("td",Ne,[e("button",qe,l(s.shipment_items.length)+" products ",1)]),e("td",Fe,[e("div",Te,[e("span",$e,l(R(s.source_country)),1),e("span",Me,l(s.source_country),1)])]),e("td",je,l((j=s.warehouse)==null?void 0:j.name),1),e("td",Oe,l(s.shipment_date),1),e("td",Be,l(s.arrival_date.split(" ")[0]),1),e("td",Ie,l(s.shipment_fees)+" KES ",1),e("td",Le,[e("span",{class:V(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs text-white",K(s.shipment_status)])},[d(u(ce),{size:12}),M(" "+l(s.shipment_status),1)],2)]),e("td",We,[e("span",{class:V(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs text-white",Q(s.approval_status)])},[s.approval_status==="approved"?(i(),T(u(ae),{key:0,size:12})):(i(),T(u(ge),{key:1,size:12})),M(" "+l(s.approval_status),1)],2)]),e("td",Ke,[e("span",Qe,l(s.transporter_reimbursement_status==="paid"?"Paid by vendor":"Not paid"),1)]),e("td",Re,[e("div",Xe,[e("button",{onClick:J=>H(s),class:"p-2 hover:bg-gray-100 rounded-lg",title:"View Details"},[d(u(ie),{size:18,class:"text-gray-600"})],8,Ge),e("button",He,[d(u(re),{size:18,class:"text-gray-600"})]),e("button",{onClick:J=>O(s.id),class:"p-2 hover:bg-gray-100 rounded-lg transition",title:"Delete"},[d(g,{size:18,class:"text-red-600"})],8,Je)])])],2)}),128))])])]),e("div",Ye,[e("div",Ze," Showing "+l((r.value-1)*S+1)+" to "+l(Math.min(r.value*S,w.value.length))+" of "+l(w.value.length)+" expeditions ",1),e("div",et,[e("button",{onClick:t[3]||(t[3]=s=>r.value=Math.max(1,r.value-1)),disabled:r.value===1,class:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,tt),(i(!0),p(U,null,A(q.value,s=>(i(),p("button",{key:s,onClick:b=>r.value=s,class:V(["px-4 py-2 rounded-lg",r.value===s?"bg-blue-600 text-white":"border hover:bg-gray-50"])},l(s),11,st))),128)),e("button",{onClick:t[4]||(t[4]=s=>r.value=Math.min(q.value,r.value+1)),disabled:r.value===q.value,class:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,lt)])])])]),D.value?(i(),p("div",ot,[e("div",nt,[t[35]||(t[35]=e("div",{class:"sticky top-0 bg-white border-b p-6"},[e("h2",{class:"text-2xl font-bold"},"Add New Expedition")],-1)),e("form",{onSubmit:se(G,["prevent"]),class:"p-6 space-y-4"},[e("div",at,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium mb-2"},"Source Country",-1)),c(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[5]||(t[5]=s=>n.value.source_country=s)},null,512),[[v,n.value.source_country]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium mb-2"},"Destination",-1)),d(k,{modelValue:n.value.warehouse_id,"onUpdate:modelValue":t[6]||(t[6]=s=>n.value.warehouse_id=s),items:u(y).warehouseOptions,"item-title":"name","item-value":"id",label:"Destination Warehouse","prepend-inner-icon":"mdi-warehouse",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium mb-2"},"Shipment Date",-1)),c(e("input",{type:"date",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[7]||(t[7]=s=>n.value.shipment_date=s)},null,512),[[v,n.value.shipment_date]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium mb-2"},"Expected Arrival",-1)),c(e("input",{type:"date",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[8]||(t[8]=s=>n.value.arrival_date=s)},null,512),[[v,n.value.arrival_date]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium mb-2"},"Transporter",-1)),c(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[9]||(t[9]=s=>n.value.transporter_name=s)},null,512),[[v,n.value.transporter_name]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium mb-2"},"Tracking Number",-1)),c(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[10]||(t[10]=s=>n.value.tracking_number=s)},null,512),[[v,n.value.tracking_number]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium mb-2"},"Packages",-1)),c(e("input",{type:"number",min:"1",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[11]||(t[11]=s=>n.value.packages_number=s)},null,512),[[v,n.value.packages_number,void 0,{number:!0}]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium mb-2"},"Weight (kg)",-1)),c(e("input",{type:"number",min:"0",step:"0.1",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[12]||(t[12]=s=>n.value.weight=s)},null,512),[[v,n.value.weight,void 0,{number:!0}]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium mb-2"},"Shipment Fees (KES)",-1)),c(e("input",{type:"number",min:"0",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[13]||(t[13]=s=>n.value.shipment_fees=s)},null,512),[[v,n.value.shipment_fees,void 0,{number:!0}]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium mb-2"},"Vendor ",-1)),d(k,{modelValue:N.value,"onUpdate:modelValue":[t[14]||(t[14]=s=>N.value=s),X],items:L.value,"item-title":"name","item-value":"id",label:"Vendor","prepend-inner-icon":"mdi-domain",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),e("div",it,[e("div",rt,[e("table",dt,[t[33]||(t[33]=e("thead",null,[e("tr",{class:"text-left bg-gray-100"},[e("th",{class:"px-3 py-2 w-1/2"}," Product "),e("th",{class:"px-3 py-2 w-32"}," Quantity "),e("th",{class:"px-3 py-2 w-32"}," Actions ")])],-1)),e("tbody",null,[(i(!0),p(U,null,A(n.value.shipment_items,(s,b)=>(i(),p("tr",{key:b,class:"bg-white even:bg-gray-50"},[e("td",ut,[d(E,{modelValue:s.product.id,"onUpdate:modelValue":[x=>s.product.id=x,x=>B(s)],items:u(y).productOptions,"item-title":"product_name","item-value":"id",placeholder:"Select product",density:"compact","hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),e("td",pt,[c(e("input",{type:"number",min:"1",class:"w-full border rounded px-2 py-1","onUpdate:modelValue":x=>s.quantity_sent=x},null,8,ct),[[v,s.quantity_sent,void 0,{number:!0}]])]),e("td",mt,[e("button",{type:"button",class:"px-3 py-1 border rounded hover:bg-gray-100",onClick:x=>I(b)}," Remove ",8,vt)])]))),128)),n.value.shipment_items.length?$("",!0):(i(),p("tr",gt,t[32]||(t[32]=[e("td",{colspan:"3",class:"px-3 py-4 text-gray-500 text-center"}," No products added yet. ",-1)])))])])]),e("div",bt,[e("button",{type:"button",class:"mt-3 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",onClick:t[15]||(t[15]=s=>{n.value.shipment_items=n.value.shipment_items||[],n.value.shipment_items.push({product:{name:""},quantity_sent:1,product:{sku:""},product:{id:""}})})}," + Add Product "),e("div",xt," Total units: "+l((n.value.shipment_items||[]).reduce((s,b)=>s+(Number(b.quantity_sent)||0),0)),1)])]),e("div",yt,[e("button",{type:"button",onClick:t[16]||(t[16]=s=>D.value=!1),class:"px-4 py-2 border rounded-lg hover:bg-gray-50"}," Cancel "),t[34]||(t[34]=e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Create Expedition ",-1))])],32)])])):$("",!0),z.value&&a.value?(i(),p("div",_t,[e("div",ft,[e("div",ht,[e("div",wt,[e("h2",kt," Expedition Details #"+l(a.value.id),1),e("button",{onClick:t[17]||(t[17]=s=>z.value=!1),class:"text-gray-500 hover:text-gray-700"},[d(u(de),{size:24})])])]),e("div",Ct,[e("div",Vt,[t[46]||(t[46]=e("h3",{class:"font-semibold text-lg mb-4"}," Shipment Information ",-1)),e("div",St,[e("div",null,[t[36]||(t[36]=e("p",{class:"text-sm text-gray-600"}," Tracking Number ",-1)),e("p",Dt,l(a.value.tracking_number),1)]),e("div",null,[t[37]||(t[37]=e("p",{class:"text-sm text-gray-600"}," Transporter ",-1)),e("p",Et,l(a.value.transporter_name),1)]),e("div",null,[t[38]||(t[38]=e("p",{class:"text-sm text-gray-600"}," Source Country ",-1)),e("p",Pt,l(a.value.source_country),1)]),e("div",null,[t[39]||(t[39]=e("p",{class:"text-sm text-gray-600"}," Destination ",-1)),e("p",Ut,l((C=a.value.warehouse)==null?void 0:C.name)+", ",1)]),e("div",null,[t[40]||(t[40]=e("p",{class:"text-sm text-gray-600"}," Shipment Date ",-1)),e("p",At,l(a.value.shipment_date),1)]),e("div",null,[t[41]||(t[41]=e("p",{class:"text-sm text-gray-600"}," Arrival Date ",-1)),e("p",zt,l(a.value.arrival_date),1)]),e("div",null,[t[42]||(t[42]=e("p",{class:"text-sm text-gray-600"},"Weight",-1)),e("p",Nt,l(a.value.weight)+" kg ",1)]),e("div",null,[t[43]||(t[43]=e("p",{class:"text-sm text-gray-600"}," Packages ",-1)),e("p",qt,l(a.value.packages_number),1)]),e("div",null,[t[44]||(t[44]=e("p",{class:"text-sm text-gray-600"},"Fees",-1)),e("p",Ft,l(a.value.shipment_fees)+" KES ",1)]),e("div",null,[t[45]||(t[45]=e("p",{class:"text-sm text-gray-600"}," Payment Status ",-1)),e("span",{class:V(["inline-block px-2 py-1 rounded text-xs text-white",a.value.transporter_reimbursement_status==="paid"?"bg-green-500":"bg-red-500"])},l(a.value.transporter_reimbursement_status),3)])])]),e("div",Tt,[e("h3",$t," Products ("+l(a.value.shipment_items.length)+") ",1),e("div",Mt,[(i(!0),p(U,null,A(a.value.shipment_items,(s,b)=>(i(),p("div",{key:b,class:"bg-white rounded-lg p-3 flex justify-between items-center"},[e("div",null,[e("p",jt,l(s.product.product_name),1),e("p",Ot," Quantity: "+l(s.quantity_sent)+" units ",1)]),d(u(me),{class:"text-blue-500",size:20})]))),128))])]),e("div",Bt,[t[49]||(t[49]=e("h3",{class:"font-semibold text-lg mb-4"}," Vendor Information ",-1)),e("div",It,[e("div",null,[t[47]||(t[47]=e("p",{class:"text-sm text-gray-600"},"Name",-1)),e("p",Lt,l(a.value.vendor.name),1)]),t[48]||(t[48]=e("div",null,[e("p",{class:"text-sm text-gray-600"}," Username ")],-1))])])])])])):$("",!0)])]}),_:1})}}};export{os as default};
