import{r as c,j as w,s as He,k as Ne,l as Ie,c as $e,o as i,w as We,a as t,b as p,d,A as O,u as l,B as Ye,e as b,f as g,t as a,D as ae,F as y,g as C,n as A,V as Ge}from"./app-BfTUaguK.js";import{_ as Ze}from"./AppLayout-B2tFeSvb.js";import{u as Ke,W as qe}from"./WhatsAppConversation-BdD3aI7K.js";import{u as Je}from"./orderStore-CI0ablow.js";import"./africastalking-DlNsz1fk.js";import{u as Qe,C as Xe}from"./CallCentreDialler-B2gfbIio.js";import{u as et,S as tt}from"./Stkpush-CrKr_dkX.js";import st from"./OrderForm-DHB-ZBK0.js";import ot from"./OrderCallHistory-CAJQ3gtW.js";import lt from"./OrderExpenses-DD3iFk-G.js";import nt from"./BulkAction-DKghLu2w.js";import at from"./CallDialogs-DBgwvqlk.js";import{D as M}from"./DualDatePicker-BhCT5V8z.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-R5zbbFb9.js";import"./IncomingCallDialog-BHAiMNLZ.js";/* empty css                                                                           */import"./toast-RzEVnAJt.js";import"./whatsappStore-BW5anos6.js";import"./auth-CeI1G741.js";/* empty css                                                                             */import"./callCenter-zM-XfxUL.js";import"./contact-BkMie6gM.js";const rt={class:"min-h-screen bg-gray-50"},it={class:"p-6"},dt={class:"mb-6"},ut={class:"relative"},pt={class:"bg-white p-4 rounded-lg shadow-sm mb-6"},mt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4"},ct={class:"flex justify-center gap-4"},gt=["disabled"],vt={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},xt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},ht={key:0,class:"mt-4 flex items-center gap-2 text-sm text-gray-600"},bt={class:"flex justify-between items-center mb-4"},ft={class:"flex items-center gap-2"},kt={class:"text-sm text-gray-500"},wt={class:"flex gap-2 flex-wrap"},yt=["disabled"],Ct=["disabled"],_t=["disabled"],Dt=["disabled"],St=["disabled"],Vt=["disabled"],Ot={key:0,class:"bg-white rounded-lg shadow-sm p-8 text-center"},At={key:1,class:"bg-white rounded-lg shadow-sm p-8 text-center"},Mt={class:"text-gray-600 mb-4"},Rt={key:2,class:"bg-white rounded-lg shadow-sm overflow-hidden"},Et={class:"overflow-x-auto"},Pt={class:"w-full"},Ft={class:"bg-blue-600 text-white"},Tt={class:"px-4 py-3 text-left"},Bt={key:0},jt={class:"px-4 py-3"},Lt=["value"],Ut={class:"px-4 py-3 font-mono text-sm"},zt={class:"px-4 py-3 font-mono text-sm"},Ht={class:"px-4 py-3 text-sm"},Nt={class:"px-4 py-3"},It={class:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs"},$t={class:"px-4 py-3"},Wt={class:"text-sm"},Yt={class:"text-gray-500"},Gt={class:"px-4 py-3"},Zt={class:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded text-xs"},Kt={class:"mt-1"},qt={class:"px-4 py-3 text-sm"},Jt={class:"text-gray-500 truncate max-w-32"},Qt={class:"px-4 py-3 text-sm"},Xt={class:"px-4 py-3 font-mono text-sm"},es={class:"px-4 py-3"},ts={key:0,class:"text-xs text-green-600 font-semibold text-center"},ss=["src","alt"],os={key:1,class:"text-xs text-gray-500 italic text-center"},ls={class:"px-4 py-3"},ns={key:0,class:"text-xs text-blue-600 font-semibold text-center"},as=["src","alt"],rs={key:1,class:"text-xs text-gray-500 italic text-center"},is={class:"px-4 py-3"},ds={class:"flex flex-col gap-1"},us={key:0},ps={class:"text-xs text-gray-700"},ms={key:1,class:"text-xs text-gray-600 bg-green-100 px-1 py-0.5 rounded"},cs={class:"px-4 py-3"},gs={class:"flex gap-1 flex-wrap"},vs=["onClick"],xs=["onClick"],hs=["onClick"],bs=["onClick"],fs=["onClick"],ks=["onClick"],ws=["onClick"],ys=["onClick"],Cs=["onClick"],_s={class:"flex justify-between items-center px-6 py-4 bg-gray-50"},Ds={class:"flex items-center gap-4"},Ss={class:"text-sm text-gray-700"},Vs={class:"flex items-center gap-2"},Os=["value","disabled"],As=["value"],Ms={class:"flex items-center gap-2"},Rs=["disabled"],Es=["onClick","disabled"],Ps=["disabled"],Fs={class:"fixed bottom-4 right-4 z-50 space-y-2"},Ts={class:"flex justify-between items-center"},Bs={class:"text-sm"},js=["onClick"],io={__name:"Index",props:{order:Object},setup(Ls){const s=Je(),re=Ke(),_=Qe();et();const R=c(null),E=c(null),P=c(null);c(!1),c(!1);const F=c(""),ie=c(!1),f=c("");c("");const de=n=>{var e;console.log("Viewing recordings for order:",n),(e=E.value)==null||e.open(n.call_logs)},ue=n=>{var e;console.log("Adding expense for order:",n),(e=P.value)==null||e.open(n)},pe=(n,e)=>{console.log("Opening call dialog for phone number:",n),console.log("Order:",e),F.value=n||"",T.value=n,_.openDialog(n,e)},me=n=>{console.log("Call made:",n),f.value=null},ce=n=>{console.log("Call transferred:",n),f.value=null},ge=n=>{console.log("Agent called:",n),f.value=null};c({show:!1,type:"",title:""});const r=c([]),v=c(!1),T=c("");c(""),c(""),w({get:()=>s.bulkActionDialog,set:n=>{n?s.bulkActionDialog=n:s.closeBulkActionDialog()}}),w(()=>s.dialogType),w(()=>s.dialogTitle),w(()=>s.loading.orders),s.bulkActionForm;const ve=w(()=>{const n=s.pagination.current_page,e=s.pagination.last_page,u=[],o=Math.max(1,n-2),x=Math.min(e,o+4);for(let h=o;h<=x;h++)u.push(h);return u}),xe=n=>{s.openDialog(n)},he=async()=>{await s.fetchDropdownOptions(),s.openCreateDialog()},be=()=>{r.value.length!==0&&s.printOrders(r.value)},fe=()=>{if(console.debug("Assign Delivery Person clicked",{selectedOrders:r.value}),r.value.length===0){console.warn("No orders selected for delivery assignment");return}s.openAssignDeliveryDialog(r.value),console.info("Opened assign delivery dialog for orders:",r.value)},ke=()=>{V()},we=()=>{},ye=async()=>{await s.applyFilters()},B=async()=>{s.clearAllFilters(),await s.applyFilters()},Ce=async()=>{await s.applyFilters()},V=async()=>{await s.fetchOrders({page:s.pagination.current_page})},_e=()=>{v.value?r.value=s.orders.map(n=>n.id):r.value=[]},De=n=>{const e={year:"numeric",month:"short",day:"numeric"};return new Date(n).toLocaleDateString(void 0,e)},Se=n=>{const e={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(n).toLocaleString(void 0,e)},Ve=n=>{switch(n){case 1:return"Confirmed";case 0:return"Pending";case 2:return"Cancelled";default:return"Unknown"}},Oe=n=>{const e=s.vendorOptions.find(u=>u.id===n);return e?e.name:"Unknown"},D=n=>j(n,"CallAgent"),S=n=>j(n,"Delivery Agent"),j=(n,e)=>{if(!n.assignments||n.assignments.length===0)return null;const u=n.assignments.find(o=>o.role===e);return u?u.user:null},Ae=n=>{s.openViewDialog(n.id)},Me=n=>{s.deleteOrder(n.id)},Re=()=>{s.exportOrders(r.value)},Ee=()=>{s.openBulkStatusDialog(r.value),V()},Pe=()=>{s.openDeleteDialog(r.value)},Fe=()=>{r.value.length!==0&&s.openAssignCallCentreDialog(r.value)},Te=async()=>{if(s.pagination.current_page>1){const n=s.buildFilterParams?s.buildFilterParams():{};await s.fetchOrders({...n,page:s.pagination.current_page-1,per_page:s.pagination.per_page}),v.value=!1,r.value=[]}},Be=async()=>{if(s.pagination.current_page<s.pagination.last_page){const n=s.buildFilterParams?s.buildFilterParams():{};await s.fetchOrders({...n,page:s.pagination.current_page+1,per_page:s.pagination.per_page}),v.value=!1,r.value=[]}},je=async n=>{if(n!==s.pagination.current_page){const e=s.buildFilterParams?s.buildFilterParams():{};await s.fetchOrders({...e,page:n,per_page:s.pagination.per_page}),v.value=!1,r.value=[]}},Le=async n=>{await s.changePerPage(n),v.value=!1,r.value=[]},Ue=n=>{const e=n.customer;if(!(e!=null&&e.phone)){console.error("âŒ No phone number found in order:",n);return}const u={id:e.id,name:e.full_name||e.name||"Customer",phone:e.phone,whatsapp:e.whatsapp||e.phone,orderId:n.id,orderOid:n.order_no,orderData:n};re.openDialog(u),console.log("Opening WhatsApp dialog for contact:",u)},ze=n=>{var e;(e=R.value)==null||e.openDialog(n)};return He(r,n=>{const e=n.length===s.orders.length&&s.orders.length>0;v.value!==e&&(v.value=e)}),Ne(async()=>{await s.initialize(),await s.fetchOrders({page:1})}),(n,e)=>{const u=Ie("v-autocomplete");return i(),$e(Ze,null,{default:We(()=>[t("div",rt,[t("div",it,[t("div",dt,[t("div",ut,[O(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>l(s).orderSearch=o),type:"text",placeholder:"Search orders by (id, customer name, phone, address)",class:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:ye},null,544),[[Ye,l(s).orderSearch]]),e[17]||(e[17]=t("button",{class:"absolute right-2 top-2 p-1 text-gray-500 hover:text-gray-700"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),t("div",pt,[t("div",mt,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"SELLER",-1)),p(u,{modelValue:l(s).orderFilterVendor,"onUpdate:modelValue":e[1]||(e[1]=o=>l(s).orderFilterVendor=o),items:l(s).vendorOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search sellers...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"PRODUCT",-1)),p(u,{modelValue:l(s).orderFilterProduct,"onUpdate:modelValue":e[2]||(e[2]=o=>l(s).orderFilterProduct=o),items:l(s).productOptions,"item-title":"product_name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search products...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CATEGORY",-1)),p(u,{modelValue:l(s).orderFilterCategory,"onUpdate:modelValue":e[3]||(e[3]=o=>l(s).orderFilterCategory=o),items:l(s).categoryOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search categories...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CITY",-1)),p(u,{modelValue:l(s).orderFilterCity,"onUpdate:modelValue":e[4]||(e[4]=o=>l(s).orderFilterCity=o),items:l(s).cityOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search cities...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"ZONE",-1)),p(u,{modelValue:l(s).orderFilterZone,"onUpdate:modelValue":e[5]||(e[5]=o=>l(s).orderFilterZone=o),items:l(s).zoneOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search zones...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CALL AGENT",-1)),p(u,{modelValue:l(s).orderFilterAgent,"onUpdate:modelValue":e[6]||(e[6]=o=>l(s).orderFilterAgent=o),items:l(s).agentOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search agents...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"DELIVERY PERSON",-1)),p(u,{modelValue:l(s).orderFilterRider,"onUpdate:modelValue":e[7]||(e[7]=o=>l(s).orderFilterRider=o),items:l(s).riderOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search delivery persons...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CONFIRMATION STATUS",-1)),p(u,{modelValue:l(s).orderFilterStatus,"onUpdate:modelValue":e[8]||(e[8]=o=>l(s).orderFilterStatus=o),items:l(s).statusOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search statuses...",class:"w-full"},null,8,["modelValue","items"])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"DELIVERY DATE",-1)),p(M,{modelValue:l(s).deliveryDateRange,"onUpdate:modelValue":e[9]||(e[9]=o=>l(s).deliveryDateRange=o)},null,8,["modelValue"])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"STATUS DATE ",-1)),p(M,{modelValue:l(s).statusDateRange,"onUpdate:modelValue":e[10]||(e[10]=o=>l(s).statusDateRange=o)},null,8,["modelValue"])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CREATED RANGE",-1)),p(M,{modelValue:l(s).createdDateRange,"onUpdate:modelValue":e[11]||(e[11]=o=>l(s).createdDateRange=o)},null,8,["modelValue"])])]),t("div",ct,[t("button",{onClick:Ce,disabled:l(s).loading.orders,class:"px-8 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors flex items-center gap-2 disabled:opacity-50"},[l(s).loading.orders?(i(),d("span",vt)):b("",!0),e[30]||(e[30]=g(" Filter ")),l(s).loading.orders?b("",!0):(i(),d("svg",xt,e[29]||(e[29]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.121A1 1 0 013 6.414V4z"},null,-1)])))],8,gt),t("button",{onClick:B,class:"px-8 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors flex items-center gap-2"},e[31]||(e[31]=[g(" Reset "),t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))]),l(s).activeFilterCount>0?(i(),d("div",ht,[t("span",null,"Active filters: "+a(l(s).activeFilterCount),1),t("button",{onClick:B,class:"text-red-600 hover:text-red-800 underline"}," Clear all ")])):b("",!0)]),t("div",bt,[t("div",ft,[e[32]||(e[32]=t("h1",{class:"text-2xl font-semibold"},"Orders",-1)),t("span",kt,a(l(s).pagination.from)+" - "+a(l(s).pagination.to)+"/"+a(l(s).pagination.total),1)]),t("div",wt,[t("button",{onClick:Fe,disabled:r.value.length===0||l(s).loading.orders,class:"px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors flex items-center gap-2 text-sm"},e[33]||(e[33]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),g(" Associate agents ")]),8,yt),t("button",{onClick:he,class:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center gap-2 text-sm"},e[34]||(e[34]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),g(" New Order ")])),t("button",{onClick:be,disabled:r.value.length===0||l(s).loading.orders,class:"px-3 py-2 bg-gray-800 text-white rounded-md hover:bg-gray-900 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[35]||(e[35]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2h-2M7 17H5a2 2 0 01-2-2v-4a2 2 0 012-2h2m10 9v1a3 3 0 01-3 3H10a3 3 0 01-3-3v-1m10 0H7m10 0a5 5 0 00-10 0m10 0v-3a5 5 0 00-10 0v3"})],-1)),g(" Print ("+a(r.value.length)+") ",1)],8,Ct),t("button",{onClick:Re,disabled:l(s).loading.orders,class:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[36]||(e[36]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})],-1)),g(" Export Orders("+a(r.value.length)+") ",1)],8,_t),t("button",{onClick:Ee,disabled:r.value.length===0||l(s).loading.orders,class:"px-3 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[37]||(e[37]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),g(" Change Status ("+a(r.value.length)+") ",1)],8,Dt),t("button",{onClick:fe,disabled:r.value.length===0||l(s).loading.orders,class:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[38]||(e[38]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h1l1 2h13l1-2h1m-1 0V6a2 2 0 00-2-2H5a2 2 0 00-2 2v4m16 0v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6m16 0h-3.586a1 1 0 00-.707.293l-1.414 1.414a1 1 0 01-.707.293H8a1 1 0 01-1-1v-3a1 1 0 011-1h8a1 1 0 011 1v3z"})],-1)),g(" Assign Delivery ("+a(r.value.length)+") ",1)],8,St),t("button",{onClick:Pe,disabled:r.value.length===0||l(s).loading.orders,class:"px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[39]||(e[39]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),g(" Bulk Delete ("+a(r.value.length)+") ",1)],8,Vt)])]),l(s).loading.orders&&l(s).orders.length===0?(i(),d("div",Ot,e[40]||(e[40]=[t("div",{class:"animate-spin roundecreatedDateRanged-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),t("p",{class:"text-gray-600"},"Loading orders...",-1)]))):l(s).error&&l(s).orders.length===0?(i(),d("div",At,[e[41]||(e[41]=t("div",{class:"text-red-600 mb-4"},[t("svg",{class:"w-8 h-8 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t("p",Mt,a(l(s).error),1),t("button",{onClick:V,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Retry ")])):(i(),d("div",Rt,[t("div",Et,[t("table",Pt,[t("thead",Ft,[t("tr",null,[t("th",Tt,[O(t("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=o=>v.value=o),onChange:_e,class:"rounded","aria-label":"Select all orders"},null,544),[[ae,v.value]])]),e[42]||(e[42]=t("th",{class:"px-4 py-3 text-left font-medium"}," ORDER MERCHANT ID ",-1)),e[43]||(e[43]=t("th",{class:"px-4 py-3 text-left font-medium"}," ORDER NO ",-1)),e[44]||(e[44]=t("th",{class:"px-4 py-3 text-left font-medium"}," SELLER ",-1)),e[45]||(e[45]=t("th",{class:"px-4 py-3 text-left font-medium"}," Delivery Date ",-1)),e[46]||(e[46]=t("th",{class:"px-4 py-3 text-left font-medium"}," CUSTOMER ",-1)),e[47]||(e[47]=t("th",{class:"px-4 py-3 text-left font-medium"}," DETAILS ",-1)),e[48]||(e[48]=t("th",{class:"px-4 py-3 text-left font-medium"}," ADDRESS ",-1)),e[49]||(e[49]=t("th",{class:"px-4 py-3 text-left font-medium"}," DATE ",-1)),e[50]||(e[50]=t("th",{class:"px-4 py-3 text-left font-medium"}," TOTAL PRICE ",-1)),e[51]||(e[51]=t("th",{class:"px-4 py-3 text-left font-medium"}," DELIVERY PERSON ",-1)),e[52]||(e[52]=t("th",{class:"px-4 py-3 text-left font-medium"}," CUSTOMER CARE ",-1)),e[53]||(e[53]=t("th",{class:"px-4 py-3 text-left font-medium"}," STATUS ",-1)),e[54]||(e[54]=t("th",{class:"px-4 py-3 text-left font-medium"}," ACTIONS ",-1))])]),t("tbody",null,[l(s).orders.length===0?(i(),d("tr",Bt,e[55]||(e[55]=[t("td",{colspan:"12",class:"px-4 py-8 text-center text-gray-500"}," No orders found ",-1)]))):b("",!0),(i(!0),d(y,null,C(l(s).orders,o=>{var x,h,L,U,z,H,N,I,$,W,Y,G,Z,K,q,J,Q,X,ee,te,se,oe,le;return i(),d("tr",{key:o.id,class:A(["border-b hover:bg-gray-50",o.status===1?"bg-green-50":o.status===0?"bg-yellow-50":o.status===2?"bg-red-50":"bg-white"])},[t("td",jt,[O(t("input",{type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=m=>r.value=m),value:o.id,class:"rounded"},null,8,Lt),[[ae,r.value]])]),t("td",Ut,a(o.reference||"-"),1),t("td",zt,a(o.order_no||"-"),1),t("td",Ht,a(Oe(o.vendor_id)),1),t("td",Nt,[t("span",It,a(o.delivery_date||"Unknown"),1)]),t("td",$t,[t("div",Wt,[t("div",null,a(((x=o.shipping_address)==null?void 0:x.full_name)||((h=o.customer)==null?void 0:h.full_name)),1),t("div",Yt,a(((L=o.shipping_address)==null?void 0:L.phone)||((U=o.customer)==null?void 0:U.phone)),1)])]),t("td",Gt,[t("span",Zt,[e[56]||(e[56]=t("span",{class:"w-2 h-2 bg-red-500 rounded-full"},null,-1)),g(" "+a(((z=o.order_items)==null?void 0:z.length)||0)+" product"+a((((H=o.order_items)==null?void 0:H.length)||0)!==1?"s":""),1)]),t("div",Kt,[(i(!0),d(y,null,C(o.order_items,m=>{var k;return i(),d("div",{key:m.id,class:"text-[11px] text-gray-700"},a(((k=m.product)==null?void 0:k.product_name)||m.name||"Product")+" (x"+a(m.quantity)+") ",1)}),128))])]),t("td",qt,[t("div",null,a(((I=(N=o.shipping_address)==null?void 0:N.city)==null?void 0:I.name)||((W=($=o.customer)==null?void 0:$.city)==null?void 0:W.name)||((G=(Y=o.customer)==null?void 0:Y.zone)==null?void 0:G.name)||"-")+" "+a(((Z=o.shipping_address)==null?void 0:Z.address)||((K=o.customer)==null?void 0:K.address)||"-"),1),t("div",Jt,a(((q=o.shipping_address)==null?void 0:q.address)||((J=o.customer)==null?void 0:J.address)),1)]),t("td",Qt,[t("div",null,a(De(o.created_at)),1)]),t("td",Xt," KSH"+a(o.total_price||"0.00"),1),t("td",es,[S(o)?(i(),d("div",ts,[t("img",{src:S(o).profile_photo_url||"/default-avatar.png",alt:S(o).name,class:"w-6 h-6 rounded-full mx-auto mb-1"},null,8,ss),t("div",null,a(S(o).name),1)])):(i(),d("div",os," Not assigned "))]),t("td",ls,[D(o)?(i(),d("div",ns,[t("img",{src:D(o).profile_photo_url||"/default-avatar.png",alt:D(o).name,class:"w-6 h-6 rounded-full mx-auto mb-1"},null,8,as),t("div",null,a(D(o).name),1)])):(i(),d("div",rs," Not assigned "))]),t("td",is,[t("div",ds,[t("span",{class:"px-2 py-1 text-xs rounded",style:Ge((X=(Q=o.latest_status)==null?void 0:Q.status)!=null&&X.color?{backgroundColor:o.latest_status.status.color,color:"white"}:{})},a(((te=(ee=o.latest_status)==null?void 0:ee.status)==null?void 0:te.name)||Ve(o.status)),5),(se=o.latest_status)!=null&&se.status_notes?(i(),d("div",us,[e[57]||(e[57]=t("strong",{class:"text-xs"},"Note:",-1)),t("span",ps,a((oe=o.latest_status)==null?void 0:oe.status_notes),1)])):b("",!0),(le=o.latest_status)!=null&&le.created_at?(i(),d("div",ms," Status at "+a(Se(o.latest_status.created_at)),1)):b("",!0)])]),t("td",cs,[t("div",gs,[t("button",{onClick:m=>xe(o.id),class:"p-1 text-orange-600 hover:bg-orange-100 rounded",title:"Edit Order"},e[58]||(e[58]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,vs),t("button",{onClick:m=>Ae(o),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"View Order"},e[59]||(e[59]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,xs),t("button",{onClick:m=>de(o),class:"p-1 text-purple-600 hover:bg-purple-100 rounded",title:"View Call Recordings"},e[60]||(e[60]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 2a3 3 0 00-3 3v6a3 3 0 006 0V5a3 3 0 00-3-3z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 10v2a7 7 0 01-14 0v-2m7 9v3m-4 0h8"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 9a9 9 0 000 6M19 9a9 9 0 010 6"})],-1)]),8,hs),t("button",{onClick:m=>{var k,ne;return pe(((k=o.shipping_address)==null?void 0:k.phone)||((ne=o.customer)==null?void 0:ne.phone),o)},class:"p-1 text-indigo-600 hover:bg-indigo-100 rounded disabled:opacity-50",title:"Call Customer"},e[61]||(e[61]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 5a2 2 0 012-2h1.5a1 1 0 01.95.68l.7 2.1a1 1 0 01-.27 1L6.6 8.9a12 12 0 005 5l1.1-.58a1 1 0 011 .27l2.1.7A1 1 0 0119 16.5V18a2 2 0 01-2 2C9.163 20 4 14.837 4 6a2 2 0 00-.999-.999z"})],-1)]),8,bs),t("button",{onClick:m=>Ue(o),class:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Send WhatsApp Message"},e[62]||(e[62]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M20.52 3.48A11.36 11.36 0 0012.03.5C6.18.5 1.4 5.28 1.4 11.13c0 1.96.51 3.87 1.48 5.54L.5 23l6.43-2.06a11.6 11.6 0 005.1 1.17h.01c5.85 0 10.63-4.78 10.63-10.63 0-2.83-1.1-5.49-3.05-7.46zM12.03 20.9h-.01a9.42 9.42 0 01-4.8-1.3l-.34-.2-3.8 1.22 1.28-3.7-.22-.36a9.15 9.15 0 01-1.4-4.74c0-5.04 4.1-9.14 9.14-9.14 2.44 0 4.73.95 6.45 2.67a9.07 9.07 0 012.67 6.47c0 5.04-4.1 9.14-9.14 9.14zm5-6.41c-.27-.14-1.6-.79-1.85-.88-.25-.09-.43-.14-.61.14-.18.27-.7.88-.86 1.06-.16.18-.32.2-.59.07-.27-.14-1.13-.42-2.15-1.32-.8-.71-1.34-1.58-1.5-1.85-.16-.27-.02-.42.12-.56l.1-.1c.09-.09.27-.23.41-.35.14-.12.18-.2.27-.33.09-.14.05-.27.02-.38-.05-.11-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47-.16-.01-.34-.01-.52-.01a1 1 0 00-.73.31c-.25.25-.97.95-.97 2.31 0 1.36.99 2.68 1.13 2.87.14.18 1.94 2.97 4.74 4.05.66.23 1.18.37 1.58.48.66.17 1.26.15 1.73.09.53-.07 1.6-.65 1.83-1.28.23-.63.23-1.17.16-1.28-.07-.11-.25-.18-.52-.32z"})],-1)]),8,fs),t("button",{onClick:m=>n.sendSms(o),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Send SMS"},e[63]||(e[63]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)]),8,ks),t("button",{onClick:m=>ze(o),class:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Initiate M-Pesa STK Push"},e[64]||(e[64]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"7",y:"2",width:"10",height:"20",rx:"2"}),t("path",{d:"M11 18h2"})],-1)]),8,ws),t("button",{onClick:m=>ue(o),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Add Expense"},e[65]||(e[65]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]),8,ys),t("button",{onClick:m=>Me(o),class:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete Order"},e[66]||(e[66]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Cs)])])],2)}),128))])])]),t("div",_s,[t("div",Ds,[t("div",Ss," Showing "+a(l(s).pagination.from)+" to "+a(l(s).pagination.to)+" of "+a(l(s).pagination.total)+" results ",1),t("div",Vs,[e[67]||(e[67]=t("label",{class:"text-sm text-gray-600"},"Show:",-1)),t("select",{value:l(s).pagination.per_page,onChange:e[14]||(e[14]=o=>Le(o.target.value)),disabled:l(s).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"},[(i(!0),d(y,null,C(l(s).perPageOptions,o=>(i(),d("option",{key:o,value:o},a(o),9,As))),128))],40,Os),e[68]||(e[68]=t("span",{class:"text-sm text-gray-600"},"per page",-1))])]),t("div",Ms,[t("button",{onClick:Te,disabled:l(s).pagination.current_page===1||l(s).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm"}," Previous ",8,Rs),(i(!0),d(y,null,C(ve.value,o=>(i(),d("button",{key:o,onClick:x=>je(o),disabled:l(s).loading.orders,class:A(["px-3 py-1 border rounded-md text-sm",o===l(s).pagination.current_page?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-100 disabled:opacity-50"])},a(o),11,Es))),128)),t("button",{onClick:Be,disabled:l(s).pagination.current_page===l(s).pagination.last_page||l(s).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm"}," Next ",8,Ps)])])])),t("div",Fs,[(i(!0),d(y,null,C(l(s).notifications,o=>(i(),d("div",{key:o.id,class:A(["px-6 py-4 rounded-lg shadow-lg text-white max-w-sm",o.type==="success"?"bg-green-600":"bg-red-600"])},[t("div",Ts,[t("p",Bs,a(o.message),1),t("button",{onClick:x=>l(s).removeNotification(o.id),class:"ml-4 text-white hover:text-gray-200"},e[69]||(e[69]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 f6M6 6l12 12"})],-1)]),8,js)])],2))),128))])])]),p(lt,{ref_key:"orderExpensesDialog",ref:P},null,512),p(ot,{ref_key:"viewRecordingsDialog",ref:E},null,512),p(tt,{ref_key:"stkpushDialog",ref:R,onStkPushInitiated:n.handleStkPushInitiated},null,8,["onStkPushInitiated"]),p(Xe,{modelValue:l(_).dialogOpen,"onUpdate:modelValue":e[15]||(e[15]=o=>l(_).dialogOpen=o),order:l(_).activeOrder},null,8,["modelValue","order"]),p(qe),p(at,{modelValue:f.value,"onUpdate:modelValue":e[16]||(e[16]=o=>f.value=o),"call-data":{phone:F.value},"phone-number":T.value,onCallMade:me,onCallTransferred:ce,onAgentCalled:ge},null,8,["modelValue","call-data","phone-number"]),p(st,{"is-create":ie.value,onOrderSaved:ke,onDialogClosed:we},null,8,["is-create"]),p(nt)]),_:1})}}};export{io as default};
