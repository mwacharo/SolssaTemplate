import{r as g,s as ee,j as k,l as S,d as p,o as u,a as t,b as i,f,e as O,t as a,n as $,w as M,m as qe,k as We,c as Ye,A as Q,u as s,B as Ge,D as Ve,F as L,g as z,V as Ze}from"./app-B4Z00Z8p.js";import{_ as Ke}from"./AppLayout-Dg-UDRlZ.js";import{u as Je,W as Qe}from"./WhatsAppConversation-D8_-Xz_Q.js";import{u as Xe}from"./orderStore-9OuitIoF.js";import"./africastalking-01NWo76I.js";import{u as et,C as tt}from"./CallCentreDialler-DmTnleU9.js";import{u as lt,S as ot}from"./Stkpush-CKhqd-jr.js";import st from"./OrderForm-COUIDs5U.js";import nt from"./OrderCallHistory-CjjeiPiu.js";import at from"./OrderExpenses-CBpZO8IC.js";import rt from"./BulkAction-CPlnIh_D.js";import it from"./CallDialogs-DVKj4T6E.js";import{_ as dt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-9QRBMLXE.js";import"./IncomingCallDialog-CA4o6NJz.js";/* empty css                                                                           */import"./toast-BD3iSrVz.js";import"./whatsappStore-51IQiLkr.js";import"./auth-DSr0Vbkd.js";/* empty css                                                                             */import"./callCenter-CBkOZDUW.js";import"./contact-C4HdEwKG.js";const ut={key:0,class:"text-red-600 ml-1"},pt={__name:"DualDatePicker",props:{modelValue:{type:Array,default:()=>[]},label:String,required:{type:Boolean,default:!1},placeholder:{type:String,default:"Select date range"},validateOnMount:{type:Boolean,default:!1}},emits:["update:modelValue","validation"],setup(B,{expose:l,emit:I}){var r;const x=B,A=I,D=g(!1),w=g(x.validateOnMount),v=g((r=x.modelValue)!=null&&r.length?[...x.modelValue]:[]);ee(()=>x.modelValue,m=>{Array.isArray(m)?v.value=m.length?[...m]:[]:v.value=[]});const P=k(()=>x.required?Array.isArray(v.value)&&v.value.length===2:!0),_=k(()=>x.required&&w.value&&!P.value),q=k(()=>_.value?!v.value||v.value.length===0?"Date range is required":v.value.length===1?"Please select an end date":"":""),W=k(()=>x.required&&!P.value&&w.value?"text-red-600":"text-gray-700"),Y=k(()=>{if(!Array.isArray(v.value)||v.value.length===0)return"";const d=[...v.value].sort((b,C)=>{const T=b instanceof Date?b:new Date(b),j=C instanceof Date?C:new Date(C);return T-j}).map(b=>(b instanceof Date?b:new Date(b)).toLocaleDateString("en-US",{month:"short",day:"2-digit",default:"Select date range",year:"numeric"})),[y,R]=d;return y&&R?`${y} → ${R}`:y?`${y} → ...`:""}),G=m=>{w.value=!0;let d=[];Array.isArray(m)?d=m:m&&(d=[m]),x.required&&d.length===1&&(d=[d[0],d[0]]),v.value=d,A("update:modelValue",d);const y=x.required?d.length===2:!0;A("validation",y),d.length>=2&&setTimeout(()=>{D.value=!1},300)},Z=()=>{v.value=[],A("update:modelValue",[]),A("validation",!x.required)};return ee(D,m=>{!m&&!w.value&&(w.value=!0)}),l({validate:()=>(w.value=!0,P.value),isValid:P}),(m,d)=>{const y=S("v-text-field"),R=S("v-date-picker"),b=S("v-spacer"),C=S("v-btn"),T=S("v-card-actions"),j=S("v-card"),K=S("v-menu");return u(),p("div",null,[t("label",{class:$(["block text-sm font-medium mb-1",W.value])},[f(a(B.label)+" ",1),B.required?(u(),p("span",ut,"*")):O("",!0)],2),i(K,{modelValue:D.value,"onUpdate:modelValue":d[2]||(d[2]=V=>D.value=V),"close-on-content-click":!1,transition:"scale-transition",location:"bottom","max-width":"auto","min-width":"600px"},{activator:M(({props:V})=>[i(y,qe(V,{"model-value":Y.value,"prepend-inner-icon":"mdi-calendar",readonly:"",density:"compact",variant:"outlined",error:_.value,"error-messages":q.value,"hide-details":!_.value,placeholder:B.placeholder}),null,16,["model-value","error","error-messages","hide-details","placeholder"])]),default:M(()=>[i(j,null,{default:M(()=>[i(R,{modelValue:v.value,"onUpdate:modelValue":[d[0]||(d[0]=V=>v.value=V),G],multiple:2,"show-adjacent-months":"",color:"primary"},null,8,["modelValue"]),i(T,null,{default:M(()=>[i(b),i(C,{text:"",onClick:Z},{default:M(()=>d[3]||(d[3]=[f("Clear")])),_:1,__:[3]}),i(C,{text:"",color:"primary",onClick:d[1]||(d[1]=V=>D.value=!1)},{default:M(()=>d[4]||(d[4]=[f("Close")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},X=dt(pt,[["__scopeId","data-v-c4f5a182"]]),mt={class:"min-h-screen bg-gray-50"},ct={class:"p-6"},gt={class:"mb-6"},vt={class:"relative"},xt={class:"bg-white p-4 rounded-lg shadow-sm mb-6"},ht={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4"},ft={class:"flex justify-center gap-4"},bt=["disabled"],yt={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},kt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},wt={key:0,class:"mt-4 flex items-center gap-2 text-sm text-gray-600"},_t={class:"flex justify-between items-center mb-4"},Ct={class:"flex items-center gap-2"},Dt={class:"text-sm text-gray-500"},Vt={class:"flex gap-2 flex-wrap"},St=["disabled"],At=["disabled"],Ot=["disabled"],Mt=["disabled"],Pt=["disabled"],Rt=["disabled"],Et={key:0,class:"bg-white rounded-lg shadow-sm p-8 text-center"},Ft={key:1,class:"bg-white rounded-lg shadow-sm p-8 text-center"},Bt={class:"text-gray-600 mb-4"},Tt={key:2,class:"bg-white rounded-lg shadow-sm overflow-hidden"},jt={class:"overflow-x-auto"},Ut={class:"w-full"},Lt={class:"bg-blue-600 text-white"},zt={class:"px-4 py-3 text-left"},Ht={key:0},Nt={class:"px-4 py-3"},$t=["value"],It={class:"px-4 py-3 font-mono text-sm"},qt={class:"px-4 py-3 font-mono text-sm"},Wt={class:"px-4 py-3 text-sm"},Yt={class:"px-4 py-3"},Gt={class:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs"},Zt={class:"px-4 py-3"},Kt={class:"text-sm"},Jt={class:"text-gray-500"},Qt={class:"px-4 py-3"},Xt={class:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded text-xs"},el={class:"mt-1"},tl={class:"px-4 py-3 text-sm"},ll={class:"text-gray-500 truncate max-w-32"},ol={class:"px-4 py-3 text-sm"},sl={class:"px-4 py-3 font-mono text-sm"},nl={class:"px-4 py-3"},al={key:0,class:"text-xs text-green-600 font-semibold text-center"},rl=["src","alt"],il={key:1,class:"text-xs text-gray-500 italic text-center"},dl={class:"px-4 py-3"},ul={key:0,class:"text-xs text-blue-600 font-semibold text-center"},pl=["src","alt"],ml={key:1,class:"text-xs text-gray-500 italic text-center"},cl={class:"px-4 py-3"},gl={class:"flex flex-col gap-1"},vl={key:0},xl={class:"text-xs text-gray-700"},hl={key:1,class:"text-xs text-gray-600 bg-green-100 px-1 py-0.5 rounded"},fl={class:"px-4 py-3"},bl={class:"flex gap-1 flex-wrap"},yl=["onClick"],kl=["onClick"],wl=["onClick"],_l=["onClick"],Cl=["onClick"],Dl=["onClick"],Vl=["onClick"],Sl=["onClick"],Al=["onClick"],Ol={class:"flex justify-between items-center px-6 py-4 bg-gray-50"},Ml={class:"flex items-center gap-4"},Pl={class:"text-sm text-gray-700"},Rl={class:"flex items-center gap-2"},El=["value","disabled"],Fl=["value"],Bl={class:"flex items-center gap-2"},Tl=["disabled"],jl=["onClick","disabled"],Ul=["disabled"],Ll={class:"fixed bottom-4 right-4 z-50 space-y-2"},zl={class:"flex justify-between items-center"},Hl={class:"text-sm"},Nl=["onClick"],mo={__name:"Index",props:{order:Object},setup(B){const l=Xe(),I=Je(),x=et();lt();const A=g(null),D=g(null),w=g(null);g(!1),g(!1);const v=g(""),P=g(!1),_=g("");g("");const q=n=>{var e;console.log("Viewing recordings for order:",n),(e=D.value)==null||e.open(n.call_logs)},W=n=>{var e;console.log("Adding expense for order:",n),(e=w.value)==null||e.open(n)},Y=(n,e)=>{console.log("Opening call dialog for phone number:",n),console.log("Order:",e),v.value=n||"",d.value=n,x.openDialog(n,e)},G=n=>{console.log("Call made:",n),_.value=null},Z=n=>{console.log("Call transferred:",n),_.value=null},te=n=>{console.log("Agent called:",n),_.value=null};g({show:!1,type:"",title:""});const r=g([]),m=g(!1),d=g("");g(""),g(""),k({get:()=>l.bulkActionDialog,set:n=>{n?l.bulkActionDialog=n:l.closeBulkActionDialog()}}),k(()=>l.dialogType),k(()=>l.dialogTitle),k(()=>l.loading.orders),l.bulkActionForm;const y=k(()=>{const n=l.pagination.current_page,e=l.pagination.last_page,c=[],o=Math.max(1,n-2),E=Math.min(e,o+4);for(let F=o;F<=E;F++)c.push(F);return c}),R=n=>{l.openDialog(n)},b=async()=>{await l.fetchDropdownOptions(),l.openCreateDialog()},C=()=>{r.value.length!==0&&l.printOrders(r.value)},T=()=>{if(console.debug("Assign Delivery Person clicked",{selectedOrders:r.value}),r.value.length===0){console.warn("No orders selected for delivery assignment");return}l.openAssignDeliveryDialog(r.value),console.info("Opened assign delivery dialog for orders:",r.value)},j=()=>{J()},K=()=>{},V=async()=>{await l.applyFilters()},le=async()=>{l.clearAllFilters(),await l.applyFilters()},Se=async()=>{await l.applyFilters()},J=async()=>{await l.fetchOrders({page:l.pagination.current_page})},Ae=()=>{m.value?r.value=l.orders.map(n=>n.id):r.value=[]},Oe=n=>{const e={year:"numeric",month:"short",day:"numeric"};return new Date(n).toLocaleDateString(void 0,e)},Me=n=>{const e={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(n).toLocaleString(void 0,e)},Pe=n=>{switch(n){case 1:return"Confirmed";case 0:return"Pending";case 2:return"Cancelled";default:return"Unknown"}},Re=n=>{const e=l.vendorOptions.find(c=>c.id===n);return e?e.name:"Unknown"},H=n=>oe(n,"CallAgent"),N=n=>oe(n,"Delivery Agent"),oe=(n,e)=>{if(!n.assignments||n.assignments.length===0)return null;const c=n.assignments.find(o=>o.role===e);return c?c.user:null},Ee=n=>{l.openViewDialog(n.id)},Fe=n=>{l.deleteOrder(n.id)},Be=()=>{l.exportOrders(r.value)},Te=()=>{l.openBulkStatusDialog(r.value),J()},je=()=>{l.openDeleteDialog(r.value)},Ue=()=>{r.value.length!==0&&l.openAssignCallCentreDialog(r.value)},Le=async()=>{if(l.pagination.current_page>1){const n=l.buildFilterParams?l.buildFilterParams():{};await l.fetchOrders({...n,page:l.pagination.current_page-1,per_page:l.pagination.per_page}),m.value=!1,r.value=[]}},ze=async()=>{if(l.pagination.current_page<l.pagination.last_page){const n=l.buildFilterParams?l.buildFilterParams():{};await l.fetchOrders({...n,page:l.pagination.current_page+1,per_page:l.pagination.per_page}),m.value=!1,r.value=[]}},He=async n=>{if(n!==l.pagination.current_page){const e=l.buildFilterParams?l.buildFilterParams():{};await l.fetchOrders({...e,page:n,per_page:l.pagination.per_page}),m.value=!1,r.value=[]}},Ne=async n=>{await l.changePerPage(n),m.value=!1,r.value=[]},$e=n=>{const e=n.customer;if(!(e!=null&&e.phone)){console.error("❌ No phone number found in order:",n);return}const c={id:e.id,name:e.full_name||e.name||"Customer",phone:e.phone,whatsapp:e.whatsapp||e.phone,orderId:n.id,orderOid:n.order_no,orderData:n};I.openDialog(c),console.log("Opening WhatsApp dialog for contact:",c)},Ie=n=>{var e;(e=A.value)==null||e.openDialog(n)};return ee(r,n=>{const e=n.length===l.orders.length&&l.orders.length>0;m.value!==e&&(m.value=e)}),We(async()=>{await l.initialize(),await l.fetchOrders({page:1})}),(n,e)=>{const c=S("v-autocomplete");return u(),Ye(Ke,null,{default:M(()=>[t("div",mt,[t("div",ct,[t("div",gt,[t("div",vt,[Q(t("input",{"onUpdate:modelValue":e[0]||(e[0]=o=>s(l).orderSearch=o),type:"text",placeholder:"Search orders by (id, customer name, phone, address)",class:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:V},null,544),[[Ge,s(l).orderSearch]]),e[17]||(e[17]=t("button",{class:"absolute right-2 top-2 p-1 text-gray-500 hover:text-gray-700"},[t("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),t("div",xt,[t("div",ht,[t("div",null,[e[18]||(e[18]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"SELLER",-1)),i(c,{modelValue:s(l).orderFilterVendor,"onUpdate:modelValue":e[1]||(e[1]=o=>s(l).orderFilterVendor=o),items:s(l).vendorOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search sellers...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"PRODUCT",-1)),i(c,{modelValue:s(l).orderFilterProduct,"onUpdate:modelValue":e[2]||(e[2]=o=>s(l).orderFilterProduct=o),items:s(l).productOptions,"item-title":"product_name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search products...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CATEGORY",-1)),i(c,{modelValue:s(l).orderFilterCategory,"onUpdate:modelValue":e[3]||(e[3]=o=>s(l).orderFilterCategory=o),items:s(l).categoryOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search categories...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CITY",-1)),i(c,{modelValue:s(l).orderFilterCity,"onUpdate:modelValue":e[4]||(e[4]=o=>s(l).orderFilterCity=o),items:s(l).cityOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search cities...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"ZONE",-1)),i(c,{modelValue:s(l).orderFilterZone,"onUpdate:modelValue":e[5]||(e[5]=o=>s(l).orderFilterZone=o),items:s(l).zoneOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search zones...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CALL AGENT",-1)),i(c,{modelValue:s(l).orderFilterAgent,"onUpdate:modelValue":e[6]||(e[6]=o=>s(l).orderFilterAgent=o),items:s(l).agentOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search agents...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[24]||(e[24]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"DELIVERY PERSON",-1)),i(c,{modelValue:s(l).orderFilterRider,"onUpdate:modelValue":e[7]||(e[7]=o=>s(l).orderFilterRider=o),items:s(l).riderOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search delivery persons...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),t("div",null,[e[25]||(e[25]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CONFIRMATION STATUS",-1)),i(c,{modelValue:s(l).orderFilterStatus,"onUpdate:modelValue":e[8]||(e[8]=o=>s(l).orderFilterStatus=o),items:s(l).statusOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search statuses...",class:"w-full"},null,8,["modelValue","items"])]),t("div",null,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"DELIVERY DATE",-1)),i(X,{modelValue:s(l).deliveryDateRange,"onUpdate:modelValue":e[9]||(e[9]=o=>s(l).deliveryDateRange=o)},null,8,["modelValue"])]),t("div",null,[e[27]||(e[27]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"STATUS DATE ",-1)),i(X,{modelValue:s(l).statusDateRange,"onUpdate:modelValue":e[10]||(e[10]=o=>s(l).statusDateRange=o)},null,8,["modelValue"])]),t("div",null,[e[28]||(e[28]=t("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CREATED RANGE",-1)),i(X,{modelValue:s(l).createdDateRange,"onUpdate:modelValue":e[11]||(e[11]=o=>s(l).createdDateRange=o)},null,8,["modelValue"])])]),t("div",ft,[t("button",{onClick:Se,disabled:s(l).loading.orders,class:"px-8 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors flex items-center gap-2 disabled:opacity-50"},[s(l).loading.orders?(u(),p("span",yt)):O("",!0),e[30]||(e[30]=f(" Filter ")),s(l).loading.orders?O("",!0):(u(),p("svg",kt,e[29]||(e[29]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.121A1 1 0 013 6.414V4z"},null,-1)])))],8,bt),t("button",{onClick:le,class:"px-8 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors flex items-center gap-2"},e[31]||(e[31]=[f(" Reset "),t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))]),s(l).activeFilterCount>0?(u(),p("div",wt,[t("span",null,"Active filters: "+a(s(l).activeFilterCount),1),t("button",{onClick:le,class:"text-red-600 hover:text-red-800 underline"}," Clear all ")])):O("",!0)]),t("div",_t,[t("div",Ct,[e[32]||(e[32]=t("h1",{class:"text-2xl font-semibold"},"Orders",-1)),t("span",Dt,a(s(l).pagination.from)+" - "+a(s(l).pagination.to)+"/"+a(s(l).pagination.total),1)]),t("div",Vt,[t("button",{onClick:Ue,disabled:r.value.length===0||s(l).loading.orders,class:"px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors flex items-center gap-2 text-sm"},e[33]||(e[33]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),f(" Associate agents ")]),8,St),t("button",{onClick:b,class:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center gap-2 text-sm"},e[34]||(e[34]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),f(" New Order ")])),t("button",{onClick:C,disabled:r.value.length===0||s(l).loading.orders,class:"px-3 py-2 bg-gray-800 text-white rounded-md hover:bg-gray-900 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[35]||(e[35]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2h-2M7 17H5a2 2 0 01-2-2v-4a2 2 0 012-2h2m10 9v1a3 3 0 01-3 3H10a3 3 0 01-3-3v-1m10 0H7m10 0a5 5 0 00-10 0m10 0v-3a5 5 0 00-10 0v3"})],-1)),f(" Print ("+a(r.value.length)+") ",1)],8,At),t("button",{onClick:Be,disabled:s(l).loading.orders,class:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[36]||(e[36]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})],-1)),f(" Export Orders("+a(r.value.length)+") ",1)],8,Ot),t("button",{onClick:Te,disabled:r.value.length===0||s(l).loading.orders,class:"px-3 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[37]||(e[37]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),f(" Change Status ("+a(r.value.length)+") ",1)],8,Mt),t("button",{onClick:T,disabled:r.value.length===0||s(l).loading.orders,class:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[38]||(e[38]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h1l1 2h13l1-2h1m-1 0V6a2 2 0 00-2-2H5a2 2 0 00-2 2v4m16 0v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6m16 0h-3.586a1 1 0 00-.707.293l-1.414 1.414a1 1 0 01-.707.293H8a1 1 0 01-1-1v-3a1 1 0 011-1h8a1 1 0 011 1v3z"})],-1)),f(" Assign Delivery ("+a(r.value.length)+") ",1)],8,Pt),t("button",{onClick:je,disabled:r.value.length===0||s(l).loading.orders,class:"px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[e[39]||(e[39]=t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),f(" Bulk Delete ("+a(r.value.length)+") ",1)],8,Rt)])]),s(l).loading.orders&&s(l).orders.length===0?(u(),p("div",Et,e[40]||(e[40]=[t("div",{class:"animate-spin roundecreatedDateRanged-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),t("p",{class:"text-gray-600"},"Loading orders...",-1)]))):s(l).error&&s(l).orders.length===0?(u(),p("div",Ft,[e[41]||(e[41]=t("div",{class:"text-red-600 mb-4"},[t("svg",{class:"w-8 h-8 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),t("p",Bt,a(s(l).error),1),t("button",{onClick:J,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Retry ")])):(u(),p("div",Tt,[t("div",jt,[t("table",Ut,[t("thead",Lt,[t("tr",null,[t("th",zt,[Q(t("input",{type:"checkbox","onUpdate:modelValue":e[12]||(e[12]=o=>m.value=o),onChange:Ae,class:"rounded","aria-label":"Select all orders"},null,544),[[Ve,m.value]])]),e[42]||(e[42]=t("th",{class:"px-4 py-3 text-left font-medium"}," ORDER MERCHANT ID ",-1)),e[43]||(e[43]=t("th",{class:"px-4 py-3 text-left font-medium"}," ORDER NO ",-1)),e[44]||(e[44]=t("th",{class:"px-4 py-3 text-left font-medium"}," SELLER ",-1)),e[45]||(e[45]=t("th",{class:"px-4 py-3 text-left font-medium"}," Delivery Date ",-1)),e[46]||(e[46]=t("th",{class:"px-4 py-3 text-left font-medium"}," CUSTOMER ",-1)),e[47]||(e[47]=t("th",{class:"px-4 py-3 text-left font-medium"}," DETAILS ",-1)),e[48]||(e[48]=t("th",{class:"px-4 py-3 text-left font-medium"}," ADDRESS ",-1)),e[49]||(e[49]=t("th",{class:"px-4 py-3 text-left font-medium"}," DATE ",-1)),e[50]||(e[50]=t("th",{class:"px-4 py-3 text-left font-medium"}," TOTAL PRICE ",-1)),e[51]||(e[51]=t("th",{class:"px-4 py-3 text-left font-medium"}," DELIVERY PERSON ",-1)),e[52]||(e[52]=t("th",{class:"px-4 py-3 text-left font-medium"}," CUSTOMER CARE ",-1)),e[53]||(e[53]=t("th",{class:"px-4 py-3 text-left font-medium"}," STATUS ",-1)),e[54]||(e[54]=t("th",{class:"px-4 py-3 text-left font-medium"}," ACTIONS ",-1))])]),t("tbody",null,[s(l).orders.length===0?(u(),p("tr",Ht,e[55]||(e[55]=[t("td",{colspan:"12",class:"px-4 py-8 text-center text-gray-500"}," No orders found ",-1)]))):O("",!0),(u(!0),p(L,null,z(s(l).orders,o=>{var E,F,se,ne,ae,re,ie,de,ue,pe,me,ce,ge,ve,xe,he,fe,be,ye,ke,we,_e,Ce;return u(),p("tr",{key:o.id,class:$(["border-b hover:bg-gray-50",o.status===1?"bg-green-50":o.status===0?"bg-yellow-50":o.status===2?"bg-red-50":"bg-white"])},[t("td",Nt,[Q(t("input",{type:"checkbox","onUpdate:modelValue":e[13]||(e[13]=h=>r.value=h),value:o.id,class:"rounded"},null,8,$t),[[Ve,r.value]])]),t("td",It,a(o.reference||"-"),1),t("td",qt,a(o.order_no||"-"),1),t("td",Wt,a(Re(o.vendor_id)),1),t("td",Yt,[t("span",Gt,a(o.delivery_date||"Unknown"),1)]),t("td",Zt,[t("div",Kt,[t("div",null,a(((E=o.shipping_address)==null?void 0:E.full_name)||((F=o.customer)==null?void 0:F.full_name)),1),t("div",Jt,a(((se=o.shipping_address)==null?void 0:se.phone)||((ne=o.customer)==null?void 0:ne.phone)),1)])]),t("td",Qt,[t("span",Xt,[e[56]||(e[56]=t("span",{class:"w-2 h-2 bg-red-500 rounded-full"},null,-1)),f(" "+a(((ae=o.order_items)==null?void 0:ae.length)||0)+" product"+a((((re=o.order_items)==null?void 0:re.length)||0)!==1?"s":""),1)]),t("div",el,[(u(!0),p(L,null,z(o.order_items,h=>{var U;return u(),p("div",{key:h.id,class:"text-[11px] text-gray-700"},a(((U=h.product)==null?void 0:U.product_name)||h.name||"Product")+" (x"+a(h.quantity)+") ",1)}),128))])]),t("td",tl,[t("div",null,a(((de=(ie=o.shipping_address)==null?void 0:ie.city)==null?void 0:de.name)||((pe=(ue=o.customer)==null?void 0:ue.city)==null?void 0:pe.name)||((ce=(me=o.customer)==null?void 0:me.zone)==null?void 0:ce.name)||"-")+" "+a(((ge=o.shipping_address)==null?void 0:ge.address)||((ve=o.customer)==null?void 0:ve.address)||"-"),1),t("div",ll,a(((xe=o.shipping_address)==null?void 0:xe.address)||((he=o.customer)==null?void 0:he.address)),1)]),t("td",ol,[t("div",null,a(Oe(o.created_at)),1)]),t("td",sl," KSH"+a(o.total_price||"0.00"),1),t("td",nl,[N(o)?(u(),p("div",al,[t("img",{src:N(o).profile_photo_url||"/default-avatar.png",alt:N(o).name,class:"w-6 h-6 rounded-full mx-auto mb-1"},null,8,rl),t("div",null,a(N(o).name),1)])):(u(),p("div",il," Not assigned "))]),t("td",dl,[H(o)?(u(),p("div",ul,[t("img",{src:H(o).profile_photo_url||"/default-avatar.png",alt:H(o).name,class:"w-6 h-6 rounded-full mx-auto mb-1"},null,8,pl),t("div",null,a(H(o).name),1)])):(u(),p("div",ml," Not assigned "))]),t("td",cl,[t("div",gl,[t("span",{class:"px-2 py-1 text-xs rounded",style:Ze((be=(fe=o.latest_status)==null?void 0:fe.status)!=null&&be.color?{backgroundColor:o.latest_status.status.color,color:"white"}:{})},a(((ke=(ye=o.latest_status)==null?void 0:ye.status)==null?void 0:ke.name)||Pe(o.status)),5),(we=o.latest_status)!=null&&we.status_notes?(u(),p("div",vl,[e[57]||(e[57]=t("strong",{class:"text-xs"},"Note:",-1)),t("span",xl,a((_e=o.latest_status)==null?void 0:_e.status_notes),1)])):O("",!0),(Ce=o.latest_status)!=null&&Ce.created_at?(u(),p("div",hl," Status at "+a(Me(o.latest_status.created_at)),1)):O("",!0)])]),t("td",fl,[t("div",bl,[t("button",{onClick:h=>R(o.id),class:"p-1 text-orange-600 hover:bg-orange-100 rounded",title:"Edit Order"},e[58]||(e[58]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,yl),t("button",{onClick:h=>Ee(o),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"View Order"},e[59]||(e[59]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,kl),t("button",{onClick:h=>q(o),class:"p-1 text-purple-600 hover:bg-purple-100 rounded",title:"View Call Recordings"},e[60]||(e[60]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 2a3 3 0 00-3 3v6a3 3 0 006 0V5a3 3 0 00-3-3z"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 10v2a7 7 0 01-14 0v-2m7 9v3m-4 0h8"}),t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 9a9 9 0 000 6M19 9a9 9 0 010 6"})],-1)]),8,wl),t("button",{onClick:h=>{var U,De;return Y(((U=o.shipping_address)==null?void 0:U.phone)||((De=o.customer)==null?void 0:De.phone),o)},class:"p-1 text-indigo-600 hover:bg-indigo-100 rounded disabled:opacity-50",title:"Call Customer"},e[61]||(e[61]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 5a2 2 0 012-2h1.5a1 1 0 01.95.68l.7 2.1a1 1 0 01-.27 1L6.6 8.9a12 12 0 005 5l1.1-.58a1 1 0 011 .27l2.1.7A1 1 0 0119 16.5V18a2 2 0 01-2 2C9.163 20 4 14.837 4 6a2 2 0 00-.999-.999z"})],-1)]),8,_l),t("button",{onClick:h=>$e(o),class:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Send WhatsApp Message"},e[62]||(e[62]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[t("path",{d:"M20.52 3.48A11.36 11.36 0 0012.03.5C6.18.5 1.4 5.28 1.4 11.13c0 1.96.51 3.87 1.48 5.54L.5 23l6.43-2.06a11.6 11.6 0 005.1 1.17h.01c5.85 0 10.63-4.78 10.63-10.63 0-2.83-1.1-5.49-3.05-7.46zM12.03 20.9h-.01a9.42 9.42 0 01-4.8-1.3l-.34-.2-3.8 1.22 1.28-3.7-.22-.36a9.15 9.15 0 01-1.4-4.74c0-5.04 4.1-9.14 9.14-9.14 2.44 0 4.73.95 6.45 2.67a9.07 9.07 0 012.67 6.47c0 5.04-4.1 9.14-9.14 9.14zm5-6.41c-.27-.14-1.6-.79-1.85-.88-.25-.09-.43-.14-.61.14-.18.27-.7.88-.86 1.06-.16.18-.32.2-.59.07-.27-.14-1.13-.42-2.15-1.32-.8-.71-1.34-1.58-1.5-1.85-.16-.27-.02-.42.12-.56l.1-.1c.09-.09.27-.23.41-.35.14-.12.18-.2.27-.33.09-.14.05-.27.02-.38-.05-.11-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47-.16-.01-.34-.01-.52-.01a1 1 0 00-.73.31c-.25.25-.97.95-.97 2.31 0 1.36.99 2.68 1.13 2.87.14.18 1.94 2.97 4.74 4.05.66.23 1.18.37 1.58.48.66.17 1.26.15 1.73.09.53-.07 1.6-.65 1.83-1.28.23-.63.23-1.17.16-1.28-.07-.11-.25-.18-.52-.32z"})],-1)]),8,Cl),t("button",{onClick:h=>n.sendSms(o),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Send SMS"},e[63]||(e[63]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)]),8,Dl),t("button",{onClick:h=>Ie(o),class:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Initiate M-Pesa STK Push"},e[64]||(e[64]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("rect",{x:"7",y:"2",width:"10",height:"20",rx:"2"}),t("path",{d:"M11 18h2"})],-1)]),8,Vl),t("button",{onClick:h=>W(o),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Add Expense"},e[65]||(e[65]=[t("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1)]),8,Sl),t("button",{onClick:h=>Fe(o),class:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete Order"},e[66]||(e[66]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,Al)])])],2)}),128))])])]),t("div",Ol,[t("div",Ml,[t("div",Pl," Showing "+a(s(l).pagination.from)+" to "+a(s(l).pagination.to)+" of "+a(s(l).pagination.total)+" results ",1),t("div",Rl,[e[67]||(e[67]=t("label",{class:"text-sm text-gray-600"},"Show:",-1)),t("select",{value:s(l).pagination.per_page,onChange:e[14]||(e[14]=o=>Ne(o.target.value)),disabled:s(l).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"},[(u(!0),p(L,null,z(s(l).perPageOptions,o=>(u(),p("option",{key:o,value:o},a(o),9,Fl))),128))],40,El),e[68]||(e[68]=t("span",{class:"text-sm text-gray-600"},"per page",-1))])]),t("div",Bl,[t("button",{onClick:Le,disabled:s(l).pagination.current_page===1||s(l).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm"}," Previous ",8,Tl),(u(!0),p(L,null,z(y.value,o=>(u(),p("button",{key:o,onClick:E=>He(o),disabled:s(l).loading.orders,class:$(["px-3 py-1 border rounded-md text-sm",o===s(l).pagination.current_page?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-100 disabled:opacity-50"])},a(o),11,jl))),128)),t("button",{onClick:ze,disabled:s(l).pagination.current_page===s(l).pagination.last_page||s(l).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm"}," Next ",8,Ul)])])])),t("div",Ll,[(u(!0),p(L,null,z(s(l).notifications,o=>(u(),p("div",{key:o.id,class:$(["px-6 py-4 rounded-lg shadow-lg text-white max-w-sm",o.type==="success"?"bg-green-600":"bg-red-600"])},[t("div",zl,[t("p",Hl,a(o.message),1),t("button",{onClick:E=>s(l).removeNotification(o.id),class:"ml-4 text-white hover:text-gray-200"},e[69]||(e[69]=[t("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 f6M6 6l12 12"})],-1)]),8,Nl)])],2))),128))])])]),i(at,{ref_key:"orderExpensesDialog",ref:w},null,512),i(nt,{ref_key:"viewRecordingsDialog",ref:D},null,512),i(ot,{ref_key:"stkpushDialog",ref:A,onStkPushInitiated:n.handleStkPushInitiated},null,8,["onStkPushInitiated"]),i(tt,{modelValue:s(x).dialogOpen,"onUpdate:modelValue":e[15]||(e[15]=o=>s(x).dialogOpen=o),order:s(x).activeOrder},null,8,["modelValue","order"]),i(Qe),i(it,{modelValue:_.value,"onUpdate:modelValue":e[16]||(e[16]=o=>_.value=o),"call-data":{phone:v.value},"phone-number":d.value,onCallMade:G,onCallTransferred:Z,onAgentCalled:te},null,8,["modelValue","call-data","phone-number"]),i(st,{"is-create":P.value,onOrderSaved:j,onDialogClosed:K},null,8,["is-create"]),i(rt)]),_:1})}}};export{mo as default};
