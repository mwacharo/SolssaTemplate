import{E as N,i as b,r as m,k as $,c as T,o as l,w as C,a as e,d,e as v,u as w,F as V,g as z,t as f,n as L,y as S,A as _,B as E,D as U}from"./app-BgN-NH3l.js";import{n as g}from"./toast-9uxjh2Uk.js";import{_ as I}from"./AppLayout-BDylVQAm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-Cw8ZtQEb.js";import"./africastalking-CkgtxRYw.js";import"./IncomingCallDialog-CyiVs-h9.js";/* empty css                                                                           */const K=N("expenseCategory",{state:()=>({categories:[],loading:!1,error:null}),getters:{getCategoryById:o=>s=>o.categories.find(a=>a.id===s),deductibleCategories:o=>o.categories.filter(s=>s.is_deductible),hasCategories:o=>o.categories.length>0},actions:{async fetchCategories(){this.loading=!0,this.error=null;try{const o=await b.get("/api/v1/expense-categories");this.categories=o.data.data||o.data}catch(o){this.error=o.message,g.error("Failed to fetch expense categories"),console.error("Error fetching categories:",o)}finally{this.loading=!1}},async createCategory(o){this.loading=!0,this.error=null;try{const s=await b.post("/api/v1/expense-categories",o);return this.categories.push(s.data.data||s.data),g.success("Category created successfully"),s.data}catch(s){throw this.error=s.message,g.error("Failed to create category"),console.error("Error creating category:",s),s}finally{this.loading=!1}},async updateCategory(o,s){this.loading=!0,this.error=null;try{const a=await b.put(`/api/v1/expense-categories/${o}`,s),c=this.categories.findIndex(u=>u.id===o);return c!==-1&&(this.categories[c]=a.data.data||a.data),g.success("Category updated successfully"),a.data}catch(a){throw this.error=a.message,g.error("Failed to update category"),console.error("Error updating category:",a),a}finally{this.loading=!1}},async deleteCategory(o){this.loading=!0,this.error=null;try{await b.delete(`/api/v1/expense-categories/${o}`),this.categories=this.categories.filter(s=>s.id!==o),g.success("Category deleted successfully")}catch(s){throw this.error=s.message,g.error("Failed to delete category"),console.error("Error deleting category:",s),s}finally{this.loading=!1}},resetError(){this.error=null}}}),R={class:"py-12"},q={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},P={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},Y={key:0,class:"p-6 text-center"},G={key:1,class:"overflow-x-auto"},H={class:"min-w-full divide-y divide-gray-200"},J={class:"bg-white divide-y divide-gray-200"},O={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Q={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},W={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},X={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},Z=["onClick"],ee=["onClick"],te={key:0},se={key:0,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},oe={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ie={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},ae={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},re={class:"text-lg leading-6 font-medium text-gray-900 mb-4",id:"modal-title"},le={class:"space-y-4"},ne={class:"flex items-center"},de={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ce=["disabled"],ue={key:0},me={key:1},ge=["disabled"],fe={key:1,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},pe={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},xe={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},ye={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},be={class:"sm:flex sm:items-start"},he={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},ve={class:"mt-2"},we={class:"text-sm text-gray-500"},_e={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},ke=["disabled"],Ce={key:0},Ee={key:1},De=["disabled"],Ve={__name:"ExpenseCategories",setup(o){const s=K(),a=m(!1),c=m(!1),u=m(!1),p=m(!1),x=m(!1),y=m(null),r=m({id:null,name:"",kra_code:"",is_deductible:!1});$(()=>{s.fetchCategories()});const D=()=>{u.value=!1,r.value={id:null,name:"",kra_code:"",is_deductible:!1},a.value=!0},M=n=>{u.value=!0,r.value={id:n.id,name:n.name,kra_code:n.kra_code,is_deductible:n.is_deductible},a.value=!0},h=()=>{a.value=!1,r.value={id:null,name:"",kra_code:"",is_deductible:!1}},j=async()=>{p.value=!0;try{u.value?await s.updateCategory(r.value.id,r.value):await s.createCategory(r.value),h()}catch(n){console.error("Form submission error:",n)}finally{p.value=!1}},A=n=>{y.value=n,c.value=!0},F=async()=>{x.value=!0;try{await s.deleteCategory(y.value.id),c.value=!1,y.value=null}catch(n){console.error("Delete error:",n)}finally{x.value=!1}};return(n,t)=>(l(),T(I,{title:"Expense Categories"},{header:C(()=>t[5]||(t[5]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Expense Categories ",-1)])),default:C(()=>{var k;return[e("div",R,[e("div",q,[e("div",P,[e("div",{class:"p-6 sm:px-8 bg-white border-b border-gray-200"},[e("div",{class:"flex justify-between items-center"},[t[6]||(t[6]=e("h3",{class:"text-lg font-medium text-gray-900"}," Manage Expense Categories ",-1)),e("button",{onClick:D,class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 focus:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150"}," Add Category ")])]),w(s).loading?(l(),d("div",Y,t[7]||(t[7]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500"}," Loading categories... ",-1)]))):(l(),d("div",G,[e("table",H,[t[9]||(t[9]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Name "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," KRA Code "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Tax Deductible "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",J,[(l(!0),d(V,null,z(w(s).categories,i=>(l(),d("tr",{key:i.id},[e("td",O,f(i.name),1),e("td",Q,f(i.kra_code||"N/A"),1),e("td",W,[e("span",{class:L([i.is_deductible?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800","px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},f(i.is_deductible?"Yes":"No"),3)]),e("td",X,[e("button",{onClick:B=>M(i),class:"text-indigo-600 hover:text-indigo-900 mr-4"}," Edit ",8,Z),e("button",{onClick:B=>A(i),class:"text-red-600 hover:text-red-900"}," Delete ",8,ee)])]))),128)),w(s).hasCategories?v("",!0):(l(),d("tr",te,t[8]||(t[8]=[e("td",{colspan:"4",class:"px-6 py-4 text-center text-sm text-gray-500"},' No expense categories found. Click "Add Category" to create one. ',-1)])))])])]))])])]),a.value?(l(),d("div",se,[e("div",oe,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:h}),t[13]||(t[13]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",ie,[e("form",{onSubmit:S(j,["prevent"])},[e("div",ae,[e("h3",re,f(u.value?"Edit":"Create")+" Expense Category ",1),e("div",le,[e("div",null,[t[10]||(t[10]=e("label",{for:"name",class:"block text-sm font-medium text-gray-700"},"Name *",-1)),_(e("input",{type:"text",id:"name","onUpdate:modelValue":t[0]||(t[0]=i=>r.value.name=i),required:"",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[E,r.value.name]])]),e("div",null,[t[11]||(t[11]=e("label",{for:"kra_code",class:"block text-sm font-medium text-gray-700"},"KRA Code",-1)),_(e("input",{type:"text",id:"kra_code","onUpdate:modelValue":t[1]||(t[1]=i=>r.value.kra_code=i),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},null,512),[[E,r.value.kra_code]])]),e("div",ne,[_(e("input",{type:"checkbox",id:"is_deductible","onUpdate:modelValue":t[2]||(t[2]=i=>r.value.is_deductible=i),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[U,r.value.is_deductible]]),t[12]||(t[12]=e("label",{for:"is_deductible",class:"ml-2 block text-sm text-gray-900"}," Tax Deductible ",-1))])])]),e("div",de,[e("button",{type:"submit",disabled:p.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[p.value?(l(),d("span",me,"Processing...")):(l(),d("span",ue,f(u.value?"Update":"Create"),1))],8,ce),e("button",{type:"button",onClick:h,disabled:p.value,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,ge)])],32)])])])):v("",!0),c.value?(l(),d("div",fe,[e("div",pe,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[3]||(t[3]=i=>c.value=!1)}),t[16]||(t[16]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",xe,[e("div",ye,[e("div",be,[t[15]||(t[15]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",he,[t[14]||(t[14]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Delete Expense Category ",-1)),e("div",ve,[e("p",we,' Are you sure you want to delete "'+f((k=y.value)==null?void 0:k.name)+'"? This action cannot be undone. ',1)])])])]),e("div",_e,[e("button",{type:"button",onClick:F,disabled:x.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[x.value?(l(),d("span",Ee,"Deleting...")):(l(),d("span",Ce,"Delete"))],8,ke),e("button",{type:"button",onClick:t[4]||(t[4]=i=>c.value=!1),disabled:x.value,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,De)])])])])):v("",!0)]}),_:1}))}};export{Ve as default};
