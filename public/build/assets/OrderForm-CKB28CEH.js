import{r as U,Q as ne,j as k,l as d,c as E,o as V,w as a,b as l,a as v,u as b,f as s,t as _,y as ie,d as w,e as q,F as ue,g as me,R as pe}from"./app-oghUaOhr.js";import{u as ve}from"./orderStore-0M6ZFvWg.js";import{_ as _e}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ce={class:"text-h6"},fe={class:"mb-6"},be={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},Ve={class:"mb-6"},ye={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},ge={class:"mb-6"},ke={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},xe={key:0},Ue={key:1},we={key:0,class:"mb-4"},Ce={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},Oe={class:"text-subtitle-2 font-weight-medium"},ze={key:1,class:"mb-4"},qe={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},Ae={__name:"OrderForm",emits:["order-saved","dialog-closed"],setup(Pe,{emit:G}){const B=G,m=ve(),Z=U(null),A=U(!1),{dialog:P,isCreateMode:c}=ne(m),C=U(!1),x=U("customer"),r={required:i=>!!i||"This field is required",phone:i=>i?/^[\d\s\-\+\(\)]+$/.test(i)||"Invalid phone number format":!0},H=[{title:"API",value:"api"},{title:"Web",value:"web"},{title:"Mobile App",value:"mobile"},{title:"WhatsApp",value:"whatsapp"},{title:"Facebook",value:"facebook"},{title:"Instagram",value:"instagram"}],J=[{title:"Vendor API",value:"vendor_api"},{title:"Customer Web",value:"customer_web"},{title:"Customer Mobile",value:"customer_mobile"},{title:"Agent",value:"agent"},{title:"Call Center",value:"call_center"}],K=[{title:"Pending",value:0},{title:"Confirmed",value:1},{title:"Cancelled",value:2}],X=k(()=>m.vendorOptions),Y=k(()=>m.categoryOptions),F=k(()=>m.cityOptions),N=k(()=>m.zoneOptions);k(()=>m.warehouseOptions);const y=k(()=>m.selectedOrder),t=U({reference:"",platform:"api",source:"vendor_api",vendor_id:null,category_id:null,delivery_date:"",status:0,customer_address:{full_name:"",phone:"",city:"",zone_id:null,address:""},pickup_address:{full_name:"",phone:"",email:"",city:"",zone_id:null,region:"",zipcode:"",address:""},dropoff_address:{full_name:"",phone:"",email:"",city:"",zone_id:null,region:"",zipcode:"",address:""}}),h=i=>{i&&m.fetchDropdownOptions(i)},ee=i=>{i==="customer"?(t.value.from_warehouse_id=null,t.value.to_warehouse_id=null,t.value.from_address={city:""},t.value.to_address={city:""}):t.value.customer_address={full_name:"",phone:"",city:"",zone_id:null,address:""}},D=()=>{m.closeDialog(),B("dialog-closed")},M=async()=>{var i;if((i=Z.value)!=null&&i.validate()){C.value=!0;try{let e={...t.value};x.value==="customer"?(delete e.from_warehouse_id,delete e.to_warehouse_id,delete e.from_address,delete e.to_address,e.shipping_address=e.customer_address,delete e.customer_address):(delete e.customer_address,delete e.shipping_address),c.value?await m.createOrder(e):await m.updateOrder(y.value.id,e),B("order-saved"),D()}catch(e){console.error("Error saving order:",e)}finally{C.value=!1}}};return(i,e)=>{const f=d("v-icon"),T=d("v-spacer"),R=d("v-btn"),S=d("v-card-title"),W=d("v-divider"),n=d("v-text-field"),u=d("v-col"),p=d("v-select"),O=d("v-row"),$=d("v-radio"),le=d("v-radio-group"),I=d("v-textarea"),z=d("v-card"),Q=d("v-list-item-title"),oe=d("v-list-item-subtitle"),j=d("v-list-item"),te=d("v-list"),ae=d("v-form"),de=d("v-card-text"),se=d("v-card-actions"),re=d("v-dialog");return V(),E(re,{modelValue:b(P),"onUpdate:modelValue":e[30]||(e[30]=g=>pe(P)?P.value=g:null),"max-width":"800",persistent:""},{default:a(()=>[l(z,null,{default:a(()=>[l(S,{class:"d-flex align-center"},{default:a(()=>[l(f,{class:"mr-2",color:b(c)?"success":"primary"},{default:a(()=>[s(_(b(c)?"mdi-plus-circle":"mdi-pencil"),1)]),_:1},8,["color"]),v("span",ce,_(b(c)?"Create New Order":"Edit Order"),1),l(T),l(R,{icon:"mdi-close",variant:"text",onClick:D})]),_:1}),l(W),l(de,{class:"pa-6"},{default:a(()=>[l(ae,{ref_key:"formRef",ref:Z,modelValue:A.value,"onUpdate:modelValue":e[29]||(e[29]=g=>A.value=g),onSubmit:ie(M,["prevent"])},{default:a(()=>{var g,L;return[v("div",fe,[v("h3",be,[l(f,{class:"mr-1",size:"small"},{default:a(()=>e[31]||(e[31]=[s("mdi-information")])),_:1,__:[31]}),e[32]||(e[32]=s(" Basic Information "))]),l(O,null,{default:a(()=>[l(u,{cols:"12",md:"6"},{default:a(()=>[l(n,{modelValue:t.value.reference,"onUpdate:modelValue":e[0]||(e[0]=o=>t.value.reference=o),label:"Order Reference",placeholder:"Optional reference number","prepend-inner-icon":"mdi-tag",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:t.value.platform,"onUpdate:modelValue":e[1]||(e[1]=o=>t.value.platform=o),items:H,label:"Platform","prepend-inner-icon":"mdi-devices",variant:"outlined",density:"comfortable",rules:[r.required]},null,8,["modelValue","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:t.value.source,"onUpdate:modelValue":e[2]||(e[2]=o=>t.value.source=o),items:J,label:"Order Source","prepend-inner-icon":"mdi-source-branch",variant:"outlined",density:"comfortable",rules:[r.required]},null,8,["modelValue","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(n,{modelValue:t.value.delivery_date,"onUpdate:modelValue":e[3]||(e[3]=o=>t.value.delivery_date=o),label:"Delivery Date",type:"datetime-local","prepend-inner-icon":"mdi-calendar-clock",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1})]),v("div",Ve,[v("h3",ye,[l(f,{class:"mr-1",size:"small"},{default:a(()=>e[33]||(e[33]=[s("mdi-store")])),_:1,__:[33]}),e[34]||(e[34]=s(" Vendor & Category "))]),l(O,null,{default:a(()=>[l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:t.value.vendor_id,"onUpdate:modelValue":[e[4]||(e[4]=o=>t.value.vendor_id=o),h],items:X.value,"item-title":"company_name","item-value":"id",label:"Vendor","prepend-inner-icon":"mdi-domain",variant:"outlined",density:"comfortable",rules:[r.required]},null,8,["modelValue","items","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:t.value.category_id,"onUpdate:modelValue":e[5]||(e[5]=o=>t.value.category_id=o),items:Y.value,"item-title":"name","item-value":"id",label:"Category","prepend-inner-icon":"mdi-shape",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1})]),_:1})]),v("div",ge,[v("h3",ke,[l(f,{class:"mr-1",size:"small"},{default:a(()=>e[35]||(e[35]=[s("mdi-map-marker")])),_:1,__:[35]}),e[36]||(e[36]=s(" Address Information "))]),l(le,{modelValue:x.value,"onUpdate:modelValue":[e[6]||(e[6]=o=>x.value=o),ee],inline:"",class:"mb-4"},{default:a(()=>[l($,{label:"Pickup & Drop-off",value:"pickup_dropoff",color:"primary"}),l($,{label:"Customer Delivery",value:"customer",color:"primary"})]),_:1},8,["modelValue"]),x.value==="pickup_dropoff"?(V(),w("div",xe,[l(O,null,{default:a(()=>[l(u,{cols:"12",md:"6"},{default:a(()=>[l(z,{variant:"outlined",class:"pa-4"},{default:a(()=>[l(S,{class:"text-subtitle-2 pa-0 mb-3"},{default:a(()=>[l(f,{class:"mr-1",color:"orange"},{default:a(()=>e[37]||(e[37]=[s("mdi-map-marker-up")])),_:1,__:[37]}),e[38]||(e[38]=s(" Pickup Address "))]),_:1,__:[38]}),l(n,{modelValue:t.value.pickup_address.full_name,"onUpdate:modelValue":e[7]||(e[7]=o=>t.value.pickup_address.full_name=o),label:"Full Name","prepend-inner-icon":"mdi-account",variant:"outlined",density:"comfortable",rules:[r.required],class:"mb-3"},null,8,["modelValue","rules"]),l(n,{modelValue:t.value.pickup_address.phone,"onUpdate:modelValue":e[8]||(e[8]=o=>t.value.pickup_address.phone=o),label:"Phone Number","prepend-inner-icon":"mdi-phone",variant:"outlined",density:"comfortable",rules:[r.required,r.phone],class:"mb-3"},null,8,["modelValue","rules"]),l(n,{modelValue:t.value.pickup_address.email,"onUpdate:modelValue":e[9]||(e[9]=o=>t.value.pickup_address.email=o),label:"Email","prepend-inner-icon":"mdi-email",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),l(p,{modelValue:t.value.pickup_address.city,"onUpdate:modelValue":e[10]||(e[10]=o=>t.value.pickup_address.city=o),items:F.value,"item-title":"name","item-value":"name",label:"City","prepend-inner-icon":"mdi-city",variant:"outlined",density:"comfortable",rules:[r.required],class:"mb-3"},null,8,["modelValue","items","rules"]),l(p,{modelValue:t.value.pickup_address.zone_id,"onUpdate:modelValue":e[11]||(e[11]=o=>t.value.pickup_address.zone_id=o),items:N.value,"item-title":"name","item-value":"id",label:"Zone","prepend-inner-icon":"mdi-map-marker-radius",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue","items"]),l(n,{modelValue:t.value.pickup_address.region,"onUpdate:modelValue":e[12]||(e[12]=o=>t.value.pickup_address.region=o),label:"Region","prepend-inner-icon":"mdi-map",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),l(n,{modelValue:t.value.pickup_address.zipcode,"onUpdate:modelValue":e[13]||(e[13]=o=>t.value.pickup_address.zipcode=o),label:"Zip Code","prepend-inner-icon":"mdi-numeric",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),l(I,{modelValue:t.value.pickup_address.address,"onUpdate:modelValue":e[14]||(e[14]=o=>t.value.pickup_address.address=o),label:"Full Address","prepend-inner-icon":"mdi-home",variant:"outlined",density:"comfortable",rows:"2",rules:[r.required]},null,8,["modelValue","rules"])]),_:1})]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(z,{variant:"outlined",class:"pa-4"},{default:a(()=>[l(S,{class:"text-subtitle-2 pa-0 mb-3"},{default:a(()=>[l(f,{class:"mr-1",color:"green"},{default:a(()=>e[39]||(e[39]=[s("mdi-map-marker-down")])),_:1,__:[39]}),e[40]||(e[40]=s(" Drop-off Address "))]),_:1,__:[40]}),l(n,{modelValue:t.value.dropoff_address.full_name,"onUpdate:modelValue":e[15]||(e[15]=o=>t.value.dropoff_address.full_name=o),label:"Full Name","prepend-inner-icon":"mdi-account",variant:"outlined",density:"comfortable",rules:[r.required],class:"mb-3"},null,8,["modelValue","rules"]),l(n,{modelValue:t.value.dropoff_address.phone,"onUpdate:modelValue":e[16]||(e[16]=o=>t.value.dropoff_address.phone=o),label:"Phone Number","prepend-inner-icon":"mdi-phone",variant:"outlined",density:"comfortable",rules:[r.required,r.phone],class:"mb-3"},null,8,["modelValue","rules"]),l(n,{modelValue:t.value.dropoff_address.email,"onUpdate:modelValue":e[17]||(e[17]=o=>t.value.dropoff_address.email=o),label:"Email","prepend-inner-icon":"mdi-email",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),l(p,{modelValue:t.value.dropoff_address.city,"onUpdate:modelValue":e[18]||(e[18]=o=>t.value.dropoff_address.city=o),items:F.value,"item-title":"name","item-value":"name",label:"City","prepend-inner-icon":"mdi-city",variant:"outlined",density:"comfortable",rules:[r.required],class:"mb-3"},null,8,["modelValue","items","rules"]),l(p,{modelValue:t.value.dropoff_address.zone_id,"onUpdate:modelValue":e[19]||(e[19]=o=>t.value.dropoff_address.zone_id=o),items:N.value,"item-title":"name","item-value":"id",label:"Zone","prepend-inner-icon":"mdi-map-marker-radius",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue","items"]),l(n,{modelValue:t.value.dropoff_address.region,"onUpdate:modelValue":e[20]||(e[20]=o=>t.value.dropoff_address.region=o),label:"Region","prepend-inner-icon":"mdi-map",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),l(n,{modelValue:t.value.dropoff_address.zipcode,"onUpdate:modelValue":e[21]||(e[21]=o=>t.value.dropoff_address.zipcode=o),label:"Zip Code","prepend-inner-icon":"mdi-numeric",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),l(I,{modelValue:t.value.dropoff_address.address,"onUpdate:modelValue":e[22]||(e[22]=o=>t.value.dropoff_address.address=o),label:"Full Address","prepend-inner-icon":"mdi-home",variant:"outlined",density:"comfortable",rows:"2",rules:[r.required]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})])):x.value==="customer"?(V(),w("div",Ue,[l(O,null,{default:a(()=>[l(u,{cols:"12",md:"6"},{default:a(()=>[l(n,{modelValue:t.value.customer_address.full_name,"onUpdate:modelValue":e[23]||(e[23]=o=>t.value.customer_address.full_name=o),label:"Customer Name","prepend-inner-icon":"mdi-account",variant:"outlined",density:"comfortable",rules:[r.required]},null,8,["modelValue","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(n,{modelValue:t.value.customer_address.phone,"onUpdate:modelValue":e[24]||(e[24]=o=>t.value.customer_address.phone=o),label:"Phone Number","prepend-inner-icon":"mdi-phone",variant:"outlined",density:"comfortable",rules:[r.required,r.phone]},null,8,["modelValue","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:t.value.customer_address.city,"onUpdate:modelValue":e[25]||(e[25]=o=>t.value.customer_address.city=o),items:F.value,"item-title":"name","item-value":"name",label:"City","prepend-inner-icon":"mdi-city",variant:"outlined",density:"comfortable",rules:[r.required]},null,8,["modelValue","items","rules"])]),_:1}),l(u,{cols:"12",md:"6"},{default:a(()=>[l(p,{modelValue:t.value.customer_address.zone_id,"onUpdate:modelValue":e[26]||(e[26]=o=>t.value.customer_address.zone_id=o),items:N.value,"item-title":"name","item-value":"id",label:"Zone","prepend-inner-icon":"mdi-map-marker-radius",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),l(u,{cols:"12"},{default:a(()=>[l(I,{modelValue:t.value.customer_address.address,"onUpdate:modelValue":e[27]||(e[27]=o=>t.value.customer_address.address=o),label:"Full Address","prepend-inner-icon":"mdi-home",variant:"outlined",density:"comfortable",rows:"2",rules:[r.required]},null,8,["modelValue","rules"])]),_:1})]),_:1})])):q("",!0)]),!b(c)&&((L=(g=y.value)==null?void 0:g.order_items)!=null&&L.length)?(V(),w("div",we,[v("h3",Ce,[l(f,{class:"mr-1",size:"small"},{default:a(()=>e[41]||(e[41]=[s("mdi-package-variant")])),_:1,__:[41]}),s(" Order Items ("+_(y.value.order_items.length)+") ",1)]),l(z,{variant:"outlined"},{default:a(()=>[l(te,{density:"compact"},{default:a(()=>[(V(!0),w(ue,null,me(y.value.order_items.slice(0,3),o=>(V(),E(j,{key:o.id},{append:a(()=>[v("span",Oe," $"+_((o.quantity*o.unit_price).toFixed(2)),1)]),default:a(()=>[l(Q,null,{default:a(()=>[s(_(o.product_name||"Product"),1)]),_:2},1024),l(oe,null,{default:a(()=>[s(" Qty: "+_(o.quantity)+" × $"+_(o.unit_price),1)]),_:2},1024)]),_:2},1024))),128)),y.value.order_items.length>3?(V(),E(j,{key:0},{default:a(()=>[l(Q,{class:"text-center text-grey"},{default:a(()=>[s(" +"+_(y.value.order_items.length-3)+" more items ",1)]),_:1})]),_:1})):q("",!0)]),_:1})]),_:1})])):q("",!0),b(c)?q("",!0):(V(),w("div",ze,[v("h3",qe,[l(f,{class:"mr-1",size:"small"},{default:a(()=>e[42]||(e[42]=[s("mdi-flag")])),_:1,__:[42]}),e[43]||(e[43]=s(" Order Status "))]),l(p,{modelValue:t.value.status,"onUpdate:modelValue":e[28]||(e[28]=o=>t.value.status=o),items:K,label:"Status","prepend-inner-icon":"mdi-flag",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]))]}),_:1},8,["modelValue"])]),_:1}),l(W),l(se,{class:"pa-4"},{default:a(()=>[l(T),l(R,{variant:"outlined",onClick:D,disabled:C.value},{default:a(()=>e[44]||(e[44]=[s(" Cancel ")])),_:1,__:[44]},8,["disabled"]),l(R,{color:b(c)?"success":"primary",variant:"flat",onClick:M,loading:C.value,disabled:!A.value},{default:a(()=>[l(f,{class:"mr-1"},{default:a(()=>[s(_(b(c)?"mdi-plus":"mdi-content-save"),1)]),_:1}),s(" "+_(b(c)?"Create Order":"Save Changes"),1)]),_:1},8,["color","loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Re=_e(Ae,[["__scopeId","data-v-e3b8567d"]]);export{Re as default};
