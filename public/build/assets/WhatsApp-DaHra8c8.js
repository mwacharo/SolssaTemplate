import{j as C,r as I,s as Ze,Q as jt,k as Et,l as c,c as k,o as g,w as s,b as t,u as a,v as Wt,e as b,f as r,t as m,a as i,R as x,H as ae,d as _,F as ne,g as ie,m as qe,n as Je,y as Qe,X as Bt}from"./app-Cy0yfFDE.js";import{_ as Kt}from"./AppLayout-8Q3h4fMO.js";import{u as Lt}from"./whatsappStore-uQKzFO6O.js";import{u as Ht}from"./WhatsAppConversation.vue_vue_type_style_index_0_scoped_481587e0_lang-BnMcKA2v.js";import{u as Zt,W as qt}from"./WhatsAppConversation-bWHXcxLv.js";import{u as Jt,_ as Qt}from"./Sms-DCUOPGXA.js";import ht from"./AssignDialog-kOtc7i25.js";import{u as Xt}from"./orderStore-fzme9Io5.js";import Gt from"./OrderDialogs-BgHimwoc.js";import{n as B}from"./toast-CiUvgbva.js";import{_ as Yt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-BrB8rTeX.js";import"./africastalking-BG4DNjTF.js";import"./IncomingCallDialog-OVq_Y2zf.js";/* empty css                                                                           *//* empty css                                                                     */const el={class:"d-flex justify-center align-center mt-2"},tl={class:"mb-4"},ll={class:"text-h6 text-primary"},sl={class:"text-h6 text-success"},ol={class:"text-h6 text-info"},al={class:"text-h6 text-error"},nl={class:"mb-4"},il={class:"text-h6 text-primary"},rl={class:"text-h6 text-warning"},dl={class:"text-h6 text-success"},ul={key:1,class:"text-center pa-4"},ml={class:"text-caption text-grey"},pl={class:"d-flex align-center gap-2 flex-wrap"},gl={class:"d-flex align-center justify-space-between flex-wrap gap-2"},vl={class:"d-flex align-center gap-2"},fl={class:"d-flex align-center gap-2 flex-wrap"},cl={key:0,class:"text-caption text-grey"},_l={class:"text-caption text-grey"},yl={key:0,class:"text-caption text-grey"},bl={key:0},Cl={class:"text-caption text-grey"},kl={key:1,class:"text-grey"},xl={key:0,class:"text-caption text-grey"},wl={key:0,class:"text-caption text-grey"},Vl={class:"d-flex"},Ol={key:1,class:"text-center pa-4"},Dl={key:0,class:"text-caption text-success"},Sl={class:"text-center"},Al={class:"d-flex flex-column gap-2"},Fl={class:"d-flex align-center w-100"},Ml={class:"flex-grow-1"},Ul={class:"text-h6 mb-0"},$l={class:"text-caption text-grey"},Pl={key:1,class:"messages-container",ref:"messagesContainer"},Tl={key:0,class:"pa-4"},Nl={key:0,class:"message-sender text-caption font-weight-medium mb-1"},Rl={class:"message-content"},Il={key:1,class:"message-media mt-2"},zl={key:2,class:"message-media mt-2"},jl={class:"audio-container"},El=["src","onEnded"],Wl={class:"message-meta d-flex align-center justify-end mt-1"},Bl={class:"text-caption text-grey mr-2"},Kl={key:1,class:"empty-state pa-8 text-center"},Ll={key:0,class:"attachment-preview mb-3"},Hl={class:"message-input-container"},Zl={class:"input-actions d-flex align-center mt-2"},ql={class:"d-flex align-center flex-grow-1"},Jl={key:0,class:"text-caption text-grey ml-2"},Ql={key:0,class:"emoji-picker mt-3 pa-3"},hl={class:"emoji-grid"},Xl={__name:"WhatsApp",setup(Gl){const u=Lt(),Se=Zt(),he=Jt(),n=Xt(),G=C(()=>n.orders||[]),Ae=I(null),re=I(!1),K=I([]),de=C(()=>{var o,e;return!((o=K.value)!=null&&o.length)||!((e=G.value)!=null&&e.length)?[]:G.value.filter(v=>K.value.includes(v.id))});Ze(K,(o,e)=>{if(console.log("🔵 Selection changed from:",e,"to:",o),console.log("🔵 Selected orders count:",(o==null?void 0:o.length)||0),(o==null?void 0:o.length)>0){const v=de.value;n.selectedOrders=v,console.log("🔵 Updated orderStore.selectedOrders:",v)}else n.selectedOrders=[]},{deep:!0,immediate:!0});const ue=(o,e=[])=>{console.log("🚀 openDialog called with mode:",o),Ae.value=o,re.value=!0;const v=e.length>0?e:de.value;v&&v.length>0?(console.log("✅ Using orders for dialog:",v.length,"orders"),n.selectedOrders=v):console.log("⚠️ No orders selected for dialog")},Fe=async(o=[])=>{console.log("📨 openNewMessageDialog called with IDs:",o);let e=[];Array.isArray(o)&&o.length>0?(e=n.orders.filter(d=>o.includes(d.id)).map(d=>d.customer||d.contact).filter(d=>d&&d.phone),u.selectedContacts=e.map(d=>({id:d.id,name:d.name||d.full_name||d.phone,phone:d.phone}))):((!Array.isArray(u.contacts)||u.contacts.length===0)&&!u.loading.contacts&&await u.loadContacts(),u.selectedContacts=[]),(!Array.isArray(u.templates)||u.templates.length===0)&&!u.loading.templates&&await u.loadTemplates(),u.errorMessage="",u.messageText="",u.selectedTemplate=null,u.showNewMessageDialog=!0},Xe=C(()=>{var o,e;return{selectedIds:K.value,selectedCount:((o=K.value)==null?void 0:o.length)||0,selectedOrders:de.value,tableItemsCount:((e=G.value)==null?void 0:e.length)||0}}),Ge=({mode:o,selected:e,orders:v})=>{console.log("handleConfirm called with:",JSON.stringify({mode:o,selected:e,orders:v})),o==="rider"?Ye(e,v):o==="agent"?et(e,v):o==="status"&&tt(e,v)},Ye=async(o,e)=>{try{const v=await axios.post("/api/v1/assign-rider",{rider_id:o,order_ids:e});B.success(v.data.message||"Rider assigned successfully")}catch{B.error("Failed to assign rider")}},et=async(o,e)=>{var v,d;try{const V=await axios.post("/api/v1/assign-agent",{agent_id:o,order_ids:e});B.success(V.data.message||"Agent assigned successfully")}catch(V){B.error(((d=(v=V.response)==null?void 0:v.data)==null?void 0:d.message)||"Failed to assign agent")}},tt=async(o,e)=>{var v,d;try{const V=await axios.post("/api/v1/update-status",{status:o,order_ids:e});B.success(V.data.message||"Status updated successfully")}catch(V){B.error(((d=(v=V.response)==null?void 0:v.data)==null?void 0:d.message)||"Failed to update status")}},lt=o=>{n.openDialog(o)},L=I(null),me=I(!1),pe=I([]),st=Ht(),Me=C(()=>st.user),H=C(()=>{var o;return(o=Me.value)==null?void 0:o.id});console.log("User:",JSON.stringify(Me.value)),console.log("User ID:",H.value);const ot=[{title:"Order #",key:"order_no"},{title:"Customer",key:"customer"},{title:"Vendor",key:"vendor"},{title:"Status",key:"status"},{title:"Items",key:"order_items"},{title:"Total Price",key:"total_price"},{title:"Date Created",key:"created_at"},{title:"Actions",key:"actions",sortable:!1}],at=[{title:"All Types",value:"all"},{title:"Customer",value:"customer"},{title:"Vendor",value:"vendor"},{title:"Partner",value:"partner"},{title:"Employee",value:"employee"}],Ue=C(()=>!n.orderDateRange||n.orderDateRange.length===0?"":n.orderDateRange.length===1?Q(n.orderDateRange[0]):`${Q(n.orderDateRange[0])} - ${Q(n.orderDateRange[1])}`);C(()=>{const o=!!(n.orderFilterStatus||n.orderFilterProduct||n.orderFilterZone||n.orderFilterAgent||n.orderFilterRider||n.orderFilterVendor||n.orderDateRange&&n.orderDateRange.length>0||n.orderSearch);return console.log("🔍 hasActiveFilters:",o),o});const{attachment:U,replyMessage:Z,messages:Yl,contacts:nt,orders:it,templates:es,selectedContacts:ts,selectedOrders:Y,selectedTemplate:ge,messageText:ve,currentPage:ls,perPage:ss,totalMessages:rt,totalOrders:os,loading:A,showImportDialog:q,showNewMessageDialog:as,showOrderImportDialog:J,showOrderMessageDialog:ee,activeTab:z,search:te,filterType:fe,filterStatus:ce,orderFilters:ns,errorMessage:$e,successMessage:Pe,stats:T,whatsappStatus:N,csvFile:_e,orderFile:ye}=jt(u),be=C(()=>u.filteredContacts);C(()=>u.filteredOrders);const Ce=C(()=>u.filteredMessages);C(()=>u.validWhatsappContacts),C(()=>u.totalPages),C(()=>u.totalOrderPages),C(()=>u.allTemplates);const le=o=>u.formatPhoneNumber(o),Te=(o=1)=>u.loadMessages(o),dt=()=>u.resetFilters(),ke=()=>u.sendMessage(H.value),Ne=()=>u.sendOrderMessage({userId:H.value}),ut=()=>u.importContacts({userId:H.value}),mt=()=>u.importOrders({userId:H.value}),pt=()=>u.openOrderMessageDialog(),gt=o=>u.deleteMessage(o),vt=o=>o.reduce((e,v)=>e+(v.quantity||0),0),ft=o=>{window.open(`/api/v1/orders/${o}/print-waybill`,"_blank")},Q=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",ct=o=>{var e;console.log("sendSms called with:",JSON.stringify(o)),console.log("store methods:",Object.keys(u)),o&&((e=o.client)!=null&&e.phone_number)?(console.log("Calling openDialog with:",o.client.phone_number),he.openDialog(o.client.phone_number)):(console.log("Missing recipient phone number in item",o),u.errorMessage="Recipient phone number is required.")},_t=o=>{console.log("viewMessageDetails called with:",o),console.log("conversationStore:",Se),o.to?(console.log("Calling openDialog with:",o.to),Se.openDialog(o.to)):console.log("Missing contact ID in message",o)},yt=o=>!!(o.whatsapp||o.alt_phone||o.phone),bt=o=>{alert(`Contact: ${o.name}
Phone: ${o.phone||"N/A"}
WhatsApp: ${o.whatsapp||"N/A"}
Type: ${o.type||"N/A"}
Company: ${o.company_name||"N/A"}
Country: ${o.country_name||"N/A"}`)},Ct=o=>({active:"success",inactive:"grey",pending:"warning",processing:"primary",cancelled:"error"})[o==null?void 0:o.toLowerCase()]||"grey",kt=o=>({inprogress:"warning",delivered:"success",cancelled:"error",pending:"primary",shipped:"info"})[o==null?void 0:o.toLowerCase()]||"grey";Ze(()=>u.search,o=>{o===""&&u.loadMessages(u.currentPage)});function Re(){var e;if(!L.value)return"Unknown";const o=(e=nt.value)==null?void 0:e.find(v=>v.phone===L.value||v.whatsapp===L.value);return(o==null?void 0:o.name)||L.value}function xt(){return L.value||"-"}function wt(){return N.value==="Connected"?"success":N.value==="Connecting..."?"warning":"error"}function Vt(){return N.value||"Unknown"}const j=()=>{E()},Ot=()=>{orderDateMenu.value=!1,E()},Dt=()=>{n.orderDateRange=[],E()},St=()=>{n.clearAllFilters(),E()},E=async()=>{try{console.log("🔍 Applying filters..."),n.loading.orders=!0;const o={status:n.orderFilterStatus,product:n.orderFilterProduct,zone:n.orderFilterZone,agent:n.orderFilterAgent,rider:n.orderFilterRider,vendor:n.orderFilterVendor,dateRange:n.orderDateRange,search:n.orderSearch},e=Object.fromEntries(Object.entries(o).filter(([v,d])=>d!=null&&d!==""&&!(Array.isArray(d)&&d.length===0)));console.log("🧹 Clean filters:",e),await n.loadOrdersWithFilters(e),console.log("✅ Filters applied successfully. Orders loaded:",n.orders.length)}catch(o){handleError(o,"applyFilters")}finally{n.loading.orders=!1}},se=I(!1);function At(){se.value=!0}async function Ft({page:o,per_page:e,sortBy:v,search:d}){var D,$;if(e!==n.pagination.per_page){const S=(n.pagination.page-1)*n.pagination.per_page+1;n.pagination.page=Math.ceil(S/e)}else n.pagination.page=o;n.pagination.per_page=e,n.search=d||"",v&&v.length>0&&(n.sort=v[0]);const V={...n.activeFilters,search:n.search,page:n.pagination.page,per_page:n.pagination.per_page,sort:(D=n.sort)==null?void 0:D.key,direction:($=n.sort)==null?void 0:$.order};await n.fetchOrders(V)}return Et(async()=>{try{await u.initialize(),await n.initialize(),console.log("✅ All stores initialized successfully"),console.log("🔍 Initial selection state:",Xe.value)}catch(o){console.error("❌ Error during initialization:",o)}}),(o,e)=>{const v=c("v-alert"),d=c("v-icon"),V=c("v-avatar"),D=c("v-chip"),$=c("v-divider"),S=c("v-col"),xe=c("v-row"),f=c("v-btn"),w=c("v-card-text"),M=c("v-card"),we=c("v-tab"),Mt=c("v-tabs"),Ve=c("v-text-field"),F=c("v-card-title"),oe=c("v-progress-linear"),Ut=c("v-data-table"),Oe=c("v-window-item"),$t=c("v-data-table-server"),O=c("v-select"),Pt=c("v-table"),Tt=c("v-window"),Nt=c("v-date-picker"),Ie=c("v-menu"),W=c("v-spacer"),h=c("v-card-actions"),R=c("v-dialog"),De=c("v-textarea"),ze=c("v-file-input"),je=c("v-img"),Ee=c("v-list-item-icon"),We=c("v-list-item-title"),Be=c("v-list-item-content"),Ke=c("v-list-item"),Rt=c("v-list"),It=c("v-expand-transition"),zt=c("v-container");return g(),k(Kt,null,{default:s(()=>[t(a(Wt),{title:"WhatsApp Business - Courier Management"}),t(zt,{fluid:""},{default:s(()=>[a($e)?(g(),k(v,{key:0,type:"error",closable:"",class:"mb-4"},{default:s(()=>[r(m(a($e)),1)]),_:1})):b("",!0),a(Pe)?(g(),k(v,{key:1,type:"success",closable:"",class:"mb-4"},{default:s(()=>[r(m(a(Pe)),1)]),_:1})):b("",!0),t(xe,null,{default:s(()=>[t(S,{cols:"12",lg:"3"},{default:s(()=>[t(M,{class:"mb-4"},{default:s(()=>[t(w,{class:"text-center"},{default:s(()=>[t(V,{size:"80",color:a(N)==="Connected"?"green":"grey",class:"mb-3"},{default:s(()=>[t(d,{size:"48",color:"white"},{default:s(()=>e[59]||(e[59]=[r("mdi-whatsapp")])),_:1,__:[59]})]),_:1},8,["color"]),e[77]||(e[77]=i("h2",{class:"text-h6"},"WhatsApp Business",-1)),e[78]||(e[78]=i("h3",{class:"text-subtitle-2 text-grey"},"Courier Management System",-1)),i("div",el,[t(D,{color:a(N)==="Connected"?"success":a(N)==="Connecting..."?"warning":"error",class:"mr-2"},{default:s(()=>[r(m(a(N)),1)]),_:1},8,["color"])]),t($,{class:"my-4"}),i("div",tl,[e[64]||(e[64]=i("h4",{class:"text-subtitle-1 mb-2"},"Message Stats",-1)),t(xe,null,{default:s(()=>[t(S,{cols:"6",class:"py-1"},{default:s(()=>[e[60]||(e[60]=i("div",{class:"text-subtitle-2"},"Sent",-1)),i("div",ll,m(a(T).sent),1)]),_:1,__:[60]}),t(S,{cols:"6",class:"py-1"},{default:s(()=>[e[61]||(e[61]=i("div",{class:"text-subtitle-2"},"Delivered",-1)),i("div",sl,m(a(T).delivered),1)]),_:1,__:[61]}),t(S,{cols:"6",class:"py-1"},{default:s(()=>[e[62]||(e[62]=i("div",{class:"text-subtitle-2"},"Read",-1)),i("div",ol,m(a(T).read),1)]),_:1,__:[62]}),t(S,{cols:"6",class:"py-1"},{default:s(()=>[e[63]||(e[63]=i("div",{class:"text-subtitle-2"},"Failed",-1)),i("div",al,m(a(T).failed),1)]),_:1,__:[63]})]),_:1})]),t($,{class:"my-4"}),i("div",nl,[e[68]||(e[68]=i("h4",{class:"text-subtitle-1 mb-2"},"Order Stats",-1)),t(xe,null,{default:s(()=>[t(S,{cols:"6",class:"py-1"},{default:s(()=>[e[65]||(e[65]=i("div",{class:"text-subtitle-2"},"Total Orders",-1)),i("div",il,m(a(T).totalOrders),1)]),_:1,__:[65]}),t(S,{cols:"6",class:"py-1"},{default:s(()=>[e[66]||(e[66]=i("div",{class:"text-subtitle-2"},"Pending",-1)),i("div",rl,m(a(T).pendingOrders),1)]),_:1,__:[66]}),t(S,{cols:"12",class:"py-1"},{default:s(()=>[e[67]||(e[67]=i("div",{class:"text-subtitle-2"},"Delivered",-1)),i("div",dl,m(a(T).deliveredOrders),1)]),_:1,__:[67]})]),_:1})]),t($,{class:"my-4"}),t(f,{color:"primary",block:"",class:"mb-2",onClick:Fe},{default:s(()=>[t(d,{class:"mr-2"},{default:s(()=>e[69]||(e[69]=[r("mdi-message-text")])),_:1,__:[69]}),e[70]||(e[70]=r(" New Message "))]),_:1,__:[70]}),t(f,{color:"success",block:"",class:"mb-2",onClick:pt},{default:s(()=>[t(d,{class:"mr-2"},{default:s(()=>e[71]||(e[71]=[r("mdi-package-variant")])),_:1,__:[71]}),e[72]||(e[72]=r(" Order Messages "))]),_:1,__:[72]}),t(f,{color:"info",block:"",class:"mb-2",onClick:e[0]||(e[0]=l=>q.value=!0)},{default:s(()=>[t(d,{class:"mr-2"},{default:s(()=>e[73]||(e[73]=[r("mdi-file-import")])),_:1,__:[73]}),e[74]||(e[74]=r(" Import Contacts "))]),_:1,__:[74]}),t(f,{color:"orange",block:"",class:"mb-2",onClick:e[1]||(e[1]=l=>J.value=!0)},{default:s(()=>[t(d,{class:"mr-2"},{default:s(()=>e[75]||(e[75]=[r("mdi-file-excel")])),_:1,__:[75]}),e[76]||(e[76]=r(" Import Orders "))]),_:1,__:[76]})]),_:1,__:[77,78]})]),_:1})]),_:1}),t(S,{cols:"12",lg:"9"},{default:s(()=>[t(M,null,{default:s(()=>[t(Mt,{modelValue:a(z),"onUpdate:modelValue":e[2]||(e[2]=l=>x(z)?z.value=l:null),color:"primary"},{default:s(()=>[t(we,{value:"messages"},{default:s(()=>[t(d,{class:"mr-2"},{default:s(()=>e[79]||(e[79]=[r("mdi-message-text")])),_:1,__:[79]}),e[80]||(e[80]=r(" Messages "))]),_:1,__:[80]}),t(we,{value:"orders"},{default:s(()=>[t(d,{class:"mr-2"},{default:s(()=>e[81]||(e[81]=[r("mdi-package-variant")])),_:1,__:[81]}),e[82]||(e[82]=r(" Orders "))]),_:1,__:[82]}),t(we,{value:"contacts"},{default:s(()=>[t(d,{class:"mr-2"},{default:s(()=>e[83]||(e[83]=[r("mdi-account-multiple")])),_:1,__:[83]}),e[84]||(e[84]=r(" Contacts "))]),_:1,__:[84]})]),_:1},8,["modelValue"]),t(Tt,{modelValue:a(z),"onUpdate:modelValue":e[18]||(e[18]=l=>x(z)?z.value=l:null)},{default:s(()=>[t(Oe,{value:"messages"},{default:s(()=>[t(F,{class:"d-flex flex-wrap justify-space-between align-center"},{default:s(()=>[e[85]||(e[85]=i("div",{class:"text-h6"},"Recent Messages",-1)),t(Ve,{modelValue:a(te),"onUpdate:modelValue":e[3]||(e[3]=l=>x(te)?te.value=l:null),"append-icon":"mdi-magnify",label:"Search messages","single-line":"","hide-details":"",density:"compact",class:"max-w-xs mt-2 mt-sm-0",loading:a(A).messages,onKeyup:e[4]||(e[4]=ae(l=>Te(1),["enter"])),"onClick:clear":e[5]||(e[5]=()=>{te.value="",Te(1)}),clearable:""},null,8,["modelValue","loading"])]),_:1,__:[85]}),t(w,null,{default:s(()=>[a(A).messages?(g(),k(oe,{key:0,indeterminate:"",color:"primary"})):!Array.isArray(Ce.value)||Ce.value.length===0?(g(),_("div",ul,[t(d,{size:"large",color:"grey"},{default:s(()=>e[86]||(e[86]=[r("mdi-message-text-outline")])),_:1,__:[86]}),e[87]||(e[87]=i("p",{class:"text-body-1 mt-2"},"No messages found. Try sending one!",-1))])):(g(),k(Ut,{key:2,headers:[{title:"Content",value:"content",sortable:!1},{title:"Recipient",value:"recipient_name",sortable:!1},{title:"Order #",value:"order_number",sortable:!1},{title:"Status",value:"status",sortable:!0},{title:"Date",value:"sent_at",sortable:!0},{title:"Actions",value:"actions",sortable:!1}],items:Ce.value,options:o.messageTableOptions,"server-items-length":a(rt),loading:a(A).messages,"item-key":"id",class:"elevation-1","onUpdate:options":o.onMessageTableOptionsChange},{"item.content":s(({item:l})=>[i("span",null,m(l.content),1)]),"item.recipient_name":s(({item:l})=>[i("div",null,m(l.recipient_name||"N/A"),1),i("div",ml,m(le(l.to)),1)]),"item.order_number":s(({item:l})=>[r(m(l.order_number||"-"),1)]),"item.status":s(({item:l})=>{var p;return[t(D,{color:{sent:"primary",delivered:"success",read:"info",failed:"error",pending:"warning"}[(p=l.status)==null?void 0:p.toLowerCase()]||"grey",small:""},{default:s(()=>[r(m(l.status||"Unknown"),1)]),_:2},1032,["color"])]}),"item.sent_at":s(({item:l})=>{var p;return[r(m(l.sent_at||((p=l.created_at)==null?void 0:p.split("T")[0])||"-"),1)]}),"item.actions":s(({item:l})=>[t(f,{variant:"text",color:"primary",size:"large",onClick:p=>_t(l)},{default:s(()=>[t(d,null,{default:s(()=>e[88]||(e[88]=[r("mdi-eye")])),_:1,__:[88]})]),_:2},1032,["onClick"]),t(f,{variant:"text",size:"large",color:"error",onClick:p=>gt(l.id)},{default:s(()=>[t(d,null,{default:s(()=>e[89]||(e[89]=[r("mdi-delete")])),_:1,__:[89]})]),_:2},1032,["onClick"])]),_:1},8,["items","options","server-items-length","loading","onUpdate:options"]))]),_:1})]),_:1}),t(Oe,{value:"orders"},{default:s(()=>[t(F,{class:"d-flex flex-wrap justify-space-between align-center"},{default:s(()=>[e[91]||(e[91]=i("div",{class:"text-h6"},"Orders",-1)),t(Ve,{modelValue:a(n).orderSearch,"onUpdate:modelValue":e[6]||(e[6]=l=>a(n).orderSearch=l),"append-icon":"mdi-magnify",label:"Search orders",placeholder:"Client, Order #, Phone","single-line":"","hide-details":"",density:"compact",clearable:"",class:"max-w-xs",loading:a(n).loading.orders,onKeyup:ae(E,["enter"]),"onClick:clear":e[7]||(e[7]=()=>{a(n).orderSearch="",E()})},null,8,["modelValue","loading"]),i("div",pl,[t(f,{icon:"",onClick:At,loading:a(n).loading.orders,color:"primary",title:"Apply Filters"},{default:s(()=>[t(d,null,{default:s(()=>e[90]||(e[90]=[r("mdi-filter")])),_:1,__:[90]})]),_:1},8,["loading"])])]),_:1,__:[91]}),a(n).selectedOrders&&a(n).selectedOrders.length>0?(g(),k(w,{key:0,class:"py-2"},{default:s(()=>[t(v,{type:"info",variant:"tonal",class:"mb-0"},{default:s(()=>[i("div",gl,[i("div",vl,[t(d,null,{default:s(()=>e[92]||(e[92]=[r("mdi-checkbox-marked")])),_:1,__:[92]}),i("span",null,m(a(n).selectedOrders.length)+" order(s) selected",1),t(f,{variant:"text",size:"small",onClick:e[8]||(e[8]=l=>a(n).selectedOrders=[])},{default:s(()=>e[93]||(e[93]=[r(" Clear Selection ")])),_:1,__:[93]})]),i("div",fl,[t(f,{color:"error",variant:"outlined",size:"small",onClick:e[9]||(e[9]=l=>o.showBulkDeleteDialog=!0)},{default:s(()=>[t(d,{start:""},{default:s(()=>e[94]||(e[94]=[r("mdi-delete")])),_:1,__:[94]}),e[95]||(e[95]=r(" Delete Selected "))]),_:1,__:[95]}),t(f,{color:"primary",variant:"outlined",size:"small",onClick:e[10]||(e[10]=l=>ue("rider",a(n).selectedOrders))},{default:s(()=>[t(d,{start:""},{default:s(()=>e[96]||(e[96]=[r("mdi-motorbike")])),_:1,__:[96]}),e[97]||(e[97]=r(" Assign Rider "))]),_:1,__:[97]}),t(f,{color:"secondary",variant:"outlined",size:"small",onClick:e[11]||(e[11]=l=>ue("agent",a(n).selectedOrders))},{default:s(()=>[t(d,{start:""},{default:s(()=>e[98]||(e[98]=[r("mdi-account-tie")])),_:1,__:[98]}),e[99]||(e[99]=r(" Assign Agent "))]),_:1,__:[99]}),t(f,{color:"success",variant:"outlined",size:"small",onClick:e[12]||(e[12]=l=>Fe(a(n).selectedOrders))},{default:s(()=>[t(d,{start:""},{default:s(()=>e[100]||(e[100]=[r("mdi-whatsapp")])),_:1,__:[100]}),e[101]||(e[101]=r(" Send Messages "))]),_:1,__:[101]}),t(f,{color:"warning",variant:"outlined",size:"small",onClick:e[13]||(e[13]=l=>ue("status",a(n).selectedOrders))},{default:s(()=>[t(d,{start:""},{default:s(()=>e[102]||(e[102]=[r("mdi-update")])),_:1,__:[102]}),e[103]||(e[103]=r(" Update Status "))]),_:1,__:[103]})])])]),_:1})]),_:1})):b("",!0),t(w,null,{default:s(()=>[a(n).loading.orders?(g(),k(oe,{key:0,indeterminate:"",color:"primary"})):b("",!0),t($t,{modelValue:a(n).selectedOrders,"onUpdate:modelValue":e[14]||(e[14]=l=>a(n).selectedOrders=l),"items-per-page":a(n).pagination.itemsPerPage,"onUpdate:itemsPerPage":e[15]||(e[15]=l=>a(n).pagination.itemsPerPage=l),headers:ot,items:G.value,"items-length":a(n).pagination.total,loading:a(n).loading.orders,search:a(n).search,"show-select":"","item-value":"id",class:"elevation-1","onUpdate:options":Ft},{"item.order_no":s(({item:l})=>[i("strong",null,m(l.order_no),1),l.reference?(g(),_("div",cl," Ref: "+m(l.reference),1)):b("",!0)]),"item.customer":s(({item:l})=>{var p,y;return[i("div",null,m(((p=l.customer)==null?void 0:p.full_name)||"N/A"),1),i("div",_l,m(le((y=l.customer)==null?void 0:y.phone)),1)]}),"item.vendor":s(({item:l})=>{var p,y;return[i("div",null,m(((p=l.vendor)==null?void 0:p.name)||"N/A"),1),(y=l.vendor)!=null&&y.company_name?(g(),_("div",yl,m(l.vendor.company_name),1)):b("",!0)]}),"item.status":s(({item:l})=>{var p,y,P,X;return[t(D,{color:((y=(p=l.latest_status)==null?void 0:p.status)==null?void 0:y.color)||Ct((X=(P=l.latest_status)==null?void 0:P.status)==null?void 0:X.name),small:""},{default:s(()=>{var Le,He;return[r(m(((He=(Le=l.latest_status)==null?void 0:Le.status)==null?void 0:He.name)||"Unknown"),1)]}),_:2},1032,["color"])]}),"item.delivery_status":s(({item:l})=>{var p,y,P,X;return[t(D,{color:((y=(p=l.latest_status)==null?void 0:p.status)==null?void 0:y.color)||kt((X=(P=l.latest_status)==null?void 0:P.status)==null?void 0:X.status_category),small:""},{default:s(()=>[r(m(l.delivery_status||"Unknown"),1)]),_:2},1032,["color"])]}),"item.order_items":s(({item:l})=>{var p;return[(p=l.order_items)!=null&&p.length?(g(),_("div",bl,[r(m(l.order_items.length)+" item(s) ",1),i("div",Cl," Qty: "+m(vt(l.order_items)),1),(g(!0),_(ne,null,ie(l.order_items,y=>{var P;return g(),_("div",{key:y.id,class:"text-caption text-grey"},m(y.name||((P=y.product)==null?void 0:P.product_name)||y.product_name||y.sku||"Product")+" (x"+m(y.quantity)+") ",1)}),128))])):(g(),_("div",kl,"No items"))]}),"item.total_price":s(({item:l})=>[i("div",null," KSH"+m(parseFloat(l.total_price||l.invoice_value||0).toFixed(2)),1),l.shipping_charges&&l.shipping_charges!=="0.00"?(g(),_("div",xl," Shipping: KSH"+m(parseFloat(l.shipping_charges).toFixed(2)),1)):b("",!0)]),"item.created_at":s(({item:l})=>[r(m(Q(l.created_at))+" ",1),l.delivery_date?(g(),_("div",wl," Delivery: "+m(Q(l.delivery_date)),1)):b("",!0)]),"item.actions":s(({item:l})=>[t(f,{variant:"text",size:"large",color:"primary",onClick:p=>lt(l)},{default:s(()=>[t(d,null,{default:s(()=>e[104]||(e[104]=[r("mdi-eye")])),_:1,__:[104]})]),_:2},1032,["onClick"]),t(f,{variant:"text",size:"large",color:"success",onClick:p=>Ne([l])},{default:s(()=>[t(d,null,{default:s(()=>e[105]||(e[105]=[r("mdi-whatsapp")])),_:1,__:[105]})]),_:2},1032,["onClick"]),t(f,{variant:"text",size:"large",color:"info",onClick:p=>ft(l.id)},{default:s(()=>[t(d,null,{default:s(()=>e[106]||(e[106]=[r("mdi-printer")])),_:1,__:[106]})]),_:2},1032,["onClick"]),t(f,{variant:"text",size:"large",onClick:p=>ct(l)},{default:s(()=>[t(d,null,{default:s(()=>e[107]||(e[107]=[r("mdi-message-text")])),_:1,__:[107]})]),_:2},1032,["onClick"])]),_:1},8,["modelValue","items-per-page","items","items-length","loading","search"])]),_:1})]),_:1}),t(Oe,{value:"contacts"},{default:s(()=>[t(F,{class:"d-flex flex-wrap justify-space-between align-center"},{default:s(()=>[e[109]||(e[109]=i("div",{class:"text-h6"},"Contacts",-1)),i("div",Vl,[t(O,{modelValue:a(fe),"onUpdate:modelValue":e[16]||(e[16]=l=>x(fe)?fe.value=l:null),items:at,"item-title":"title","item-value":"value",label:"Type","hide-details":"",density:"compact",class:"mr-2"},null,8,["modelValue"]),t(O,{modelValue:a(ce),"onUpdate:modelValue":e[17]||(e[17]=l=>x(ce)?ce.value=l:null),items:o.statusOptions,"item-title":"title","item-value":"value",label:"Status","hide-details":"",density:"compact"},null,8,["modelValue","items"]),t(f,{icon:"",class:"ml-2",onClick:dt},{default:s(()=>[t(d,null,{default:s(()=>e[108]||(e[108]=[r("mdi-filter-remove")])),_:1,__:[108]})]),_:1})])]),_:1,__:[109]}),t(w,null,{default:s(()=>[a(A).contacts?(g(),k(oe,{key:0,indeterminate:"",color:"primary"})):!Array.isArray(be.value)||be.value.length===0?(g(),_("div",Ol,[t(d,{size:"large",color:"grey"},{default:s(()=>e[110]||(e[110]=[r("mdi-account-multiple")])),_:1,__:[110]}),e[111]||(e[111]=i("p",{class:"text-body-1 mt-2"},"No contacts found.",-1))])):(g(),k(Pt,{key:2},{default:s(()=>[e[114]||(e[114]=i("thead",null,[i("tr",null,[i("th",null,"Name"),i("th",null,"Phone"),i("th",null,"Type"),i("th",null,"Status"),i("th",null,"Company"),i("th",null,"Country"),i("th",{class:"text-center"},"Actions")])],-1)),i("tbody",null,[(g(!0),_(ne,null,ie(be.value,l=>(g(),_("tr",{key:l.id},[i("td",null,m(l.name),1),i("td",null,[i("div",null,m(le(l.phone)),1),l.whatsapp?(g(),_("div",Dl," WhatsApp: "+m(le(l.whatsapp)),1)):b("",!0)]),i("td",null,m(l.type||"-"),1),i("td",null,[t(D,{color:l.status===1?"success":"grey",small:""},{default:s(()=>[r(m(l.status===1?"Active":"Inactive"),1)]),_:2},1032,["color"])]),i("td",null,m(l.company_name||"-"),1),i("td",null,m(l.country_name||"-"),1),i("td",Sl,[t(f,{icon:"",size:"small",onClick:p=>bt(l)},{default:s(()=>[t(d,null,{default:s(()=>e[112]||(e[112]=[r("mdi-eye")])),_:1,__:[112]})]),_:2},1032,["onClick"]),t(f,{icon:"",size:"small",color:"primary",disabled:!yt(l),onClick:p=>o.openSendMessage(!1,l)},{default:s(()=>[t(d,null,{default:s(()=>e[113]||(e[113]=[r("mdi-whatsapp")])),_:1,__:[113]})]),_:2},1032,["disabled","onClick"])])]))),128))])]),_:1,__:[114]}))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(R,{modelValue:se.value,"onUpdate:modelValue":e[29]||(e[29]=l=>se.value=l),"max-width":"400","content-class":"custom-filter-dialog",persistent:"",scrollable:""},{default:s(()=>[t(M,null,{default:s(()=>[t(F,null,{default:s(()=>e[115]||(e[115]=[i("span",{class:"text-h6"},"Order Filters",-1)])),_:1,__:[115]}),t(w,null,{default:s(()=>[i("div",Al,[t(O,{modelValue:a(n).orderFilterStatus,"onUpdate:modelValue":[e[19]||(e[19]=l=>a(n).orderFilterStatus=l),j],items:a(n).statusOptions,"item-title":"name","item-value":"id",label:"Status","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(O,{modelValue:a(n).orderFilterProduct,"onUpdate:modelValue":[e[20]||(e[20]=l=>a(n).orderFilterProduct=l),j],items:a(n).productOptions,"item-title":"product_name","item-value":"id",label:"Product","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(O,{modelValue:a(n).orderFilterZone,"onUpdate:modelValue":[e[21]||(e[21]=l=>a(n).orderFilterZone=l),j],items:a(n).zoneOptions,"item-title":"name","item-value":"id",label:"Zone","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(O,{modelValue:a(n).orderFilterAgent,"onUpdate:modelValue":[e[22]||(e[22]=l=>a(n).orderFilterAgent=l),j],items:a(n).agentOptions,"item-title":"name","item-value":"id",label:"Agent","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(O,{modelValue:a(n).orderFilterRider,"onUpdate:modelValue":[e[23]||(e[23]=l=>a(n).orderFilterRider=l),j],items:a(n).riderOptions,"item-title":"name","item-value":"id",label:"Rider","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(O,{modelValue:a(n).orderFilterVendor,"onUpdate:modelValue":[e[24]||(e[24]=l=>a(n).orderFilterVendor=l),j],items:a(n).vendorOptions,"item-title":"name","item-value":"id",label:"Vendor","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(Ie,{modelValue:o.orderDateMenu,"onUpdate:modelValue":e[27]||(e[27]=l=>o.orderDateMenu=l),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},{activator:s(({props:l})=>[t(Ve,qe({modelValue:Ue.value,"onUpdate:modelValue":e[25]||(e[25]=p=>Ue.value=p),label:"Date Range","prepend-icon":"mdi-calendar",readonly:""},l,{"hide-details":"",density:"compact",clearable:"",class:"mb-2","onClick:clear":Dt}),null,16,["modelValue"])]),default:s(()=>[t(Nt,{modelValue:a(n).orderDateRange,"onUpdate:modelValue":[e[26]||(e[26]=l=>a(n).orderDateRange=l),Ot],range:""},null,8,["modelValue"])]),_:1},8,["modelValue"])])]),_:1}),t(h,null,{default:s(()=>[t(f,{text:"",color:"primary",onClick:St},{default:s(()=>e[116]||(e[116]=[r("Clear All")])),_:1,__:[116]}),t(W),t(f,{text:"",onClick:e[28]||(e[28]=l=>se.value=!1)},{default:s(()=>e[117]||(e[117]=[r("Close")])),_:1,__:[117]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(R,{modelValue:a(u).showNewMessageDialog,"onUpdate:modelValue":e[34]||(e[34]=l=>a(u).showNewMessageDialog=l),"max-width":"600"},{default:s(()=>[t(M,null,{default:s(()=>[t(F,null,{default:s(()=>e[118]||(e[118]=[i("span",{class:"text-h6"},"Send WhatsApp Message",-1)])),_:1,__:[118]}),t(w,null,{default:s(()=>[t(O,{modelValue:a(u).selectedContacts,"onUpdate:modelValue":e[30]||(e[30]=l=>a(u).selectedContacts=l),items:a(u).validWhatsappContacts,"item-title":"name","item-value":"id",label:"Select Recipients",multiple:"",chips:"",disabled:a(u).loading.contacts,loading:a(u).loading.contacts,"return-object":""},null,8,["modelValue","items","disabled","loading"]),t(O,{modelValue:a(u).selectedTemplate,"onUpdate:modelValue":[e[31]||(e[31]=l=>a(u).selectedTemplate=l),a(u).onTemplateSelect],items:a(u).allTemplates,"item-title":"name","item-value":"id",label:"Select Template","return-object":"",disabled:a(u).loading.templates,loading:a(u).loading.templates,class:"mt-3",clearable:""},null,8,["modelValue","items","disabled","loading","onUpdate:modelValue"]),t(De,{modelValue:a(u).messageText,"onUpdate:modelValue":e[32]||(e[32]=l=>a(u).messageText=l),label:"Message",rows:"4","auto-grow":"",class:"mt-3",placeholder:"Type your message or select a template above"},null,8,["modelValue"])]),_:1}),t(h,null,{default:s(()=>[t(W),t(f,{color:"primary",loading:a(u).loading.sending,onClick:ke,disabled:!a(u).messageText.trim()},{default:s(()=>e[119]||(e[119]=[r(" Send ")])),_:1,__:[119]},8,["loading","disabled"]),t(f,{text:"",onClick:e[33]||(e[33]=l=>a(u).showNewMessageDialog=!1)},{default:s(()=>e[120]||(e[120]=[r("Cancel")])),_:1,__:[120]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(R,{modelValue:a(ee),"onUpdate:modelValue":e[39]||(e[39]=l=>x(ee)?ee.value=l:null),"max-width":"600"},{default:s(()=>[t(M,null,{default:s(()=>[t(F,null,{default:s(()=>e[121]||(e[121]=[i("span",{class:"text-h6"},"Send Order Message",-1)])),_:1,__:[121]}),t(w,null,{default:s(()=>[t(O,{modelValue:a(Y),"onUpdate:modelValue":e[35]||(e[35]=l=>x(Y)?Y.value=l:null),items:a(it),"item-title":"order_no","item-value":"id",label:"Select Orders",multiple:"",chips:"",disabled:a(A).orders,loading:a(A).orders,"return-object":""},null,8,["modelValue","items","disabled","loading"]),t(O,{modelValue:a(ge),"onUpdate:modelValue":e[36]||(e[36]=l=>x(ge)?ge.value=l:null),items:o.orderTemplates,"item-title":"name","item-value":"name",label:"Select Order Template",onChange:o.p,class:"mt-3","return-object":""},null,8,["modelValue","items","onChange"]),t(De,{modelValue:a(ve),"onUpdate:modelValue":e[37]||(e[37]=l=>x(ve)?ve.value=l:null),label:"Message",rows:"4","auto-grow":"",class:"mt-3"},null,8,["modelValue"])]),_:1}),t(h,null,{default:s(()=>[t(W),t(f,{color:"success",loading:a(A).sending,onClick:Ne},{default:s(()=>e[122]||(e[122]=[r(" Send ")])),_:1,__:[122]},8,["loading"]),t(f,{text:"",onClick:e[38]||(e[38]=l=>ee.value=!1)},{default:s(()=>e[123]||(e[123]=[r("Cancel")])),_:1,__:[123]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(R,{modelValue:a(q),"onUpdate:modelValue":e[42]||(e[42]=l=>x(q)?q.value=l:null),"max-width":"500"},{default:s(()=>[t(M,null,{default:s(()=>[t(F,null,{default:s(()=>e[124]||(e[124]=[i("span",{class:"text-h6"},"Import Contacts",-1)])),_:1,__:[124]}),t(w,null,{default:s(()=>[t(ze,{modelValue:a(_e),"onUpdate:modelValue":e[40]||(e[40]=l=>x(_e)?_e.value=l:null),label:"Select CSV File",accept:".csv","prepend-icon":"mdi-file"},null,8,["modelValue"])]),_:1}),t(h,null,{default:s(()=>[t(W),t(f,{color:"info",loading:a(A).importing,onClick:ut},{default:s(()=>e[125]||(e[125]=[r(" Import ")])),_:1,__:[125]},8,["loading"]),t(f,{text:"",onClick:e[41]||(e[41]=l=>q.value=!1)},{default:s(()=>e[126]||(e[126]=[r("Cancel")])),_:1,__:[126]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(R,{modelValue:a(J),"onUpdate:modelValue":e[45]||(e[45]=l=>x(J)?J.value=l:null),"max-width":"500"},{default:s(()=>[t(M,null,{default:s(()=>[t(F,null,{default:s(()=>e[127]||(e[127]=[i("span",{class:"text-h6"},"Import Orders",-1)])),_:1,__:[127]}),t(w,null,{default:s(()=>[t(ze,{modelValue:a(ye),"onUpdate:modelValue":e[43]||(e[43]=l=>x(ye)?ye.value=l:null),label:"Select Excel or CSV File",accept:".csv,.xlsx,.xls","prepend-icon":"mdi-file"},null,8,["modelValue"])]),_:1}),t(h,null,{default:s(()=>[t(W),t(f,{color:"orange",loading:a(A).uploadingOrders,onClick:mt},{default:s(()=>e[128]||(e[128]=[r(" Import ")])),_:1,__:[128]},8,["loading"]),t(f,{text:"",onClick:e[44]||(e[44]=l=>J.value=!1)},{default:s(()=>e[129]||(e[129]=[r("Cancel")])),_:1,__:[129]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(R,{modelValue:me.value,"onUpdate:modelValue":e[57]||(e[57]=l=>me.value=l),"max-width":"800",persistent:""},{default:s(()=>[t(M,{class:"conversation-dialog"},{default:s(()=>[t(F,{class:"conversation-header pa-4"},{default:s(()=>[i("div",Fl,[t(V,{color:"primary",size:"40",class:"mr-3"},{default:s(()=>[t(d,{color:"white"},{default:s(()=>e[130]||(e[130]=[r("mdi-account")])),_:1,__:[130]})]),_:1}),i("div",Ml,[i("div",Ul,m(Re()),1),i("div",$l,m(xt()),1)]),t(D,{color:wt(),small:"",outlined:"",class:"mr-2"},{default:s(()=>[r(m(Vt()),1)]),_:1},8,["color"]),t(f,{icon:"",onClick:e[46]||(e[46]=l=>me.value=!1)},{default:s(()=>[t(d,null,{default:s(()=>e[131]||(e[131]=[r("mdi-close")])),_:1,__:[131]})]),_:1})])]),_:1}),t($),t(w,{class:"pa-0"},{default:s(()=>[a(A).value?(g(),k(oe,{key:0,indeterminate:"",color:"primary"})):(g(),_("div",Pl,[Array.isArray(pe.value)&&pe.value.length?(g(),_("div",Tl,[(g(!0),_(ne,null,ie(pe.value,l=>(g(),_("div",{key:l.id,class:Je(["message-wrapper mb-3",o.getMessageAlignment(l)])},[i("div",{class:Je(["message-bubble elevation-1",o.getMessageBubbleClass(l)])},[o.isIncomingMessage(l)?(g(),_("div",Nl,m(l.sender_name||Re()),1)):b("",!0),i("div",Rl,m(l.content),1),l.image_url?(g(),_("div",Il,[t(je,{src:l.image_url,"max-height":"200","max-width":"300",contain:"",class:"rounded",onClick:p=>o.openImagePreview(l.image_url),style:{cursor:"pointer"}},null,8,["src","onClick"])])):b("",!0),l.audio_url?(g(),_("div",zl,[i("div",jl,[t(f,{icon:"",small:"",onClick:p=>o.toggleAudio(l.id),class:"mr-2"},{default:s(()=>[t(d,null,{default:s(()=>{var p;return[r(m((p=o.audioStates[l.id])!=null&&p.playing?"mdi-pause":"mdi-play"),1)]}),_:2},1024)]),_:2},1032,["onClick"]),i("audio",{ref_for:!0,ref:`audio-${l.id}`,src:l.audio_url,onEnded:p=>o.onAudioEnded(l.id),style:{display:"none"}},null,40,El),e[132]||(e[132]=i("span",{class:"text-caption"},"Voice message",-1))])])):b("",!0),i("div",Wl,[i("span",Bl,m(o.formatTimestamp(l.created_at||l.timestamp)),1),o.isOutgoingMessage(l)?(g(),k(d,{key:0,color:o.getStatusIconColor(l.message_status),size:"14"},{default:s(()=>[r(m(o.getStatusIcon(l.message_status)),1)]),_:2},1032,["color"])):b("",!0)])],2)],2))),128))])):(g(),_("div",Kl,[t(d,{size:"64",color:"grey lighten-2"},{default:s(()=>e[133]||(e[133]=[r("mdi-message-outline")])),_:1,__:[133]}),e[134]||(e[134]=i("div",{class:"text-h6 mt-4 text-grey"},"No messages yet",-1)),e[135]||(e[135]=i("div",{class:"text-caption text-grey"},"Start the conversation below",-1))]))],512))]),_:1}),t($),t(w,{class:"reply-section pa-4"},{default:s(()=>[o.hasAttachment?(g(),_("div",Ll,[a(U).image&&a(U).image.length?(g(),k(D,{key:0,close:"","onClick:close":e[47]||(e[47]=l=>a(U).image=null),color:"blue lighten-4",class:"mr-2"},{default:s(()=>{var l;return[t(d,{left:"",small:""},{default:s(()=>e[136]||(e[136]=[r("mdi-image")])),_:1,__:[136]}),r(" "+m((l=a(U).image[0])==null?void 0:l.name),1)]}),_:1})):b("",!0),a(U).audio&&a(U).audio.length?(g(),k(D,{key:1,close:"","onClick:close":e[48]||(e[48]=l=>a(U).audio=null),color:"green lighten-4"},{default:s(()=>{var l;return[t(d,{left:"",small:""},{default:s(()=>e[137]||(e[137]=[r("mdi-microphone")])),_:1,__:[137]}),r(" "+m((l=a(U).audio[0])==null?void 0:l.name),1)]}),_:1})):b("",!0)])):b("",!0),i("div",Hl,[t(De,{modelValue:a(Z),"onUpdate:modelValue":e[49]||(e[49]=l=>x(Z)?Z.value=l:null),label:"Type your message...",rows:"2","auto-grow":"",outlined:"",dense:"","hide-details":"",class:"message-input",onKeydown:[ae(Qe(ke,["exact","prevent"]),["enter"]),ae(Qe(o.addNewLine,["shift","exact"]),["enter"])]},null,8,["modelValue","onKeydown"]),i("div",Zl,[i("div",ql,[t(f,{icon:"",small:"",onClick:e[50]||(e[50]=l=>o.showEmojiPicker=!o.showEmojiPicker),class:"mr-2"},{default:s(()=>[t(d,null,{default:s(()=>e[138]||(e[138]=[r("mdi-emoticon-happy-outline")])),_:1,__:[138]})]),_:1}),t(Ie,{"offset-y":""},{activator:s(({on:l,attrs:p})=>[t(f,qe({icon:"",small:""},p,Bt(l),{class:"mr-2"}),{default:s(()=>[t(d,null,{default:s(()=>e[139]||(e[139]=[r("mdi-attachment")])),_:1,__:[139]})]),_:2},1040)]),default:s(()=>[t(Rt,{dense:""},{default:s(()=>[t(Ke,{onClick:e[51]||(e[51]=l=>o.$refs.imageInput.click())},{default:s(()=>[t(Ee,null,{default:s(()=>[t(d,null,{default:s(()=>e[140]||(e[140]=[r("mdi-image")])),_:1,__:[140]})]),_:1}),t(Be,null,{default:s(()=>[t(We,null,{default:s(()=>e[141]||(e[141]=[r("Image")])),_:1,__:[141]})]),_:1})]),_:1}),t(Ke,{onClick:e[52]||(e[52]=l=>o.$refs.audioInput.click())},{default:s(()=>[t(Ee,null,{default:s(()=>[t(d,null,{default:s(()=>e[142]||(e[142]=[r("mdi-microphone")])),_:1,__:[142]})]),_:1}),t(Be,null,{default:s(()=>[t(We,null,{default:s(()=>e[143]||(e[143]=[r("Voice Note")])),_:1,__:[143]})]),_:1})]),_:1})]),_:1})]),_:1}),i("input",{ref:"imageInput",type:"file",accept:"image/*",onChange:e[53]||(e[53]=(...l)=>o.handleImageUpload&&o.handleImageUpload(...l)),style:{display:"none"}},null,544),i("input",{ref:"audioInput",type:"file",accept:"audio/*",onChange:e[54]||(e[54]=(...l)=>o.handleAudioUpload&&o.handleAudioUpload(...l)),style:{display:"none"}},null,544),a(Z).length>0?(g(),_("span",Jl,m(a(Z).length),1)):b("",!0)]),t(f,{color:"primary",disabled:!o.canSendMessage,onClick:ke,class:"ml-2",loading:o.sending},{default:s(()=>[t(d,null,{default:s(()=>e[144]||(e[144]=[r("mdi-send")])),_:1,__:[144]})]),_:1},8,["disabled","loading"])]),t(It,null,{default:s(()=>[o.showEmojiPicker?(g(),_("div",Ql,[i("div",hl,[(g(!0),_(ne,null,ie(o.commonEmojis,l=>(g(),k(f,{key:l,text:"","x-small":"",onClick:p=>o.appendEmoji(l),class:"emoji-btn"},{default:s(()=>[r(m(l),1)]),_:2},1032,["onClick"]))),128))])])):b("",!0)]),_:1})])]),_:1})]),_:1}),t(R,{modelValue:o.imagePreviewDialog,"onUpdate:modelValue":e[56]||(e[56]=l=>o.imagePreviewDialog=l),"max-width":"90vw"},{default:s(()=>[t(M,null,{default:s(()=>[t(F,{class:"pa-2"},{default:s(()=>[t(W),t(f,{icon:"",onClick:e[55]||(e[55]=l=>o.imagePreviewDialog=!1)},{default:s(()=>[t(d,null,{default:s(()=>e[145]||(e[145]=[r("mdi-close")])),_:1,__:[145]})]),_:1})]),_:1}),t(w,{class:"pa-2"},{default:s(()=>[t(je,{src:o.previewImageUrl,contain:"","max-height":"80vh"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),t(ht,{modelValue:re.value,"onUpdate:modelValue":e[58]||(e[58]=l=>re.value=l),mode:Ae.value,"selected-orders":a(Y),onConfirmed:Ge},null,8,["modelValue","mode","selected-orders"]),t(qt),t(Qt),t(Gt)]),_:1})]),_:1})}}},ws=Yt(Xl,[["__scopeId","data-v-8f8e0bfa"]]);export{ws as default};
