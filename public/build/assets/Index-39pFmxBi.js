import{E as pe,r as _,j as T,i as I,s as ye,k as be,l as v,c as ee,o as O,w as l,b as t,a as n,u as N,f as m,t as f,d as te,y as he,e as we}from"./app-Dg-fYXBZ.js";import{_ as ge}from"./AppLayout-CmKRvzLd.js";import{n as x}from"./toast-BZzp40fx.js";import{u as xe}from"./countries-Vqnd32Ek.js";import{u as Ve}from"./orderStore-CRt-aP3D.js";import{_ as Ce}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-D804O0gE.js";import"./africastalking-BpeGDWPg.js";import"./IncomingCallDialog-DuCaq-1Z.js";/* empty css                                                                           */const We=pe("warehouse",()=>{const y=_([]),c=_(!1),p=_(null),W=T(()=>i=>y.value.find(u=>u.id===i)),k=T(()=>y.value.length);async function S(){c.value=!0;try{const{data:i}=await I.get("/api/v1/warehouses");return y.value=i,i}catch(i){throw x.error("Failed to load warehouses"),console.error("Error fetching warehouses:",i),i}finally{c.value=!1}}async function V(i){c.value=!0;try{const{data:u}=await I.get(`/api/v1/warehouses/${i}`);return p.value=u,u}catch(u){throw x.error("Failed to load warehouse"),console.error("Error fetching warehouse:",u),u}finally{c.value=!1}}async function C(i){c.value=!0;try{const{data:u}=await I.post("/api/v1/warehouses",i);return y.value.push(u),x.success("Warehouse created successfully"),u}catch(u){throw x.error("Failed to create warehouse"),console.error("Error creating warehouse:",u),u}finally{c.value=!1}}async function U(i,u){var d;c.value=!0;try{const{data:b}=await I.put(`/api/v1/warehouses/${i}`,u),B=y.value.findIndex(M=>M.id===i);return B!==-1&&(y.value[B]=b),((d=p.value)==null?void 0:d.id)===i&&(p.value=b),x.success("Warehouse updated successfully"),b}catch(b){throw x.error("Failed to update warehouse"),console.error("Error updating warehouse:",b),b}finally{c.value=!1}}async function D(i){var u;c.value=!0;try{await I.delete(`/api/v1/warehouses/${i}`),y.value=y.value.filter(d=>d.id!==i),((u=p.value)==null?void 0:u.id)===i&&(p.value=null),x.success("Warehouse deleted successfully")}catch(d){throw x.error("Failed to delete warehouse"),console.error("Error deleting warehouse:",d),d}finally{c.value=!1}}function r(i){p.value=i}function z(){p.value=null}function w(){y.value=[],c.value=!1,p.value=null}return{warehouses:y,loading:c,currentWarehouse:p,getWarehouseById:W,warehousesCount:k,fetchWarehouses:S,fetchWarehouse:V,createWarehouse:C,updateWarehouse:U,deleteWarehouse:D,setCurrentWarehouse:r,clearCurrentWarehouse:z,$reset:w}}),ke={class:"d-flex align-center"},Ue={class:"font-weight-medium"},De={class:"text-caption text-medium-emphasis"},Ne={class:"font-weight-medium"},Se={class:"text-caption text-medium-emphasis"},ze={key:0},Fe={class:"font-weight-medium"},Ee={class:"text-caption text-medium-emphasis"},Le={key:1,class:"text-caption text-medium-emphasis"},$e={class:"d-flex gap-1"},Ie={class:"text-center py-8"},Be={class:"text-h5"},Me={class:"text-h6 mb-2"},Pe={__name:"Index",setup(y){const c=We(),p=xe(),W=Ve(),k=_(!1),S=_(null),V=_(null),C=_(!1),U=_(!1),D=_(!1),r=_({name:"",location:"",country_id:null,city_id:null,zone_id:null,contact_person:"",phone:""}),z=_(!1),w=_(null),i=_(null),u=_(null),d=_({search:"",country:"",city:""}),b=_(null),B=[{title:"Warehouse",value:"name",sortable:!0},{title:"Location",value:"location",sortable:!0},{title:"Contact",value:"contact",sortable:!1},{title:"Country",value:"country",sortable:!0},{title:"Actions",value:"actions",sortable:!1,width:"150px"}],M={required:a=>!!a||"This field is required"},j=T(()=>w.value!==null),Q=T(()=>{let a=c.warehouses;if(d.value.search){const e=d.value.search.toLowerCase();a=a.filter(s=>s.name&&s.name.toLowerCase().includes(e)||s.location&&s.location.toLowerCase().includes(e)||s.contact_person&&s.contact_person.toLowerCase().includes(e))}return d.value.country&&(a=a.filter(e=>e.country_id===d.value.country)),d.value.city&&(a=a.filter(e=>e.city_id===d.value.city)),a});async function le(){if(b.value.validate()){k.value=!0;try{j.value?(S.value=w.value,await c.updateWarehouse(w.value,r.value)):await c.createWarehouse(r.value),R()}catch{}finally{k.value=!1,S.value=null}}}async function oe(){V.value=i.value.id;try{await c.deleteWarehouse(i.value.id),X()}catch{}finally{V.value=null}}function ae(){Z(),w.value=null,C.value=!0}function ne(a){Z(),r.value={name:a.name||"",location:a.location||"",country_id:a.country_id,city_id:a.city_id,zone_id:a.zone_id,contact_person:a.contact_person||"",phone:a.phone||""},w.value=a.id,a.country_id&&W.fetchCities(a.country_id),C.value=!0}function ue(a){u.value=a,U.value=!0}function ie(a){i.value=a,D.value=!0}function R(){C.value=!1,Z(),w.value=null}function X(){D.value=!1,i.value=null}function Z(){r.value={name:"",location:"",country_id:null,city_id:null,zone_id:null,contact_person:"",phone:""},b.value&&b.value.resetValidation()}function se(){r.value.city_id=null,r.value.country_id}function Y(a){return a?new Date(a).toLocaleDateString():"Not available"}return ye(()=>d.value.country,a=>{d.value.city="",a?locationStore.fetchCities(a):locationStore.clearCities()}),be(async()=>{await Promise.all([c.fetchWarehouses(),p.fetchCountries(),W.fetchDropdownOptions()])}),(a,e)=>{const s=v("v-col"),h=v("v-btn"),P=v("v-row"),F=v("v-icon"),E=v("v-card-title"),L=v("v-text-field"),q=v("v-autocomplete"),A=v("v-card-text"),$=v("v-card"),re=v("v-divider"),de=v("v-chip"),ce=v("v-skeleton-loader"),ve=v("v-data-table"),me=v("v-select"),G=v("v-container"),H=v("v-spacer"),J=v("v-card-actions"),fe=v("v-form"),K=v("v-dialog"),_e=v("v-alert");return O(),ee(ge,null,{default:l(()=>[t(G,null,{default:l(()=>[t(P,{class:"mb-4 align-center"},{default:l(()=>[t(s,null,{default:l(()=>e[15]||(e[15]=[n("h2",{class:"text-h4"},"Warehouse Management",-1)])),_:1,__:[15]}),t(s,{cols:"auto"},{default:l(()=>[t(h,{color:"primary","prepend-icon":"mdi-plus",onClick:ae,loading:N(c).loading},{default:l(()=>e[16]||(e[16]=[m(" Create Warehouse ")])),_:1,__:[16]},8,["loading"])]),_:1})]),_:1}),t($,{class:"mb-4",variant:"outlined"},{default:l(()=>[t(E,{class:"text-subtitle-1 pb-2"},{default:l(()=>[t(F,{left:""},{default:l(()=>e[17]||(e[17]=[m("mdi-filter")])),_:1,__:[17]}),e[18]||(e[18]=m(" Search & Filter "))]),_:1,__:[18]}),t(A,null,{default:l(()=>[t(P,null,{default:l(()=>[t(s,{cols:"12",md:"4"},{default:l(()=>[t(L,{modelValue:d.value.search,"onUpdate:modelValue":e[0]||(e[0]=o=>d.value.search=o),label:"Search warehouses...","prepend-inner-icon":"mdi-magnify",variant:"outlined",density:"compact",clearable:"",hint:"Search by warehouse name or location","persistent-hint":""},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",md:"4"},{default:l(()=>[t(q,{modelValue:d.value.country,"onUpdate:modelValue":e[1]||(e[1]=o=>d.value.country=o),label:"Country",items:N(p).countries,"item-title":"name","item-value":"id",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue","items"])]),_:1}),t(s,{cols:"12",md:"4"},{default:l(()=>[t(q,{modelValue:d.value.city,"onUpdate:modelValue":e[2]||(e[2]=o=>d.value.city=o),label:"City",items:a.cities,"item-title":"name","item-value":"id",variant:"outlined",density:"compact",clearable:"",disabled:!d.value.country},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})]),_:1})]),_:1}),t($,null,{default:l(()=>[t(E,{class:"text-subtitle-1"},{default:l(()=>[t(F,{left:""},{default:l(()=>e[19]||(e[19]=[m("mdi-warehouse")])),_:1,__:[19]}),m(" All Warehouses ("+f(Q.value.length)+") ",1)]),_:1}),t(re),t(ve,{headers:B,items:Q.value,loading:N(c).loading,"item-value":"id",class:"elevation-0","items-per-page":25},{"item.name":l(({item:o})=>[n("div",ke,[t(F,{icon:"mdi-warehouse",color:"primary",class:"mr-2",size:"small"}),n("div",null,[n("div",Ue,f(o.name||"Unnamed Warehouse"),1),n("div",De," ID: "+f(o.id),1)])])]),"item.location":l(({item:o})=>{var g;return[n("div",null,[n("div",Ne,f(o.location||"No location specified"),1),n("div",Se,f(((g=o.country)==null?void 0:g.name)||"Unknown Country"),1)])]}),"item.contact":l(({item:o})=>[o.contact_person||o.phone?(O(),te("div",ze,[n("div",Fe,f(o.contact_person||"No contact person"),1),n("div",Ee,f(o.phone||"No phone"),1)])):(O(),te("span",Le,"No contact info"))]),"item.country":l(({item:o})=>[t(de,{color:"info",size:"small",variant:"outlined"},{default:l(()=>{var g;return[m(f(((g=o.country)==null?void 0:g.name)||"Unknown"),1)]}),_:2},1024)]),"item.actions":l(({item:o})=>[n("div",$e,[t(h,{icon:"mdi-eye",size:"small",variant:"text",color:"info",onClick:g=>ue(o)},null,8,["onClick"]),t(h,{icon:"mdi-pencil",size:"small",variant:"text",color:"primary",onClick:g=>ne(o),loading:S.value===o.id},null,8,["onClick","loading"]),t(h,{icon:"mdi-delete",size:"small",variant:"text",color:"error",onClick:g=>ie(o),loading:V.value===o.id},null,8,["onClick","loading"])])]),loading:l(()=>[t(ce,{type:"table-row@10"})]),"no-data":l(()=>[n("div",Ie,[t(F,{size:"64",color:"grey-lighten-1"},{default:l(()=>e[20]||(e[20]=[m("mdi-warehouse-off")])),_:1,__:[20]}),e[21]||(e[21]=n("div",{class:"text-h6 mt-4"},"No warehouses found",-1)),e[22]||(e[22]=n("div",{class:"text-caption"}," Create your first warehouse to get started ",-1))])]),_:1},8,["items","loading"])]),_:1}),t(K,{modelValue:C.value,"onUpdate:modelValue":e[11]||(e[11]=o=>C.value=o),"max-width":"800px",persistent:""},{default:l(()=>[t($,null,{default:l(()=>[t(E,null,{default:l(()=>[n("span",Be,f(j.value?"Edit Warehouse":"Create New Warehouse"),1)]),_:1}),t(fe,{ref_key:"warehouseForm",ref:b,modelValue:z.value,"onUpdate:modelValue":e[10]||(e[10]=o=>z.value=o),onSubmit:he(le,["prevent"])},{default:l(()=>[t(A,null,{default:l(()=>[t(G,null,{default:l(()=>[t(P,null,{default:l(()=>[t(s,{cols:"12",md:"6"},{default:l(()=>[t(L,{modelValue:r.value.name,"onUpdate:modelValue":e[3]||(e[3]=o=>r.value.name=o),label:"Warehouse Name *",rules:[M.required],variant:"outlined",density:"comfortable",placeholder:"e.g., Main Warehouse, Storage Unit A"},null,8,["modelValue","rules"])]),_:1}),t(s,{cols:"12",md:"6"},{default:l(()=>[t(L,{modelValue:r.value.location,"onUpdate:modelValue":e[4]||(e[4]=o=>r.value.location=o),label:"Location",variant:"outlined",density:"comfortable",placeholder:"Street address or area"},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",md:"6"},{default:l(()=>[t(q,{modelValue:r.value.country_id,"onUpdate:modelValue":[e[5]||(e[5]=o=>r.value.country_id=o),se],label:"Country *",items:N(p).countries,"item-title":"name","item-value":"id",rules:[M.required],variant:"outlined",density:"comfortable"},null,8,["modelValue","items","rules","onUpdate:modelValue"])]),_:1}),t(s,{cols:"12",md:"6"},{default:l(()=>[t(q,{modelValue:r.value.city_id,"onUpdate:modelValue":e[6]||(e[6]=o=>r.value.city_id=o),label:"City",items:N(W).cityOptions,"item-title":"name","item-value":"id",variant:"outlined",density:"comfortable",disabled:!r.value.country_id},null,8,["modelValue","items","disabled"])]),_:1}),t(s,{cols:"12",md:"6"},{default:l(()=>[t(L,{modelValue:r.value.contact_person,"onUpdate:modelValue":e[7]||(e[7]=o=>r.value.contact_person=o),label:"Contact Person",variant:"outlined",density:"comfortable",placeholder:"Manager or responsible person"},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",md:"6"},{default:l(()=>[t(L,{modelValue:r.value.phone,"onUpdate:modelValue":e[8]||(e[8]=o=>r.value.phone=o),label:"Phone Number",variant:"outlined",density:"comfortable",placeholder:"+1234567890"},null,8,["modelValue"])]),_:1}),t(s,{cols:"12",md:"6"},{default:l(()=>[t(me,{modelValue:r.value.zone_id,"onUpdate:modelValue":e[9]||(e[9]=o=>r.value.zone_id=o),label:"Zone",items:N(W).zoneOptions,"item-title":"name","item-value":"id",variant:"outlined",density:"comfortable",clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),_:1})]),_:1}),t(J,null,{default:l(()=>[t(H),t(h,{variant:"text",onClick:R,disabled:k.value},{default:l(()=>e[23]||(e[23]=[m(" Cancel ")])),_:1,__:[23]},8,["disabled"]),t(h,{color:"primary",variant:"flat",type:"submit",loading:k.value,disabled:!z.value},{default:l(()=>[m(f(j.value?"Update":"Create"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["modelValue"]),t(K,{modelValue:U.value,"onUpdate:modelValue":e[13]||(e[13]=o=>U.value=o),"max-width":"600px"},{default:l(()=>[u.value?(O(),ee($,{key:0},{default:l(()=>[t(E,null,{default:l(()=>[t(F,{left:""},{default:l(()=>e[24]||(e[24]=[m("mdi-warehouse")])),_:1,__:[24]}),e[25]||(e[25]=m(" Warehouse Details "))]),_:1,__:[25]}),t(A,null,{default:l(()=>[t(G,null,{default:l(()=>[t(P,null,{default:l(()=>[t(s,{cols:"12"},{default:l(()=>[n("div",Me,f(u.value.name||"Unnamed Warehouse"),1)]),_:1}),t(s,{cols:"12",md:"6"},{default:l(()=>[e[26]||(e[26]=n("div",{class:"text-subtitle-2 mb-1"}," Location ",-1)),n("div",null,f(u.value.location||"Not specified"),1)]),_:1,__:[26]}),t(s,{cols:"12",md:"6"},{default:l(()=>{var o;return[e[27]||(e[27]=n("div",{class:"text-subtitle-2 mb-1"}," Country ",-1)),n("div",null,f(((o=u.value.country)==null?void 0:o.name)||"Unknown"),1)]}),_:1,__:[27]}),t(s,{cols:"12",md:"6"},{default:l(()=>[e[28]||(e[28]=n("div",{class:"text-subtitle-2 mb-1"}," Contact Person ",-1)),n("div",null,f(u.value.contact_person||"Not specified"),1)]),_:1,__:[28]}),t(s,{cols:"12",md:"6"},{default:l(()=>[e[29]||(e[29]=n("div",{class:"text-subtitle-2 mb-1"}," Phone ",-1)),n("div",null,f(u.value.phone||"Not specified"),1)]),_:1,__:[29]}),t(s,{cols:"12",md:"6"},{default:l(()=>[e[30]||(e[30]=n("div",{class:"text-subtitle-2 mb-1"}," Created ",-1)),n("div",null,f(Y(u.value.created_at)),1)]),_:1,__:[30]}),t(s,{cols:"12",md:"6"},{default:l(()=>[e[31]||(e[31]=n("div",{class:"text-subtitle-2 mb-1"}," Updated ",-1)),n("div",null,f(Y(u.value.updated_at)),1)]),_:1,__:[31]})]),_:1})]),_:1})]),_:1}),t(J,null,{default:l(()=>[t(H),t(h,{variant:"text",onClick:e[12]||(e[12]=o=>U.value=!1)},{default:l(()=>e[32]||(e[32]=[m("Close")])),_:1,__:[32]})]),_:1})]),_:1})):we("",!0)]),_:1},8,["modelValue"]),t(K,{modelValue:D.value,"onUpdate:modelValue":e[14]||(e[14]=o=>D.value=o),"max-width":"400px"},{default:l(()=>[t($,null,{default:l(()=>[t(E,{class:"text-h5"},{default:l(()=>e[33]||(e[33]=[m(" Confirm Delete ")])),_:1,__:[33]}),t(A,null,{default:l(()=>{var o;return[e[35]||(e[35]=m(" Are you sure you want to delete the warehouse ")),n("strong",null,'"'+f(((o=i.value)==null?void 0:o.name)||"Unnamed Warehouse")+'"',1),e[36]||(e[36]=m("? ")),e[37]||(e[37]=n("br",null,null,-1)),e[38]||(e[38]=n("br",null,null,-1)),t(_e,{color:"warning",variant:"outlined",class:"mt-3"},{default:l(()=>e[34]||(e[34]=[m(" This action cannot be undone and may affect related inventory and operations. ")])),_:1,__:[34]})]}),_:1,__:[35,36,37,38]}),t(J,null,{default:l(()=>[t(H),t(h,{variant:"text",onClick:X,disabled:V.value},{default:l(()=>e[39]||(e[39]=[m(" Cancel ")])),_:1,__:[39]},8,["disabled"]),t(h,{color:"error",variant:"flat",onClick:oe,loading:V.value},{default:l(()=>e[40]||(e[40]=[m(" Delete ")])),_:1,__:[40]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})}}},Qe=Ce(Pe,[["__scopeId","data-v-540fcbb6"]]);export{Qe as default};
