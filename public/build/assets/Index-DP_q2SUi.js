import{r as v,s as X,j as w,l as S,d,o as i,a as e,b as u,f as b,e as O,t as a,n as Y,w as M,m as Ne,k as He,c as Ie,A as J,u as o,B as $e,D as Ce,F as N,g as H,V as qe}from"./app-DKtCYWsK.js";import{_ as We}from"./AppLayout-YX55DJjy.js";import{u as Ye,W as Ge}from"./WhatsAppConversation-DauU_BRV.js";import{u as Ze}from"./orderStore-k6NurleN.js";import"./africastalking-BioIFWvx.js";import{u as Ke,C as Je}from"./CallCentreDialler-DNckdviz.js";import{u as Qe,S as Xe}from"./Stkpush-rLXiUmqp.js";import et from"./OrderForm-Boq9x_gd.js";import tt from"./BulkAction-D3OQD_wT.js";import st from"./CallDialogs-P4yZGy6k.js";import{_ as lt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-wVmVv9r6.js";import"./IncomingCallDialog-N4ySD-C9.js";/* empty css                                                                           */import"./toast-_pmn7IkJ.js";import"./whatsappStore-f9v-YCXC.js";import"./auth-CX1IZxt0.js";/* empty css                                                                             */import"./callCenter-C1q2mpO2.js";import"./contact-C-r-oEkw.js";const ot={key:0,class:"text-red-600 ml-1"},nt={__name:"DualDatePicker",props:{modelValue:{type:Array,default:()=>[]},label:String,required:{type:Boolean,default:!1},placeholder:{type:String,default:"Select date range"},validateOnMount:{type:Boolean,default:!1}},emits:["update:modelValue","validation"],setup(T,{expose:s,emit:G}){var $;const x=T,A=G,C=v(!1),D=v(x.validateOnMount),m=v(($=x.modelValue)!=null&&$.length?[...x.modelValue]:[]);X(()=>x.modelValue,g=>{Array.isArray(g)?m.value=g.length?[...g]:[]:m.value=[]});const P=w(()=>x.required?Array.isArray(m.value)&&m.value.length===2:!0),U=w(()=>x.required&&D.value&&!P.value),Z=w(()=>U.value?!m.value||m.value.length===0?"Date range is required":m.value.length===1?"Please select an end date":"":""),K=w(()=>x.required&&!P.value&&D.value?"text-red-600":"text-gray-700"),r=w(()=>{if(!Array.isArray(m.value)||m.value.length===0)return"";const p=[...m.value].sort((y,_)=>{const F=y instanceof Date?y:new Date(y),j=_ instanceof Date?_:new Date(_);return F-j}).map(y=>(y instanceof Date?y:new Date(y)).toLocaleDateString("en-US",{month:"short",day:"2-digit",default:"Select date range",year:"numeric"})),[k,R]=p;return k&&R?`${k} → ${R}`:k?`${k} → ...`:""}),f=g=>{D.value=!0;let p=[];Array.isArray(g)?p=g:g instanceof Date?p=[g]:g&&(p=[g]),m.value=p,A("update:modelValue",p);const k=x.required?p.length===2:!0;A("validation",k),p.length>=2&&setTimeout(()=>{C.value=!1},300)},I=()=>{m.value=[],A("update:modelValue",[]),A("validation",!x.required)};return X(C,g=>{!g&&!D.value&&(D.value=!0)}),s({validate:()=>(D.value=!0,P.value),isValid:P}),(g,p)=>{const k=S("v-text-field"),R=S("v-date-picker"),y=S("v-spacer"),_=S("v-btn"),F=S("v-card-actions"),j=S("v-card"),L=S("v-menu");return i(),d("div",null,[e("label",{class:Y(["block text-sm font-medium mb-1",K.value])},[b(a(T.label)+" ",1),T.required?(i(),d("span",ot,"*")):O("",!0)],2),u(L,{modelValue:C.value,"onUpdate:modelValue":p[2]||(p[2]=V=>C.value=V),"close-on-content-click":!1,transition:"scale-transition",location:"bottom","max-width":"auto","min-width":"600px"},{activator:M(({props:V})=>[u(k,Ne(V,{"model-value":r.value,"prepend-inner-icon":"mdi-calendar",readonly:"",density:"compact",variant:"outlined",error:U.value,"error-messages":Z.value,"hide-details":!U.value,placeholder:T.placeholder}),null,16,["model-value","error","error-messages","hide-details","placeholder"])]),default:M(()=>[u(j,null,{default:M(()=>[u(R,{modelValue:m.value,"onUpdate:modelValue":[p[0]||(p[0]=V=>m.value=V),f],multiple:2,"show-adjacent-months":"",color:"primary"},null,8,["modelValue"]),u(F,null,{default:M(()=>[u(y),u(_,{text:"",onClick:I},{default:M(()=>p[3]||(p[3]=[b("Clear")])),_:1,__:[3]}),u(_,{text:"",color:"primary",onClick:p[1]||(p[1]=V=>C.value=!1)},{default:M(()=>p[4]||(p[4]=[b("Close")])),_:1,__:[4]})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}},Q=lt(nt,[["__scopeId","data-v-f6d058c5"]]),at={class:"min-h-screen bg-gray-50"},rt={class:"p-6"},it={class:"mb-6"},dt={class:"relative"},ut={class:"bg-white p-4 rounded-lg shadow-sm mb-6"},pt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4 mb-4"},mt={class:"flex justify-center gap-4"},ct=["disabled"],gt={key:0,class:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"},vt={key:1,class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},xt={key:0,class:"mt-4 flex items-center gap-2 text-sm text-gray-600"},ht={class:"flex justify-between items-center mb-4"},bt={class:"flex items-center gap-2"},ft={class:"text-sm text-gray-500"},yt={class:"flex gap-2 flex-wrap"},kt=["disabled"],wt=["disabled"],_t=["disabled"],Ct=["disabled"],Dt=["disabled"],Vt=["disabled"],St={key:0,class:"bg-white rounded-lg shadow-sm p-8 text-center"},At={key:1,class:"bg-white rounded-lg shadow-sm p-8 text-center"},Ot={class:"text-gray-600 mb-4"},Mt={key:2,class:"bg-white rounded-lg shadow-sm overflow-hidden"},Pt={class:"overflow-x-auto"},Rt={class:"w-full"},Ft={class:"bg-blue-600 text-white"},Et={class:"px-4 py-3 text-left"},Bt={key:0},Tt={class:"px-4 py-3"},Ut=["value"],jt={class:"px-4 py-3 font-mono text-sm"},Lt={class:"px-4 py-3 font-mono text-sm"},zt={class:"px-4 py-3 text-sm"},Nt={class:"px-4 py-3"},Ht={class:"px-2 py-1 bg-orange-100 text-orange-800 rounded text-xs"},It={class:"px-4 py-3"},$t={class:"text-sm"},qt={class:"text-gray-500"},Wt={class:"px-4 py-3"},Yt={class:"inline-flex items-center gap-1 px-2 py-1 bg-red-100 text-red-800 rounded text-xs"},Gt={class:"mt-1"},Zt={class:"px-4 py-3 text-sm"},Kt={class:"text-gray-500 truncate max-w-32"},Jt={class:"px-4 py-3 text-sm"},Qt={class:"px-4 py-3 font-mono text-sm"},Xt={class:"px-4 py-3"},es={key:0,class:"text-xs text-green-600 font-semibold text-center"},ts=["src","alt"],ss={key:1,class:"text-xs text-gray-500 italic text-center"},ls={class:"px-4 py-3"},os={key:0,class:"text-xs text-blue-600 font-semibold text-center"},ns=["src","alt"],as={key:1,class:"text-xs text-gray-500 italic text-center"},rs={class:"px-4 py-3"},is={class:"flex flex-col gap-1"},ds={key:0},us={class:"text-xs text-gray-700"},ps={key:1,class:"text-xs text-gray-600 bg-green-100 px-1 py-0.5 rounded"},ms={class:"px-4 py-3"},cs={class:"flex gap-1 flex-wrap"},gs=["onClick"],vs=["onClick"],xs=["onClick"],hs=["onClick"],bs=["onClick"],fs=["onClick"],ys=["onClick"],ks=["onClick"],ws={class:"flex justify-between items-center px-6 py-4 bg-gray-50"},_s={class:"flex items-center gap-4"},Cs={class:"text-sm text-gray-700"},Ds={class:"flex items-center gap-2"},Vs=["value","disabled"],Ss=["value"],As={class:"flex items-center gap-2"},Os=["disabled"],Ms=["onClick","disabled"],Ps=["disabled"],Rs={class:"fixed bottom-4 right-4 z-50 space-y-2"},Fs={class:"flex justify-between items-center"},Es={class:"text-sm"},Bs=["onClick"],sl={__name:"Index",setup(T){const s=Ze(),G=Ye(),x=Ke();Qe();const A=v(null);v(!1),v(!1);const C=v(""),D=v(!1),m=v("");v("");const P=(n,t)=>{console.log("Opening call dialog for phone number:",n),console.log("Order:",t),C.value=n||"",I.value=n,x.openDialog(n,t)},U=n=>{console.log("Call made:",n),m.value=null},Z=n=>{console.log("Call transferred:",n),m.value=null},K=n=>{console.log("Agent called:",n),m.value=null};v({show:!1,type:"",title:""});const r=v([]),f=v(!1),I=v("");v(""),v(""),w({get:()=>s.bulkActionDialog,set:n=>{n?s.bulkActionDialog=n:s.closeBulkActionDialog()}}),w(()=>s.dialogType),w(()=>s.dialogTitle),w(()=>s.loading.orders),s.bulkActionForm;const ee=w(()=>{const n=s.pagination.current_page,t=s.pagination.last_page,c=[],l=Math.max(1,n-2),E=Math.min(t,l+4);for(let B=l;B<=E;B++)c.push(B);return c}),$=n=>{s.openDialog(n)},g=async()=>{await s.fetchDropdownOptions(),s.openCreateDialog()},p=()=>{r.value.length!==0&&s.printOrders(r.value)},k=()=>{if(console.debug("Assign Delivery Person clicked",{selectedOrders:r.value}),r.value.length===0){console.warn("No orders selected for delivery assignment");return}s.openAssignDeliveryDialog(r.value),console.info("Opened assign delivery dialog for orders:",r.value)},R=()=>{L()},y=()=>{},_=async()=>{await s.applyFilters()},F=async()=>{s.clearAllFilters(),await s.applyFilters()},j=async()=>{await s.applyFilters()},L=async()=>{await s.fetchOrders({page:s.pagination.current_page})},V=()=>{f.value?r.value=s.orders.map(n=>n.id):r.value=[]},De=n=>{const t={year:"numeric",month:"short",day:"numeric"};return new Date(n).toLocaleDateString(void 0,t)},Ve=n=>{const t={year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"};return new Date(n).toLocaleString(void 0,t)},Se=n=>{switch(n){case 1:return"Confirmed";case 0:return"Pending";case 2:return"Cancelled";default:return"Unknown"}},Ae=n=>{const t=s.vendorOptions.find(c=>c.id===n);return t?t.name:"Unknown"},q=n=>te(n,"CallAgent"),W=n=>te(n,"Delivery Agent"),te=(n,t)=>{if(!n.assignments||n.assignments.length===0)return null;const c=n.assignments.find(l=>l.role===t);return c?c.user:null},Oe=n=>{s.openViewDialog(n.id)},Me=n=>{s.deleteOrder(n.id)},Pe=()=>{s.exportOrders()},Re=()=>{s.openBulkStatusDialog(r.value),L()},Fe=()=>{s.openDeleteDialog(r.value)},Ee=()=>{r.value.length!==0&&s.openAssignCallCentreDialog(r.value)},Be=async()=>{if(s.pagination.current_page>1){const n=s.buildFilterParams?s.buildFilterParams():{};await s.fetchOrders({...n,page:s.pagination.current_page-1,per_page:s.pagination.per_page}),f.value=!1,r.value=[]}},Te=async()=>{if(s.pagination.current_page<s.pagination.last_page){const n=s.buildFilterParams?s.buildFilterParams():{};await s.fetchOrders({...n,page:s.pagination.current_page+1,per_page:s.pagination.per_page}),f.value=!1,r.value=[]}},Ue=async n=>{if(n!==s.pagination.current_page){const t=s.buildFilterParams?s.buildFilterParams():{};await s.fetchOrders({...t,page:n,per_page:s.pagination.per_page}),f.value=!1,r.value=[]}},je=async n=>{await s.changePerPage(n),f.value=!1,r.value=[]},Le=n=>{const t=n.customer;if(!(t!=null&&t.phone)){console.error("❌ No phone number found in order:",n);return}const c={id:t.id,name:t.full_name||t.name||"Customer",phone:t.phone,whatsapp:t.whatsapp||t.phone,orderId:n.id,orderOid:n.order_no,orderData:n};G.openDialog(c),console.log("Opening WhatsApp dialog for contact:",c)},ze=n=>{var t;(t=A.value)==null||t.openDialog(n)};return X(r,n=>{const t=n.length===s.orders.length&&s.orders.length>0;f.value!==t&&(f.value=t)}),He(async()=>{await s.initialize(),await s.fetchOrders({page:1})}),(n,t)=>{const c=S("v-autocomplete");return i(),Ie(We,null,{default:M(()=>[e("div",at,[e("div",rt,[e("div",it,[e("div",dt,[J(e("input",{"onUpdate:modelValue":t[0]||(t[0]=l=>o(s).orderSearch=l),type:"text",placeholder:"Search orders by (id, customer name, phone, address)",class:"w-full px-4 py-2 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",onInput:_},null,544),[[$e,o(s).orderSearch]]),t[17]||(t[17]=e("button",{class:"absolute right-2 top-2 p-1 text-gray-500 hover:text-gray-700"},[e("svg",{class:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),e("div",ut,[e("div",pt,[e("div",null,[t[18]||(t[18]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"SELLER",-1)),u(c,{modelValue:o(s).orderFilterVendor,"onUpdate:modelValue":t[1]||(t[1]=l=>o(s).orderFilterVendor=l),items:o(s).vendorOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search sellers...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),e("div",null,[t[19]||(t[19]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"PRODUCT",-1)),u(c,{modelValue:o(s).orderFilterProduct,"onUpdate:modelValue":t[2]||(t[2]=l=>o(s).orderFilterProduct=l),items:o(s).productOptions,"item-title":"product_name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search products...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),e("div",null,[t[20]||(t[20]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CATEGORY",-1)),u(c,{modelValue:o(s).orderFilterCategory,"onUpdate:modelValue":t[3]||(t[3]=l=>o(s).orderFilterCategory=l),items:o(s).categoryOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search categories...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),e("div",null,[t[21]||(t[21]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CITY",-1)),u(c,{modelValue:o(s).orderFilterCity,"onUpdate:modelValue":t[4]||(t[4]=l=>o(s).orderFilterCity=l),items:o(s).cityOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search cities...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"ZONE",-1)),u(c,{modelValue:o(s).orderFilterZone,"onUpdate:modelValue":t[5]||(t[5]=l=>o(s).orderFilterZone=l),items:o(s).zoneOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search zones...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CALL AGENT",-1)),u(c,{modelValue:o(s).orderFilterAgent,"onUpdate:modelValue":t[6]||(t[6]=l=>o(s).orderFilterAgent=l),items:o(s).agentOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search agents...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"DELIVERY PERSON",-1)),u(c,{modelValue:o(s).orderFilterRider,"onUpdate:modelValue":t[7]||(t[7]=l=>o(s).orderFilterRider=l),items:o(s).riderOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search delivery persons...",class:"w-full",autocomplete:""},null,8,["modelValue","items"])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CONFIRMATION STATUS",-1)),u(c,{modelValue:o(s).orderFilterStatus,"onUpdate:modelValue":t[8]||(t[8]=l=>o(s).orderFilterStatus=l),items:o(s).statusOptions,"item-title":"name","item-value":"id",clearable:"",dense:"",outlined:"",placeholder:"Search statuses...",class:"w-full"},null,8,["modelValue","items"])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"DELIVERY DATE",-1)),u(Q,{modelValue:o(s).deliveryDateRange,"onUpdate:modelValue":t[9]||(t[9]=l=>o(s).deliveryDateRange=l)},null,8,["modelValue"])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"STATUS DATE ",-1)),u(Q,{modelValue:o(s).statusDateRange,"onUpdate:modelValue":t[10]||(t[10]=l=>o(s).statusDateRange=l)},null,8,["modelValue"])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium text-red-600 mb-1"},"CREATED RANGE",-1)),u(Q,{modelValue:o(s).createdDateRange,"onUpdate:modelValue":t[11]||(t[11]=l=>o(s).createdDateRange=l)},null,8,["modelValue"])])]),e("div",mt,[e("button",{onClick:j,disabled:o(s).loading.orders,class:"px-8 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors flex items-center gap-2 disabled:opacity-50"},[o(s).loading.orders?(i(),d("span",gt)):O("",!0),t[30]||(t[30]=b(" Filter ")),o(s).loading.orders?O("",!0):(i(),d("svg",vt,t[29]||(t[29]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.121A1 1 0 013 6.414V4z"},null,-1)])))],8,ct),e("button",{onClick:F,class:"px-8 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors flex items-center gap-2"},t[31]||(t[31]=[b(" Reset "),e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)]))]),o(s).activeFilterCount>0?(i(),d("div",xt,[e("span",null,"Active filters: "+a(o(s).activeFilterCount),1),e("button",{onClick:F,class:"text-red-600 hover:text-red-800 underline"}," Clear all ")])):O("",!0)]),e("div",ht,[e("div",bt,[t[32]||(t[32]=e("h1",{class:"text-2xl font-semibold"},"Orders",-1)),e("span",ft,a(o(s).pagination.from)+" - "+a(o(s).pagination.to)+"/"+a(o(s).pagination.total),1)]),e("div",yt,[e("button",{onClick:Ee,disabled:r.value.length===0||o(s).loading.orders,class:"px-3 py-2 bg-red-500 text-white rounded-md hover:bg-red-600 transition-colors flex items-center gap-2 text-sm"},t[33]||(t[33]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v3m0 0v3m0-3h3m-3 0H9m12 0a9 9 0 11-18 0 9 9 0 0118 0z"})],-1),b(" Associate agents ")]),8,kt),e("button",{onClick:g,class:"px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors flex items-center gap-2 text-sm"},t[34]||(t[34]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})],-1),b(" New Order ")])),e("button",{onClick:p,disabled:r.value.length===0||o(s).loading.orders,class:"px-3 py-2 bg-gray-800 text-white rounded-md hover:bg-gray-900 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[t[35]||(t[35]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2h-2M7 17H5a2 2 0 01-2-2v-4a2 2 0 012-2h2m10 9v1a3 3 0 01-3 3H10a3 3 0 01-3-3v-1m10 0H7m10 0a5 5 0 00-10 0m10 0v-3a5 5 0 00-10 0v3"})],-1)),b(" Print ("+a(r.value.length)+") ",1)],8,wt),e("button",{onClick:Pe,disabled:o(s).loading.orders,class:"px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},t[36]||(t[36]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 10v6m0 0l-3-3m3 3l3-3M3 17V7a2 2 0 012-2h6l2 2h6a2 2 0 012 2v10a2 2 0 01-2 2H5a2 2 0 01-2-2z"})],-1),b(" Export Orders ")]),8,_t),e("button",{onClick:Re,disabled:r.value.length===0||o(s).loading.orders,class:"px-3 py-2 bg-yellow-600 text-white rounded-md hover:bg-yellow-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[t[37]||(t[37]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})],-1)),b(" Change Status ("+a(r.value.length)+") ",1)],8,Ct),e("button",{onClick:k,disabled:r.value.length===0||o(s).loading.orders,class:"px-3 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[t[38]||(t[38]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M3 10h1l1 2h13l1-2h1m-1 0V6a2 2 0 00-2-2H5a2 2 0 00-2 2v4m16 0v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6m16 0h-3.586a1 1 0 00-.707.293l-1.414 1.414a1 1 0 01-.707.293H8a1 1 0 01-1-1v-3a1 1 0 011-1h8a1 1 0 011 1v3z"})],-1)),b(" Assign Delivery ("+a(r.value.length)+") ",1)],8,Dt),e("button",{onClick:Fe,disabled:r.value.length===0||o(s).loading.orders,class:"px-3 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 transition-colors flex items-center gap-2 text-sm disabled:opacity-50"},[t[39]||(t[39]=e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)),b(" Bulk Delete ("+a(r.value.length)+") ",1)],8,Vt)])]),o(s).loading.orders&&o(s).orders.length===0?(i(),d("div",St,t[40]||(t[40]=[e("div",{class:"animate-spin roundecreatedDateRanged-full h-8 w-8 border-b-2 border-blue-600 mx-auto mb-4"},null,-1),e("p",{class:"text-gray-600"},"Loading orders...",-1)]))):o(s).error&&o(s).orders.length===0?(i(),d("div",At,[t[41]||(t[41]=e("div",{class:"text-red-600 mb-4"},[e("svg",{class:"w-8 h-8 mx-auto mb-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.732-.833-2.464 0L4.732 16.5c-.77.833.192 2.5 1.732 2.5z"})])],-1)),e("p",Ot,a(o(s).error),1),e("button",{onClick:L,class:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"}," Retry ")])):(i(),d("div",Mt,[e("div",Pt,[e("table",Rt,[e("thead",Ft,[e("tr",null,[e("th",Et,[J(e("input",{type:"checkbox","onUpdate:modelValue":t[12]||(t[12]=l=>f.value=l),onChange:V,class:"rounded","aria-label":"Select all orders"},null,544),[[Ce,f.value]])]),t[42]||(t[42]=e("th",{class:"px-4 py-3 text-left font-medium"}," ORDER MERCHANT ID ",-1)),t[43]||(t[43]=e("th",{class:"px-4 py-3 text-left font-medium"}," ORDER NO ",-1)),t[44]||(t[44]=e("th",{class:"px-4 py-3 text-left font-medium"}," SELLER ",-1)),t[45]||(t[45]=e("th",{class:"px-4 py-3 text-left font-medium"}," Delivery Date ",-1)),t[46]||(t[46]=e("th",{class:"px-4 py-3 text-left font-medium"}," CUSTOMER ",-1)),t[47]||(t[47]=e("th",{class:"px-4 py-3 text-left font-medium"}," DETAILS ",-1)),t[48]||(t[48]=e("th",{class:"px-4 py-3 text-left font-medium"}," ADDRESS ",-1)),t[49]||(t[49]=e("th",{class:"px-4 py-3 text-left font-medium"}," DATE ",-1)),t[50]||(t[50]=e("th",{class:"px-4 py-3 text-left font-medium"}," TOTAL PRICE ",-1)),t[51]||(t[51]=e("th",{class:"px-4 py-3 text-left font-medium"}," DELIVERY PERSON ",-1)),t[52]||(t[52]=e("th",{class:"px-4 py-3 text-left font-medium"}," CUSTOMER CARE ",-1)),t[53]||(t[53]=e("th",{class:"px-4 py-3 text-left font-medium"}," STATUS ",-1)),t[54]||(t[54]=e("th",{class:"px-4 py-3 text-left font-medium"}," ACTIONS ",-1))])]),e("tbody",null,[o(s).orders.length===0?(i(),d("tr",Bt,t[55]||(t[55]=[e("td",{colspan:"12",class:"px-4 py-8 text-center text-gray-500"}," No orders found ",-1)]))):O("",!0),(i(!0),d(N,null,H(o(s).orders,l=>{var E,B,se,le,oe,ne,ae,re,ie,de,ue,pe,me,ce,ge,ve,xe,he,be,fe,ye,ke,we;return i(),d("tr",{key:l.id,class:Y(["border-b hover:bg-gray-50",l.status===1?"bg-green-50":l.status===0?"bg-yellow-50":l.status===2?"bg-red-50":"bg-white"])},[e("td",Tt,[J(e("input",{type:"checkbox","onUpdate:modelValue":t[13]||(t[13]=h=>r.value=h),value:l.id,class:"rounded"},null,8,Ut),[[Ce,r.value]])]),e("td",jt,a(l.reference||"-"),1),e("td",Lt,a(l.order_no||"-"),1),e("td",zt,a(Ae(l.vendor_id)),1),e("td",Nt,[e("span",Ht,a(l.delivery_date||"Unknown"),1)]),e("td",It,[e("div",$t,[e("div",null,a(((E=l.shipping_address)==null?void 0:E.full_name)||((B=l.customer)==null?void 0:B.full_name)),1),e("div",qt,a(((se=l.shipping_address)==null?void 0:se.phone)||((le=l.customer)==null?void 0:le.phone)),1)])]),e("td",Wt,[e("span",Yt,[t[56]||(t[56]=e("span",{class:"w-2 h-2 bg-red-500 rounded-full"},null,-1)),b(" "+a(((oe=l.order_items)==null?void 0:oe.length)||0)+" product"+a((((ne=l.order_items)==null?void 0:ne.length)||0)!==1?"s":""),1)]),e("div",Gt,[(i(!0),d(N,null,H(l.order_items,h=>{var z;return i(),d("div",{key:h.id,class:"text-[11px] text-gray-700"},a(((z=h.product)==null?void 0:z.product_name)||h.name||"Product")+" (x"+a(h.quantity)+") ",1)}),128))])]),e("td",Zt,[e("div",null,a(((re=(ae=l.shipping_address)==null?void 0:ae.city)==null?void 0:re.name)||((de=(ie=l.customer)==null?void 0:ie.city)==null?void 0:de.name)||((pe=(ue=l.customer)==null?void 0:ue.zone)==null?void 0:pe.name)||"-")+" "+a(((me=l.shipping_address)==null?void 0:me.address)||((ce=l.customer)==null?void 0:ce.address)||"-"),1),e("div",Kt,a(((ge=l.shipping_address)==null?void 0:ge.address)||((ve=l.customer)==null?void 0:ve.address)),1)]),e("td",Jt,[e("div",null,a(De(l.created_at)),1)]),e("td",Qt," KSH"+a(l.total_price||"0.00"),1),e("td",Xt,[W(l)?(i(),d("div",es,[e("img",{src:W(l).profile_photo_url||"/default-avatar.png",alt:W(l).name,class:"w-6 h-6 rounded-full mx-auto mb-1"},null,8,ts),e("div",null,a(W(l).name),1)])):(i(),d("div",ss," Not assigned "))]),e("td",ls,[q(l)?(i(),d("div",os,[e("img",{src:q(l).profile_photo_url||"/default-avatar.png",alt:q(l).name,class:"w-6 h-6 rounded-full mx-auto mb-1"},null,8,ns),e("div",null,a(q(l).name),1)])):(i(),d("div",as," Not assigned "))]),e("td",rs,[e("div",is,[e("span",{class:"px-2 py-1 text-xs rounded",style:qe((he=(xe=l.latest_status)==null?void 0:xe.status)!=null&&he.color?{backgroundColor:l.latest_status.status.color,color:"white"}:{})},a(((fe=(be=l.latest_status)==null?void 0:be.status)==null?void 0:fe.name)||Se(l.status)),5),(ye=l.latest_status)!=null&&ye.status_notes?(i(),d("div",ds,[t[57]||(t[57]=e("strong",{class:"text-xs"},"Note:",-1)),e("span",us,a((ke=l.latest_status)==null?void 0:ke.status_notes),1)])):O("",!0),(we=l.latest_status)!=null&&we.created_at?(i(),d("div",ps," Status at "+a(Ve(l.latest_status.created_at)),1)):O("",!0)])]),e("td",ms,[e("div",cs,[e("button",{onClick:h=>$(l.id),class:"p-1 text-orange-600 hover:bg-orange-100 rounded",title:"Edit Order"},t[58]||(t[58]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})],-1)]),8,gs),e("button",{onClick:h=>Oe(l),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"View Order"},t[59]||(t[59]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})],-1)]),8,vs),e("button",{onClick:h=>n.viewRecordings(l),class:"p-1 text-purple-600 hover:bg-purple-100 rounded",title:"View Call Recordings"},t[60]||(t[60]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 2a3 3 0 00-3 3v6a3 3 0 006 0V5a3 3 0 00-3-3z"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M19 10v2a7 7 0 01-14 0v-2m7 9v3m-4 0h8"}),e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M5 9a9 9 0 000 6M19 9a9 9 0 010 6"})],-1)]),8,xs),e("button",{onClick:h=>{var z,_e;return P(((z=l.shipping_address)==null?void 0:z.phone)||((_e=l.customer)==null?void 0:_e.phone),l)},class:"p-1 text-indigo-600 hover:bg-indigo-100 rounded disabled:opacity-50",title:"Call Customer"},t[61]||(t[61]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 5a2 2 0 012-2h1.5a1 1 0 01.95.68l.7 2.1a1 1 0 01-.27 1L6.6 8.9a12 12 0 005 5l1.1-.58a1 1 0 011 .27l2.1.7A1 1 0 0119 16.5V18a2 2 0 01-2 2C9.163 20 4 14.837 4 6a2 2 0 00-.999-.999z"})],-1)]),8,hs),e("button",{onClick:h=>Le(l),class:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Send WhatsApp Message"},t[62]||(t[62]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",viewBox:"0 0 24 24",fill:"currentColor"},[e("path",{d:"M20.52 3.48A11.36 11.36 0 0012.03.5C6.18.5 1.4 5.28 1.4 11.13c0 1.96.51 3.87 1.48 5.54L.5 23l6.43-2.06a11.6 11.6 0 005.1 1.17h.01c5.85 0 10.63-4.78 10.63-10.63 0-2.83-1.1-5.49-3.05-7.46zM12.03 20.9h-.01a9.42 9.42 0 01-4.8-1.3l-.34-.2-3.8 1.22 1.28-3.7-.22-.36a9.15 9.15 0 01-1.4-4.74c0-5.04 4.1-9.14 9.14-9.14 2.44 0 4.73.95 6.45 2.67a9.07 9.07 0 012.67 6.47c0 5.04-4.1 9.14-9.14 9.14zm5-6.41c-.27-.14-1.6-.79-1.85-.88-.25-.09-.43-.14-.61.14-.18.27-.7.88-.86 1.06-.16.18-.32.2-.59.07-.27-.14-1.13-.42-2.15-1.32-.8-.71-1.34-1.58-1.5-1.85-.16-.27-.02-.42.12-.56l.1-.1c.09-.09.27-.23.41-.35.14-.12.18-.2.27-.33.09-.14.05-.27.02-.38-.05-.11-.61-1.47-.84-2.01-.22-.53-.45-.46-.61-.47-.16-.01-.34-.01-.52-.01a1 1 0 00-.73.31c-.25.25-.97.95-.97 2.31 0 1.36.99 2.68 1.13 2.87.14.18 1.94 2.97 4.74 4.05.66.23 1.18.37 1.58.48.66.17 1.26.15 1.73.09.53-.07 1.6-.65 1.83-1.28.23-.63.23-1.17.16-1.28-.07-.11-.25-.18-.52-.32z"})],-1)]),8,bs),e("button",{onClick:h=>n.sendSms(l),class:"p-1 text-blue-600 hover:bg-blue-100 rounded",title:"Send SMS"},t[63]||(t[63]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})],-1)]),8,fs),e("button",{onClick:h=>ze(l),class:"p-1 text-green-600 hover:bg-green-100 rounded",title:"Initiate M-Pesa STK Push"},t[64]||(t[64]=[e("svg",{xmlns:"http://www.w3.org/2000/svg",class:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[e("rect",{x:"7",y:"2",width:"10",height:"20",rx:"2"}),e("path",{d:"M11 18h2"})],-1)]),8,ys),e("button",{onClick:h=>Me(l),class:"p-1 text-red-600 hover:bg-red-100 rounded",title:"Delete Order"},t[65]||(t[65]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})],-1)]),8,ks)])])],2)}),128))])])]),e("div",ws,[e("div",_s,[e("div",Cs," Showing "+a(o(s).pagination.from)+" to "+a(o(s).pagination.to)+" of "+a(o(s).pagination.total)+" results ",1),e("div",Ds,[t[66]||(t[66]=e("label",{class:"text-sm text-gray-600"},"Show:",-1)),e("select",{value:o(s).pagination.per_page,onChange:t[14]||(t[14]=l=>je(l.target.value)),disabled:o(s).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md text-sm focus:ring-2 focus:ring-blue-500 focus:border-transparent disabled:opacity-50"},[(i(!0),d(N,null,H(o(s).perPageOptions,l=>(i(),d("option",{key:l,value:l},a(l),9,Ss))),128))],40,Vs),t[67]||(t[67]=e("span",{class:"text-sm text-gray-600"},"per page",-1))])]),e("div",As,[e("button",{onClick:Be,disabled:o(s).pagination.current_page===1||o(s).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm"}," Previous ",8,Os),(i(!0),d(N,null,H(ee.value,l=>(i(),d("button",{key:l,onClick:E=>Ue(l),disabled:o(s).loading.orders,class:Y(["px-3 py-1 border rounded-md text-sm",l===o(s).pagination.current_page?"bg-blue-600 text-white border-blue-600":"border-gray-300 hover:bg-gray-100 disabled:opacity-50"])},a(l),11,Ms))),128)),e("button",{onClick:Te,disabled:o(s).pagination.current_page===o(s).pagination.last_page||o(s).loading.orders,class:"px-3 py-1 border border-gray-300 rounded-md hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm"}," Next ",8,Ps)])])])),e("div",Rs,[(i(!0),d(N,null,H(o(s).notifications,l=>(i(),d("div",{key:l.id,class:Y(["px-6 py-4 rounded-lg shadow-lg text-white max-w-sm",l.type==="success"?"bg-green-600":"bg-red-600"])},[e("div",Fs,[e("p",Es,a(l.message),1),e("button",{onClick:E=>o(s).removeNotification(l.id),class:"ml-4 text-white hover:text-gray-200"},t[68]||(t[68]=[e("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 f6M6 6l12 12"})],-1)]),8,Bs)])],2))),128))])])]),u(Xe,{ref_key:"stkpushDialog",ref:A,onStkPushInitiated:n.handleStkPushInitiated},null,8,["onStkPushInitiated"]),u(Je,{modelValue:o(x).dialogOpen,"onUpdate:modelValue":t[15]||(t[15]=l=>o(x).dialogOpen=l),order:o(x).activeOrder},null,8,["modelValue","order"]),u(Ge),u(st,{modelValue:m.value,"onUpdate:modelValue":t[16]||(t[16]=l=>m.value=l),"call-data":{phone:C.value},"phone-number":I.value,onCallMade:U,onCallTransferred:Z,onAgentCalled:K},null,8,["modelValue","call-data","phone-number"]),u(et,{"is-create":D.value,onOrderSaved:R,onDialogClosed:y},null,8,["is-create"]),u(tt)]),_:1})}}};export{sl as default};
