import{_ as M}from"./AppLayout-D7OvL1cP.js";import{l as s,a7 as Q,c as $,o as E,w as l,b as i,a as u,f as a,m as C,t as f,y as Z,A as G,i as h}from"./app-Cuu9_Ou2.js";import{n as c}from"./toast-BL1hZfwG.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-DUR8KGJE.js";import"./africastalking-CLaKg46O.js";import"./IncomingCallDialog-Bg37T-b7.js";/* empty css                                                                           */const J={components:{AppLayout:M},data:()=>({dialog:!1,deleteDialog:!1,loading:!1,saving:!1,deleting:!1,valid:!0,searchQuery:"",statusFilter:"All",sortBy:"option_number",sortOrder:"asc",page:1,headers:[{title:"Option #",key:"option_number",align:"start",width:"100px"},{title:"Description",key:"description"},{title:"Forward Number",key:"forward_number",width:"180px"},{title:"Virtual Number",key:"phone_number",width:"180px"},{title:"Status",key:"status",width:"120px"},{title:"Actions",key:"actions",sortable:!1,align:"center",width:"150px"}],ivrOptions:[],filteredIvrOptions:[],editedIndex:-1,editedItem:{option_number:"",description:"",forward_number:"",phone_number:"",status:"inactive",notes:""},defaultItem:{option_number:"",description:"",forward_number:"",phone_number:"",status:"inactive",notes:""},deleteItem:null,phoneNumberMask:"(###) ###-####",searchTimeout:null}),computed:{formTitle(){return this.editedIndex===-1?"Add New IVR Option":"Edit IVR Option"}},created(){this.initialize()},methods:{initialize(){this.loading=!0,h.get("/api/v1/ivr-options").then(t=>{const e=t.data;this.ivrOptions=Array.isArray(e.data)?e.data:e.ivrOptions||[],this.filteredIvrOptions=[...this.ivrOptions],this.loading=!1,c({type:"success",message:"IVR options loaded successfully"})}).catch(t=>{console.error("API Error:",t),this.loading=!1,c({type:"error",message:"Failed to load IVR options"})})},debounceSearch(){clearTimeout(this.searchTimeout),this.searchTimeout=setTimeout(()=>{this.applyFilters()},300)},applyFilters(){let t=[...this.ivrOptions];if(this.searchQuery){const e=this.searchQuery.toLowerCase();t=t.filter(r=>r.option_number.toString().includes(e)||r.description.toLowerCase().includes(e)||r.forward_number.toLowerCase().includes(e)||r.phone_number.toLowerCase().includes(e))}if(this.statusFilter!=="All"){const e=this.statusFilter.toLowerCase();t=t.filter(r=>r.status.toLowerCase()===e)}this.filteredIvrOptions=t,this.page=1},resetFilterAndRefresh(){this.searchQuery="",this.statusFilter="All",this.sortBy="option_number",this.sortOrder="asc",this.initialize()},editItem(t){this.editedIndex=this.ivrOptions.findIndex(e=>e.id===t.id),this.editedItem=Object.assign({},t),this.dialog=!0},confirmDelete(t){this.deleteItem=t,this.deleteDialog=!0},deleteIvrOption(){this.deleting=!0,h.delete(`/api/v1/ivr-options/${this.deleteItem.id}`).then(()=>{this.ivrOptions=this.ivrOptions.filter(t=>t.id!==this.deleteItem.id),this.applyFilters(),this.deleteDialog=!1,this.deleting=!1,c({type:"success",message:"IVR option deleted successfully"})}).catch(t=>{console.error("Deletion error:",t),this.deleting=!1,c({type:"error",message:"Failed to delete IVR option"})})},close(){this.dialog=!1,this.$nextTick(()=>{this.resetForm()})},resetForm(){var t;(t=this.$refs.form)==null||t.reset(),this.editedItem=Object.assign({},this.defaultItem),this.editedIndex=-1},save(){var e;if(!((e=this.$refs.form)!=null&&e.validate()))return;this.saving=!0;let t;this.editedIndex>-1?t=h.put(`/api/v1/ivr-options/${this.editedItem.id}`,this.editedItem):t=h.post("/api/v1/ivr-options",this.editedItem),t.then(r=>{const g=r.data;this.editedIndex>-1?Object.assign(this.ivrOptions[this.editedIndex],g):this.ivrOptions.push(g),this.applyFilters(),this.close(),this.saving=!1,c({type:"success",message:`IVR option ${this.editedIndex>-1?"updated":"created"} successfully`})}).catch(r=>{console.error("Saving error:",r),this.saving=!1,c({type:"error",message:`Failed to ${this.editedIndex>-1?"update":"create"} IVR option`})})},toggleStatus(t){const e={...t,status:t.status==="active"?"inactive":"active"};h.put(`/api/v1/ivr-options/${t.id}`,e).then(r=>{const g=this.ivrOptions.findIndex(k=>k.id===t.id);Object.assign(this.ivrOptions[g],r.data),this.applyFilters(),c({type:"success",message:`Option ${t.option_number} ${e.status==="active"?"activated":"deactivated"}`})}).catch(r=>{console.error("Status toggle error:",r),c({type:"error",message:"Failed to update status"})})},updatePage(t){this.page=t},getStatusColor(t){return t==="active"?"success":"grey"},getStatusText(t){return t==="active"?"Active":"Inactive"},formatPhoneNumber(t){if(!t)return"";const e=(""+t).replace(/\D/g,"");return e.length===10?`(${e.substring(0,3)}) ${e.substring(3,6)}-${e.substring(6,10)}`:t},validatePhoneNumber(t){return!t||/^[A-Za-z]+\.[A-Za-z]+$/.test(t)?!0:t.replace(/\D/g,"").length<10?"Phone number must have at least 10 digits or be in Username.Name format":!0}}},K={class:"d-flex align-center"},W={class:"d-flex align-center"},X={class:"d-flex"},Y={class:"d-flex flex-column align-center py-6"},ee={class:"d-flex justify-center align-center pa-4"},te={class:"d-flex justify-end pa-4"},ie={class:"mt-4 pa-4 bg-grey-lighten-4 rounded"};function le(t,e,r,g,k,n){const d=s("v-col"),_=s("v-text-field"),m=s("v-btn"),b=s("v-row"),I=s("v-container"),V=s("VCard"),y=s("v-select"),R=s("v-chip"),v=s("v-icon"),O=s("v-tooltip"),U=s("v-progress-circular"),z=s("v-data-table"),T=s("v-pagination"),w=s("v-spacer"),F=s("v-card-title"),P=s("v-textarea"),B=s("v-form"),x=s("v-card-text"),L=s("v-divider"),S=s("v-card-actions"),A=s("v-card"),D=s("v-dialog"),q=s("AppLayout"),j=Q("mask");return E(),$(q,null,{default:l(()=>[i(V,{class:"my-card elevation-2"},{default:l(()=>[i(I,null,{default:l(()=>[i(b,{align:"center"},{default:l(()=>[i(d,{cols:"12",md:"6"},{default:l(()=>e[16]||(e[16]=[u("h4",{class:"text-h4 font-weight-bold primary--text"},"IVR Options Manager",-1),u("p",{class:"text-subtitle-1 text-medium-emphasis mt-1"}," Manage your Interactive Voice Response menu options ",-1)])),_:1,__:[16]}),i(d,{cols:"12",md:"6"},{default:l(()=>[i(b,null,{default:l(()=>[i(d,{cols:"8"},{default:l(()=>[i(_,{modelValue:t.searchQuery,"onUpdate:modelValue":e[0]||(e[0]=o=>t.searchQuery=o),label:"Search IVR Options","prepend-inner-icon":"mdi-magnify",clearable:"",variant:"outlined","hide-details":"",onInput:n.debounceSearch,density:"comfortable",placeholder:"Search by number, description or phone number..."},null,8,["modelValue","onInput"])]),_:1}),i(d,{cols:"4",class:"d-flex align-center"},{default:l(()=>[i(m,{color:"primary","prepend-icon":"mdi-plus",size:"large",class:"text-none",onClick:e[1]||(e[1]=o=>t.dialog=!0)},{default:l(()=>e[17]||(e[17]=[a(" New Option ")])),_:1,__:[17]})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),i(V,{class:"my-card elevation-1"},{default:l(()=>[i(I,null,{default:l(()=>[i(b,null,{default:l(()=>[i(d,{cols:"12",md:"3"},{default:l(()=>[i(y,{modelValue:t.statusFilter,"onUpdate:modelValue":[e[2]||(e[2]=o=>t.statusFilter=o),n.applyFilters],items:["All","Active","Inactive"],label:"Status",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),i(d,{cols:"12",md:"3"},{default:l(()=>[i(y,{modelValue:t.sortBy,"onUpdate:modelValue":[e[3]||(e[3]=o=>t.sortBy=o),n.applyFilters],items:[{title:"Option Number",value:"option_number"},{title:"Description",value:"description"},{title:"Virtual Number",value:"phone_number"},{title:"Status",value:"status"}],"item-title":"title","item-value":"value",label:"Sort By",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),i(d,{cols:"12",md:"3"},{default:l(()=>[i(y,{modelValue:t.sortOrder,"onUpdate:modelValue":[e[4]||(e[4]=o=>t.sortOrder=o),n.applyFilters],items:[{title:"Ascending",value:"asc"},{title:"Descending",value:"desc"}],"item-title":"title","item-value":"value",label:"Sort Order",variant:"outlined",density:"comfortable","hide-details":""},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),i(d,{cols:"12",md:"3",class:"d-flex align-center justify-end"},{default:l(()=>[i(m,{variant:"text",color:"primary","prepend-icon":"mdi-refresh",onClick:n.resetFilterAndRefresh},{default:l(()=>e[18]||(e[18]=[a(" Reset Filters ")])),_:1,__:[18]},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1}),i(V,{class:"my-card elevation-2"},{default:l(()=>[i(z,{headers:t.headers,loading:t.loading,items:t.filteredIvrOptions,"items-per-page":10,"sort-by":[{key:t.sortBy,order:t.sortOrder}],class:"elevation-0"},{"item.status":l(({item:o})=>[i(R,{color:n.getStatusColor(o.status),"text-color":"white",size:"small",label:""},{default:l(()=>[a(f(n.getStatusText(o.status)),1)]),_:2},1032,["color"])]),"item.phone_number":l(({item:o})=>[u("div",K,[i(v,{size:"small",color:"primary",class:"me-2"},{default:l(()=>e[19]||(e[19]=[a("mdi-phone")])),_:1,__:[19]}),a(" "+f(n.formatPhoneNumber(o.phone_number)),1)])]),"item.forward_number":l(({item:o})=>[u("div",W,[i(v,{size:"small",color:"success",class:"me-2"},{default:l(()=>e[20]||(e[20]=[a("mdi-call-split")])),_:1,__:[20]}),a(" "+f(n.formatPhoneNumber(o.forward_number)),1)])]),"item.actions":l(({item:o})=>[u("div",X,[i(O,{text:"Edit Option"},{activator:l(({props:p})=>[i(m,C({icon:"",size:"small",color:"primary",class:"me-2"},p,{onClick:N=>n.editItem(o)}),{default:l(()=>[i(v,null,{default:l(()=>e[21]||(e[21]=[a("mdi-pencil")])),_:1,__:[21]})]),_:2},1040,["onClick"])]),_:2},1024),i(O,{text:"Toggle Status"},{activator:l(({props:p})=>[i(m,C({icon:"",size:"small",color:o.status==="active"?"warning":"success",class:"me-2"},p,{onClick:N=>n.toggleStatus(o)}),{default:l(()=>[i(v,null,{default:l(()=>[a(f(o.status==="active"?"mdi-pause":"mdi-play"),1)]),_:2},1024)]),_:2},1040,["color","onClick"])]),_:2},1024),i(O,{text:"Delete Option"},{activator:l(({props:p})=>[i(m,C({icon:"",size:"small",color:"error"},p,{onClick:N=>n.confirmDelete(o)}),{default:l(()=>[i(v,null,{default:l(()=>e[22]||(e[22]=[a("mdi-delete")])),_:1,__:[22]})]),_:2},1040,["onClick"])]),_:2},1024)])]),"no-data":l(()=>[u("div",Y,[i(v,{size:"large",color:"grey"},{default:l(()=>e[23]||(e[23]=[a("mdi-phone-off")])),_:1,__:[23]}),e[25]||(e[25]=u("div",{class:"text-subtitle-1 mt-2"},"No IVR options found",-1)),i(m,{color:"primary",class:"mt-4",onClick:n.initialize},{default:l(()=>e[24]||(e[24]=[a("Reset")])),_:1,__:[24]},8,["onClick"])])]),loading:l(()=>[u("div",ee,[i(U,{indeterminate:"",color:"primary",size:"48"})])]),_:1},8,["headers","loading","items","sort-by"]),u("div",te,[i(T,{modelValue:t.page,"onUpdate:modelValue":[e[5]||(e[5]=o=>t.page=o),n.updatePage],length:Math.ceil(t.filteredIvrOptions.length/10),rounded:"circle"},null,8,["modelValue","length","onUpdate:modelValue"])])]),_:1}),i(D,{modelValue:t.dialog,"onUpdate:modelValue":e[13]||(e[13]=o=>t.dialog=o),"max-width":"600px",persistent:""},{default:l(()=>[i(A,null,{default:l(()=>[i(F,{class:"text-h5 bg-primary text-white pa-4"},{default:l(()=>[a(f(n.formTitle)+" ",1),i(w),i(m,{icon:"",variant:"text",onClick:n.close,color:"white"},{default:l(()=>[i(v,null,{default:l(()=>e[26]||(e[26]=[a("mdi-close")])),_:1,__:[26]})]),_:1},8,["onClick"])]),_:1}),i(x,{class:"pa-4"},{default:l(()=>[i(B,{ref:"form",modelValue:t.valid,"onUpdate:modelValue":e[12]||(e[12]=o=>t.valid=o),"lazy-validation":"",onSubmit:Z(n.save,["prevent"])},{default:l(()=>[i(I,null,{default:l(()=>[i(b,null,{default:l(()=>[i(d,{cols:"12",md:"6"},{default:l(()=>[i(_,{modelValue:t.editedItem.option_number,"onUpdate:modelValue":e[6]||(e[6]=o=>t.editedItem.option_number=o),label:"Option Number",variant:"outlined",rules:[o=>!!o||"Option number is required",o=>/^\d+$/.test(o)||"Must be a number"],hint:"The number callers will press (1-9)","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),i(d,{cols:"12",md:"6"},{default:l(()=>[i(y,{modelValue:t.editedItem.status,"onUpdate:modelValue":e[7]||(e[7]=o=>t.editedItem.status=o),items:[{title:"Active",value:"active"},{title:"Inactive",value:"inactive"}],"item-title":"title","item-value":"value",label:"Status",variant:"outlined",required:""},null,8,["modelValue"])]),_:1}),i(d,{cols:"12"},{default:l(()=>[i(_,{modelValue:t.editedItem.description,"onUpdate:modelValue":e[8]||(e[8]=o=>t.editedItem.description=o),label:"Description",variant:"outlined",rules:[o=>!!o||"Description is required"],hint:"Description of this menu option","persistent-hint":"",required:""},null,8,["modelValue","rules"])]),_:1}),i(d,{cols:"12",md:"6"},{default:l(()=>[i(_,{modelValue:t.editedItem.phone_number,"onUpdate:modelValue":e[9]||(e[9]=o=>t.editedItem.phone_number=o),label:"Virtual Number",variant:"outlined"},null,8,["modelValue"])]),_:1}),i(d,{cols:"12",md:"6"},{default:l(()=>[G(i(_,{modelValue:t.editedItem.forward_number,"onUpdate:modelValue":e[10]||(e[10]=o=>t.editedItem.forward_number=o),label:"Forward Number",variant:"outlined",hint:"Number to forward to when selected","persistent-hint":"",required:""},null,8,["modelValue"]),[[j,t.phoneNumberMask]])]),_:1}),i(d,{cols:"12"},{default:l(()=>[i(P,{modelValue:t.editedItem.notes,"onUpdate:modelValue":e[11]||(e[11]=o=>t.editedItem.notes=o),label:"Notes (Optional)",variant:"outlined",hint:"Additional notes about this IVR option","persistent-hint":"",rows:"3","auto-grow":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1}),i(L),i(S,{class:"pa-4"},{default:l(()=>[i(m,{variant:"outlined",color:"grey",onClick:n.close},{default:l(()=>e[27]||(e[27]=[a("Cancel")])),_:1,__:[27]},8,["onClick"]),i(w),i(m,{variant:"elevated",color:"primary",onClick:n.save,disabled:!t.valid,loading:t.saving},{default:l(()=>e[28]||(e[28]=[a(" Save ")])),_:1,__:[28]},8,["onClick","disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),i(D,{modelValue:t.deleteDialog,"onUpdate:modelValue":e[15]||(e[15]=o=>t.deleteDialog=o),"max-width":"500px"},{default:l(()=>[i(A,null,{default:l(()=>[i(F,{class:"text-h5 bg-error text-white pa-4"},{default:l(()=>e[29]||(e[29]=[a(" Confirm Delete ")])),_:1,__:[29]}),i(x,{class:"pa-4 pt-6"},{default:l(()=>{var o,p;return[e[30]||(e[30]=a(" Are you sure you want to delete this IVR option? ")),u("div",ie,[u("strong",null,"Option "+f((o=t.deleteItem)==null?void 0:o.option_number)+":",1),a(" "+f((p=t.deleteItem)==null?void 0:p.description),1)]),e[31]||(e[31]=u("div",{class:"mt-4 text-caption text-medium-emphasis"}," This action cannot be undone. ",-1))]}),_:1,__:[30,31]}),i(S,{class:"pa-4"},{default:l(()=>[i(m,{variant:"text",color:"grey",onClick:e[14]||(e[14]=o=>t.deleteDialog=!1)},{default:l(()=>e[32]||(e[32]=[a("Cancel")])),_:1,__:[32]}),i(w),i(m,{variant:"elevated",color:"error",onClick:n.deleteIvrOption,loading:t.deleting},{default:l(()=>e[33]||(e[33]=[a(" Delete ")])),_:1,__:[33]},8,["onClick","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const pe=H(J,[["render",le],["__scopeId","data-v-72142a62"]]);export{pe as default};
