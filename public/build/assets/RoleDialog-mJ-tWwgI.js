import{r as u,j as E,s as H,z as ge,l as s,c as C,o as p,w as l,b as t,a as v,f as i,t as r,p as xe,q as Ve,d as k,F as S,g as G,y as be}from"./app-CP2QiQ_S.js";const Ce={class:"d-flex align-center"},we={class:"text-h5"},he={class:"d-flex align-center"},Re={class:"permission-groups"},Ue={class:"d-flex align-center justify-space-between w-100"},Pe={class:"d-flex align-center"},Me={class:"font-weight-medium"},Ae={class:"d-flex align-center"},Ee={key:0},Se={key:1,class:"text-body-2 text-medium-emphasis"},De={__name:"RoleDialog",props:{modelValue:Boolean,role:Object},emits:["update:modelValue","save"],setup(J,{emit:Q}){const _=J,D=Q,f=u(!1),w=u(!1),h=u(!1),g=u(null),y=u(""),B=u(["User Management","Content Management"]),c=u({name:"",description:"",color:"blue",icon:"mdi-account-group",active:!0}),a=u([]),z={required:o=>!!o||"This field is required"},W=u([{title:"Blue",value:"blue"},{title:"Green",value:"green"},{title:"Orange",value:"orange"},{title:"Red",value:"red"},{title:"Purple",value:"purple"},{title:"Teal",value:"teal"},{title:"Grey",value:"grey"}]);u([{title:"Account Group",value:"mdi-account-group"},{title:"Shield Account",value:"mdi-shield-account"},{title:"Account Tie",value:"mdi-account-tie"},{title:"Crown",value:"mdi-crown"},{title:"Star",value:"mdi-star"},{title:"Key",value:"mdi-key"},{title:"Pencil",value:"mdi-pencil"},{title:"Eye",value:"mdi-eye"}]);const R=u([{name:"User Management",icon:"mdi-account-multiple",permissions:[{key:"users.create",name:"Create Users",description:"Create new user accounts"},{key:"users.read",name:"View Users",description:"View user information"},{key:"users.update",name:"Edit Users",description:"Modify user information"},{key:"users.delete",name:"Delete Users",description:"Remove user accounts"},{key:"users.suspend",name:"Suspend Users",description:"Suspend/activate user accounts"}]},{name:"Role Management",icon:"mdi-account-group",permissions:[{key:"roles.create",name:"Create Roles",description:"Create new roles"},{key:"roles.read",name:"View Roles",description:"View role information"},{key:"roles.update",name:"Edit Roles",description:"Modify role permissions"},{key:"roles.delete",name:"Delete Roles",description:"Remove roles"},{key:"roles.assign",name:"Assign Roles",description:"Assign roles to users"}]},{name:"Content Management",icon:"mdi-file-document",permissions:[{key:"content.create",name:"Create Content",description:"Create new content"},{key:"content.read",name:"View Content",description:"View content"},{key:"content.update",name:"Edit Content",description:"Modify existing content"},{key:"content.delete",name:"Delete Content",description:"Remove content"},{key:"content.publish",name:"Publish Content",description:"Publish/unpublish content"}]},{name:"System Administration",icon:"mdi-cog",permissions:[{key:"system.config",name:"System Configuration",description:"Modify system settings"},{key:"system.logs",name:"View Logs",description:"Access system logs"},{key:"system.backup",name:"Backup Management",description:"Create and restore backups"},{key:"system.maintenance",name:"Maintenance Mode",description:"Enable/disable maintenance mode"}]},{name:"Reports & Analytics",icon:"mdi-chart-line",permissions:[{key:"reports.view",name:"View Reports",description:"Access reports and analytics"},{key:"reports.create",name:"Create Reports",description:"Generate custom reports"},{key:"reports.export",name:"Export Reports",description:"Export reports to various formats"},{key:"analytics.access",name:"Analytics Access",description:"Access detailed analytics"}]}]),L=E(()=>{var o;return!!((o=_.role)!=null&&o.id)}),X=E(()=>y.value?R.value.map(o=>({...o,permissions:o.permissions.filter(e=>e.name.toLowerCase().includes(y.value.toLowerCase())||e.description.toLowerCase().includes(y.value.toLowerCase()))})).filter(o=>o.permissions.length>0):R.value),Y=E(()=>{const o=R.value.flatMap(e=>e.permissions);return a.value.map(e=>o.find(d=>d.key===e)).filter(Boolean)});H(()=>_.modelValue,o=>{f.value=o,o&&_.role&&N()}),H(f,o=>{D("update:modelValue",o),o||N()});const N=()=>{_.role?(c.value={..._.role},a.value=[..._.role.permissions||[]]):(c.value={name:"",description:"",color:"blue",icon:"mdi-account-group",active:!0},a.value=[]),ge(()=>{g.value&&g.value.resetValidation()})},j=()=>{f.value=!1},Z=async()=>{if(g.value.validate()){h.value=!0;try{const o={...c.value,permissions:a.value};D("save",o)}finally{h.value=!1}}},U=(o,e)=>{if(e)a.value.includes(o)||a.value.push(o);else{const d=a.value.indexOf(o);d>-1&&a.value.splice(d,1)}},K=(o,e)=>{o.permissions.forEach(d=>{U(d.key,e)})},ee=o=>o.permissions.every(e=>a.value.includes(e.key)),te=o=>{const e=q(o);return e>0&&e<o.permissions.length},q=o=>o.permissions.filter(e=>a.value.includes(e.key)).length;return(o,e)=>{const d=s("v-icon"),P=s("v-btn"),x=s("v-card-title"),T=s("v-divider"),F=s("v-text-field"),le=s("v-textarea"),ne=s("v-avatar"),O=s("v-list-item"),oe=s("v-select"),se=s("v-switch"),V=s("v-card-text"),b=s("v-card"),M=s("v-col"),A=s("v-chip"),I=s("v-checkbox"),ae=s("v-expansion-panel-title"),ie=s("v-list-item-title"),re=s("v-list-item-subtitle"),ce=s("v-list"),de=s("v-expansion-panel-text"),ue=s("v-expansion-panel"),me=s("v-expansion-panels"),$=s("v-row"),pe=s("v-chip-group"),ve=s("v-form"),_e=s("v-spacer"),fe=s("v-card-actions"),ye=s("v-dialog");return p(),C(ye,{modelValue:f.value,"onUpdate:modelValue":e[8]||(e[8]=n=>f.value=n),"max-width":"800px",persistent:""},{default:l(()=>[t(b,null,{default:l(()=>[t(x,{class:"d-flex align-center justify-space-between"},{default:l(()=>[v("div",Ce,[t(d,{class:"mr-3",color:"primary"},{default:l(()=>e[9]||(e[9]=[i("mdi-account-group")])),_:1,__:[9]}),v("span",we,r(L.value?"Edit Role":"Create New Role"),1)]),t(P,{icon:"",variant:"text",onClick:j},{default:l(()=>[t(d,null,{default:l(()=>e[10]||(e[10]=[i("mdi-close")])),_:1,__:[10]})]),_:1})]),_:1}),t(T),t(V,{class:"pa-6"},{default:l(()=>[t(ve,{ref_key:"form",ref:g,modelValue:w.value,"onUpdate:modelValue":e[7]||(e[7]=n=>w.value=n)},{default:l(()=>[t($,null,{default:l(()=>[t(M,{cols:"12",md:"6"},{default:l(()=>[t(b,{variant:"outlined",class:"h-100"},{default:l(()=>[t(x,{class:"text-h6 pb-2"},{default:l(()=>e[11]||(e[11]=[i("Basic Information")])),_:1,__:[11]}),t(V,null,{default:l(()=>[t(F,{modelValue:c.value.name,"onUpdate:modelValue":e[0]||(e[0]=n=>c.value.name=n),label:"Role Name",placeholder:"Enter role name",variant:"outlined",rules:[z.required],class:"mb-4"},null,8,["modelValue","rules"]),t(le,{modelValue:c.value.description,"onUpdate:modelValue":e[1]||(e[1]=n=>c.value.description=n),label:"Description",placeholder:"Enter role description",variant:"outlined",rows:"3",rules:[z.required],class:"mb-4"},null,8,["modelValue","rules"]),t(oe,{modelValue:c.value.color,"onUpdate:modelValue":e[2]||(e[2]=n=>c.value.color=n),items:W.value,label:"Role Color",variant:"outlined",class:"mb-4"},{selection:l(({item:n})=>[v("div",he,[t(ne,{size:"20",color:n.value,class:"mr-2"},null,8,["color"]),i(" "+r(n.title),1)])]),item:l(({props:n,item:m})=>[t(O,xe(Ve(n)),{prepend:l(()=>[t(d,null,{default:l(()=>[i(r(m.value),1)]),_:2},1024)]),_:2},1040)]),_:1},8,["modelValue","items"]),t(se,{modelValue:c.value.active,"onUpdate:modelValue":e[3]||(e[3]=n=>c.value.active=n),label:"Active Role",color:"success","hide-details":""},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(M,{cols:"12",md:"6"},{default:l(()=>[t(b,{variant:"outlined",class:"h-100"},{default:l(()=>[t(x,{class:"text-h6 pb-2 d-flex align-center justify-space-between"},{default:l(()=>[e[12]||(e[12]=v("span",null,"Permissions",-1)),t(A,{size:"small",color:"primary",variant:"tonal"},{default:l(()=>[i(r(a.value.length)+" selected ",1)]),_:1})]),_:1,__:[12]}),t(V,null,{default:l(()=>[t(F,{modelValue:y.value,"onUpdate:modelValue":e[4]||(e[4]=n=>y.value=n),"prepend-inner-icon":"mdi-magnify",placeholder:"Search permissions...",variant:"outlined",density:"compact","hide-details":"",class:"mb-4"},null,8,["modelValue"]),v("div",Re,[t(me,{modelValue:B.value,"onUpdate:modelValue":e[6]||(e[6]=n=>B.value=n),multiple:""},{default:l(()=>[(p(!0),k(S,null,G(X.value,n=>(p(),C(ue,{key:n.name,value:n.name},{default:l(()=>[t(ae,null,{default:l(()=>[v("div",Ue,[v("div",Pe,[t(d,{class:"mr-2"},{default:l(()=>[i(r(n.icon),1)]),_:2},1024),v("span",Me,r(n.name),1)]),v("div",Ae,[t(A,{size:"x-small",color:"grey",variant:"tonal",class:"mr-2"},{default:l(()=>[i(r(q(n))+"/"+r(n.permissions.length),1)]),_:2},1024),t(I,{"model-value":ee(n),indeterminate:te(n),"onUpdate:modelValue":m=>K(n,m),density:"compact","hide-details":"",onClick:e[5]||(e[5]=be(()=>{},["stop"]))},null,8,["model-value","indeterminate","onUpdate:modelValue"])])])]),_:2},1024),t(de,null,{default:l(()=>[t(ce,{density:"compact"},{default:l(()=>[(p(!0),k(S,null,G(n.permissions,m=>(p(),C(O,{key:m.key,class:"px-0"},{prepend:l(()=>[t(I,{"model-value":a.value.includes(m.key),"onUpdate:modelValue":ke=>U(m.key,ke),density:"compact","hide-details":""},null,8,["model-value","onUpdate:modelValue"])]),default:l(()=>[t(ie,null,{default:l(()=>[i(r(m.name),1)]),_:2},1024),t(re,null,{default:l(()=>[i(r(m.description),1)]),_:2},1024)]),_:2},1024))),128))]),_:2},1024)]),_:2},1024)]),_:2},1032,["value"]))),128))]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1})]),_:1}),t($,{class:"mt-4"},{default:l(()=>[t(M,{cols:"12"},{default:l(()=>[t(b,{variant:"outlined"},{default:l(()=>[t(x,{class:"text-h6 pb-2"},{default:l(()=>e[13]||(e[13]=[i("Permission Summary")])),_:1,__:[13]}),t(V,null,{default:l(()=>[a.value.length>0?(p(),k("div",Ee,[t(pe,null,{default:l(()=>[(p(!0),k(S,null,G(Y.value,n=>(p(),C(A,{key:n.key,size:"small",color:"primary",variant:"tonal",closable:"","onClick:close":m=>U(n.key,!1)},{default:l(()=>[i(r(n.name),1)]),_:2},1032,["onClick:close"]))),128))]),_:1})])):(p(),k("div",Se," No permissions selected. Please select at least one permission for this role. "))]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(T),t(fe,{class:"pa-6"},{default:l(()=>[t(_e),t(P,{variant:"outlined",onClick:j},{default:l(()=>e[14]||(e[14]=[i(" Cancel ")])),_:1,__:[14]}),t(P,{color:"primary",disabled:!w.value||a.value.length===0,loading:h.value,onClick:Z},{default:l(()=>[i(r(L.value?"Update Role":"Create Role"),1)]),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}};export{De as default};
