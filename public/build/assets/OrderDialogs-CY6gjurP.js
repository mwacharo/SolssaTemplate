import{u as Cl}from"./orderStore-DwKOFngT.js";/* empty css                                                                     */import{_ as hl}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{Q as xl,r as m,j as R,s as Q,l as f,c as g,o as d,w as t,b as a,a as u,t as y,e as N,f as i,d as h,F as Ol,p as Vl,q as Dl,R as Il,u as Sl}from"./app-CUgPE-Lf.js";const Ul={class:"d-flex align-center w-100"},zl={class:"d-flex align-center"},Nl={class:"text-h5 mb-1 text-white"},El={class:"d-flex align-center gap-2"},Pl={class:"d-flex align-center gap-2"},Al={key:0,class:"pa-8 text-center"},$l={class:"text-h6 mt-4"},Fl={key:1},ql={class:"d-flex align-center"},Ml={key:0,class:"d-flex gap-2"},Jl={key:1,class:"d-flex gap-2"},Tl={class:"info-grid"},Rl={class:"info-item"},Wl={key:1,class:"value"},Bl={class:"info-item"},Kl={key:1,class:"value"},Ll={class:"info-item"},jl={class:"info-item"},Ql={class:"info-grid"},Yl={class:"info-item"},Gl={key:1,class:"value"},Hl={class:"info-item"},Xl={key:1,class:"value"},Zl={class:"info-item"},ea={key:1,class:"value"},la={class:"info-item"},aa={key:1,class:"value"},ta={class:"font-weight-bold text-primary"},na={class:"d-flex flex-column gap-3"},oa={class:"d-flex align-center"},ia={class:"d-flex gap-2"},sa={key:1,class:"d-flex gap-2"},ra={key:0,class:"d-flex align-center gap-2"},da={key:1,class:"d-flex align-center"},ua={class:"text-subtitle-2"},va={class:"text-caption text-medium-emphasis"},ca={key:1,class:"text-body-2"},fa={key:1,class:"text-body-2"},ma={class:"text-subtitle-2 font-weight-medium"},pa={key:0,class:"d-flex gap-1"},_a={class:"d-flex justify-end pa-4 bg-surface-variant"},ga={class:"text-h6 font-weight-bold"},ya={key:0,class:"d-flex w-100 gap-3"},ba={key:1,class:"d-flex w-100 gap-3"},wa={__name:"OrderDialogs",props:{createMode:{type:Boolean,default:!1}},setup(qe){const pe=qe,p=Cl(),{dialog:Y}=xl(p),E=m("overview"),_=m(!1),W=m(!1),F=m(!1),oe=m(!1),ie=m(!1),G=m(!1),k=m(!1),H=m(!1),C=m(!1),q=m(!1),v=m({}),B=m({}),b=m([]),P=m({}),s=m(pe.createMode),se=m(null),_e=m([]),ge=m({}),ye=m({}),X=m([]),re=m([]),I=m([]),be=m([]),we=m([]),Me=["Website","Mobile App","Phone","WhatsApp","Facebook","Instagram"],Je=["Inprogress","active","inactive","confirmed","processing","completed","cancelled"],Te=[{title:"Product",key:"product",sortable:!1,width:"250px"},{title:"Quantity",key:"quantity",align:"center",width:"100px"},{title:"Unit Price",key:"price",align:"end",width:"120px"},{title:"Discount",key:"discount",align:"end",width:"120px"},{title:"Total",key:"total_price",align:"end",width:"120px"},{title:"Actions",key:"actions",sortable:!1,align:"center",width:"100px"}],n=R(()=>p.selectedOrder),ke=R(()=>p.loading.orders),S=R(()=>{var l;return s.value||k.value?v.value.vendor_id:x.value.vendor_id||((l=x.value.vendor)==null?void 0:l.id)}),x=R(()=>s.value?{...v.value,orderItems:b.value,client:X.value.find(l=>l.id===v.value.client_id),vendor:re.value.find(l=>l.id===v.value.vendor_id),agent:be.value.find(l=>l.id===v.value.agent_id),rider:we.value.find(l=>l.id===v.value.rider_id)}:n.value||{}),Z=R(()=>k.value||H.value||C.value||q.value||s.value),de=R(()=>s.value&&v.value.client_id&&v.value.vendor_id&&b.value.length>0&&b.value.every(l=>l.product_id&&l.quantity>0));Q(()=>pe.createMode,l=>{s.value=l,l&&Ce()},{immediate:!0}),Q(S,async l=>{l?await ee(l):I.value=[]});function Ce(){v.value={order_no:"",reference:"",platform:"Website",status:"Inprogress",client_id:null,vendor_id:null,agent_id:null,rider_id:null,delivery_date:null,weight:0,customer_notes:""},b.value=[],P.value={shipping_charges:0,charges:0,discount:0,payment_method:"Cash on Delivery",amount_paid:0},B.value={name:"",phone_number:"",email:"",address:"",city:""},he()}async function he(){try{await Promise.all([xe(),Re(),We(),Be()])}catch(l){console.error("Error loading options:",l)}}async function xe(l=""){oe.value=!0;try{await p.loadClientOptions(l),X.value=p.clientOptions||[]}catch(e){console.error("Error loading clients:",e)}finally{oe.value=!1}}async function Re(){ie.value=!0;try{await p.loadVendorOptions(),re.value=p.vendorOptions||[]}catch(l){console.error("Error loading vendors:",l)}finally{ie.value=!1}}async function We(){try{await p.loadAgentOptions(),be.value=p.agentOptions||[]}catch(l){console.error("Error loading agents:",l)}}async function Be(){try{await p.loadRiderOptions(),we.value=p.riderOptions||[]}catch(l){console.error("Error loading riders:",l)}}async function ee(l){if(!l){I.value=[];return}G.value=!0;try{await p.loadVendorProducts(l),I.value=p.productOptions||[]}catch(e){console.error("Error loading vendor products:",e),I.value=[]}finally{G.value=!1}}function Ke(l){l&&l.length>2&&xe(l)}function Le(l){if(l&&(s.value||k.value)){const e=X.value.find(r=>r.id===l);e&&s.value&&(B.value={name:e.name||"",phone_number:e.phone_number||"",email:e.email||"",address:e.address||"",city:e.city||""})}}function je(l){var e;if(console.log("Vendor changed to:",l),(s.value||C.value)&&b.value.length>0)if(confirm("Changing vendor will clear existing items. Continue?"))b.value=[];else{(s.value||k.value)&&(v.value.vendor_id=((e=se.value)==null?void 0:e.vendor_id)||null);return}}function Qe(l){const e=I.value.find(r=>r.id===l.product_id);e&&(l.price=e.price||0,l.product=e,le(l))}function Ye(l){return l?new Date(l).toLocaleDateString():"-"}function K(l){return l==null?"KSh 0.00":new Intl.NumberFormat("en-KE",{style:"currency",currency:"KES",currencyDisplay:"symbol"}).format(l)}function Oe(l){const e={pending:"warning",inprogress:"info",active:"success",confirmed:"success",processing:"primary",completed:"success",cancelled:"error",inactive:"error"};return typeof l=="string"&&e[l.toLowerCase()]||"default"}function U(){var l,e,r,w,V;n.value&&!s.value&&(se.value=JSON.parse(JSON.stringify({reference:n.value.reference,platform:n.value.platform,status:n.value.status,client_id:n.value.client_id,vendor_id:n.value.vendor_id,agent_id:n.value.agent_id,rider_id:n.value.rider_id,delivery_date:n.value.delivery_date,weight:n.value.weight,customer_notes:n.value.customer_notes})),_e.value=JSON.parse(JSON.stringify(n.value.orderItems||[])),ge.value=JSON.parse(JSON.stringify({shipping_charges:n.value.shipping_charges||0,charges:n.value.charges||0,discount:n.value.discount||0,payment_method:n.value.payment_method||"Cash on Delivery",amount_paid:n.value.amount_paid||0})),ye.value=JSON.parse(JSON.stringify({name:((l=n.value.client)==null?void 0:l.name)||"",phone_number:((e=n.value.client)==null?void 0:e.phone_number)||"",email:((r=n.value.client)==null?void 0:r.email)||"",address:((w=n.value.client)==null?void 0:w.address)||"",city:((V=n.value.client)==null?void 0:V.city)||""})))}function Ge(){k.value=!0,v.value={reference:n.value.reference,platform:n.value.platform,status:n.value.status,client_id:n.value.client_id,vendor_id:n.value.vendor_id,agent_id:n.value.agent_id,rider_id:n.value.rider_id,delivery_date:n.value.delivery_date,weight:n.value.weight,customer_notes:n.value.customer_notes}}function He(){k.value=!1,v.value={}}async function Ve(){_.value=!0;try{const l=await p.updateOrder(n.value.id,v.value);k.value=!1,v.value={},U(),console.log("Order updated successfully:",l)}catch(l){console.error("Failed to save order changes:",l)}finally{_.value=!1}}async function Xe(){_.value=!0;try{await p.updateClient(n.value.client.id,B.value),H.value=!1,B.value={},U()}catch(l){console.error("Failed to save client changes:",l)}finally{_.value=!1}}function Ze(){C.value=!0,b.value=JSON.parse(JSON.stringify(n.value.orderItems||[])),S.value&&ee(S.value)}function el(){C.value=!1,b.value=[],I.value=[]}async function De(){_.value=!0;try{const l=b.value.filter(e=>e.product_id&&e.quantity>0&&e.price>=0);if(l.length!==b.value.length)throw new Error("Some items have invalid data. Please check all fields.");await p.updateOrderItems(n.value.id,l),C.value=!1,b.value=[],I.value=[],U()}catch(l){console.error("Failed to save items changes:",l)}finally{_.value=!1}}function ll(){if(!S.value){alert("Please select a vendor first before adding items.");return}const l={id:`temp-${Date.now()}`,product_id:null,quantity:1,price:0,discount:0,total_price:0,product:{product_name:"",sku:""}};b.value.push(l)}function al(l){if(!l.product_id){alert("Please select a product first before duplicating.");return}const e={...JSON.parse(JSON.stringify(l)),id:`temp-${Date.now()}-${Math.random()}`},r=b.value.findIndex(w=>w.id===l.id);b.value.splice(r+1,0,e)}function tl(l){const e=b.value.findIndex(r=>r.id===l.id);e>-1&&b.value.splice(e,1)}function le(l){const e=Number(l.quantity)||0,r=Number(l.price)||0,w=Number(l.discount)||0;l.total_price=Math.max(0,e*r-w)}function ue(){return(C.value||s.value?b.value:x.value.orderItems||[]).reduce((e,r)=>e+(r.total_price||0),0)}async function nl(){_.value=!0;try{await p.updateOrder(n.value.id,P.value),q.value=!1,P.value={},U()}catch(l){console.error("Failed to save charges changes:",l)}finally{_.value=!1}}function ol(){const l=ue(),e=q.value||s.value?P.value:x.value,r=Number(e.shipping_charges)||0,w=Number(e.charges)||0,V=Number(e.discount)||0;return Math.max(0,l+r+w-V)}async function ve(){if(de.value){_.value=!0;try{const l=b.value.filter(w=>w.product_id&&w.quantity>0&&w.price>=0);if(l.length===0)throw new Error("Please add at least one valid item to the order.");const e={...v.value,...P.value,items:l.map(w=>({product_id:w.product_id,quantity:w.quantity,price:w.price,discount:w.discount||0})),sub_total:ue(),total_price:ol()},r=await p.createOrder(e);s.value=!1,p.selectedOrder=r,p.selectedOrderId=r.id,U(),console.log("Order created successfully:",r)}catch(l){console.error("Failed to create order:",l),alert(l.message||"Failed to create order. Please check all required fields.")}finally{_.value=!1}}}function il(){var e,r;const l=(r=(e=x.value)==null?void 0:e.client)==null?void 0:r.phone_number;l&&window.open(`tel:${l}`)}async function Ie(l){if(n.value){_.value=!0;try{await p.updateOrder(n.value.id,{status:l})}catch(e){console.error("Failed to update status:",e)}finally{_.value=!1}}}function Se(){window.print()}function sl(){var l;n.value&&(s.value=!0,v.value={...n.value,order_no:"",reference:`${n.value.reference||n.value.order_no}-COPY`,status:"Inprogress"},b.value=((l=n.value.orderItems)==null?void 0:l.map(e=>({...e,id:`temp-${Date.now()}-${Math.random()}`})))||[],P.value={shipping_charges:n.value.shipping_charges||0,charges:n.value.charges||0,discount:n.value.discount||0,payment_method:n.value.payment_method||"Cash on Delivery",amount_paid:0},v.value.vendor_id&&ee(v.value.vendor_id),E.value="overview")}async function Ue(){if(Z.value){_.value=!0;try{const l=[];k.value&&l.push(Ve()),H.value&&l.push(Xe()),C.value&&l.push(De()),q.value&&l.push(nl()),await Promise.all(l),console.log("All changes saved successfully")}catch(l){console.error("Failed to save all changes:",l)}finally{_.value=!1}}}function ze(){if(Z.value&&!s.value){F.value=!0;return}ae()}function ae(){p.closeDialog(),Ee()}function rl(){F.value=!1,ae()}async function dl(){F.value=!1,s.value?await ve():await Ue(),ae()}function Ne(){k.value=!1,H.value=!1,C.value=!1,q.value=!1,v.value={},B.value={},b.value=[],P.value={},I.value=[]}function Ee(){E.value="overview",s.value=!1,Ne(),se.value=null,_e.value=[],ge.value={},ye.value={}}function ul(){s.value&&(Ce(),E.value="overview")}function vl(){var l;(l=n.value)!=null&&l.id&&p.loadOrder(n.value.id).then(()=>{U()})}function cl(){W.value=!0}async function fl(){if(n.value){_.value=!0;try{await p.deleteOrder(n.value.id),W.value=!1,ae()}catch(l){console.error("Failed to delete order:",l)}finally{_.value=!1}}}return Q(Y,async l=>{var e;l&&!s.value?(await he(),(e=n.value)!=null&&e.vendor_id&&await ee(n.value.vendor_id),U()):l||Ee()}),Q(()=>s.value,l=>{l?(C.value=!0,q.value=!0,k.value=!0):Ne()}),Q(n,()=>{n.value&&!s.value&&U()},{deep:!0}),(l,e)=>{const r=f("v-icon"),w=f("v-avatar"),V=f("v-chip"),c=f("v-btn"),M=f("v-card-title"),Pe=f("v-divider"),ml=f("v-progress-circular"),L=f("v-tab"),pl=f("v-tabs"),A=f("v-text-field"),Ae=f("v-select"),te=f("v-col"),ce=f("v-autocomplete"),$e=f("v-row"),J=f("v-card-text"),T=f("v-card"),j=f("v-tabs-window-item"),_l=f("v-alert"),Fe=f("v-img"),gl=f("v-list-item-title"),yl=f("v-list-item-subtitle"),bl=f("v-list-item"),wl=f("v-data-table"),kl=f("v-tabs-window"),ne=f("v-spacer"),fe=f("v-card-actions"),me=f("v-dialog");return d(),g(me,{modelValue:Sl(Y),"onUpdate:modelValue":e[16]||(e[16]=o=>Il(Y)?Y.value=o:null),"max-width":"1400",persistent:"",scrollable:""},{default:t(()=>[a(T,{class:"order-details-card"},{default:t(()=>[a(M,{class:"pa-6 pb-4 gradient-header"},{default:t(()=>{var o;return[u("div",Ul,[u("div",zl,[a(w,{size:"48",color:"primary",class:"me-4"},{default:t(()=>[a(r,{icon:s.value?"mdi-plus":"mdi-package-variant",size:"24"},null,8,["icon"])]),_:1}),u("div",null,[u("h2",Nl,y(s.value?"Create New Order":((o=n.value)==null?void 0:o.order_no)||"Loading..."),1),u("div",El,[n.value&&!s.value?(d(),g(V,{key:0,color:Oe(n.value.status),variant:"flat",size:"small",class:"font-weight-medium"},{default:t(()=>[i(y(n.value.status),1)]),_:1},8,["color"])):N("",!0),s.value?(d(),g(V,{key:1,color:"info",variant:"flat",size:"small"},{default:t(()=>e[17]||(e[17]=[i(" Draft ")])),_:1,__:[17]})):N("",!0),Z.value?(d(),g(V,{key:2,color:"warning",variant:"flat",size:"small"},{default:t(()=>[a(r,{start:"",size:"14"},{default:t(()=>e[18]||(e[18]=[i("mdi-circle")])),_:1,__:[18]}),e[19]||(e[19]=i(" Unsaved Changes "))]),_:1,__:[19]})):N("",!0)])])]),u("div",Pl,[s.value?N("",!0):(d(),g(c,{key:0,icon:"mdi-refresh",variant:"text",size:"small",color:"white",onClick:vl,loading:ke.value},null,8,["loading"])),a(c,{icon:"mdi-close",variant:"text",size:"small",color:"white",onClick:ze})])])]}),_:1}),a(Pe),a(J,{class:"pa-0"},{default:t(()=>[!n.value&&!s.value||ke.value?(d(),h("div",Al,[a(ml,{indeterminate:"",color:"primary",size:"64"}),u("p",$l,y(s.value?"Preparing new order...":"Loading order details..."),1)])):(d(),h("div",Fl,[a(pl,{modelValue:E.value,"onUpdate:modelValue":e[0]||(e[0]=o=>E.value=o),color:"primary",class:"border-b bg-surface"},{default:t(()=>[a(L,{value:"overview","prepend-icon":"mdi-view-dashboard"},{default:t(()=>e[20]||(e[20]=[u("span",{class:"font-weight-medium"},"Overview",-1)])),_:1,__:[20]}),a(L,{value:"items","prepend-icon":"mdi-cart"},{default:t(()=>[e[21]||(e[21]=u("span",{class:"font-weight-medium"},"Items",-1)),a(V,{size:"x-small",variant:"flat",color:"primary",class:"ml-2"},{default:t(()=>[i(y((x.value.orderItems||[]).length),1)]),_:1})]),_:1,__:[21]}),a(L,{value:"charges","prepend-icon":"mdi-currency-usd"},{default:t(()=>e[22]||(e[22]=[u("span",{class:"font-weight-medium"},"Charges",-1)])),_:1,__:[22]}),a(L,{value:"client","prepend-icon":"mdi-account"},{default:t(()=>e[23]||(e[23]=[u("span",{class:"font-weight-medium"},"Client",-1)])),_:1,__:[23]}),a(L,{value:"fulfillment","prepend-icon":"mdi-truck-delivery"},{default:t(()=>e[24]||(e[24]=[u("span",{class:"font-weight-medium"},"Fulfillment",-1)])),_:1,__:[24]})]),_:1},8,["modelValue"]),a(kl,{modelValue:E.value,"onUpdate:modelValue":e[11]||(e[11]=o=>E.value=o)},{default:t(()=>[a(j,{value:"overview",class:"pa-6"},{default:t(()=>[a($e,null,{default:t(()=>[a(te,{cols:"12",lg:"8"},{default:t(()=>[a(T,{variant:"flat",class:"h-100 elevation-1",style:{background:"#f8fafc"}},{default:t(()=>[a(M,{class:"d-flex align-center justify-space-between pb-2",style:{"border-bottom":"1px solid #e3e8ee"}},{default:t(()=>[u("div",ql,[a(r,{icon:"mdi-clipboard-text",class:"me-2",color:"primary"}),e[25]||(e[25]=u("span",{class:"font-weight-bold text-primary"},"Order Details",-1))]),s.value?N("",!0):(d(),h("div",Ml,[k.value?(d(),h("div",Jl,[a(c,{color:"success",variant:"flat",size:"small",onClick:Ve,loading:_.value},{default:t(()=>[a(r,{start:""},{default:t(()=>e[28]||(e[28]=[i("mdi-check")])),_:1,__:[28]}),e[29]||(e[29]=i(" Save "))]),_:1,__:[29]},8,["loading"]),a(c,{variant:"tonal",size:"small",onClick:He},{default:t(()=>e[30]||(e[30]=[i(" Cancel ")])),_:1,__:[30]})])):(d(),g(c,{key:0,color:"primary",variant:"tonal",size:"small",onClick:Ge},{default:t(()=>[a(r,{start:""},{default:t(()=>e[26]||(e[26]=[i("mdi-pencil")])),_:1,__:[26]}),e[27]||(e[27]=i(" Edit "))]),_:1,__:[27]}))]))]),_:1}),a(J,null,{default:t(()=>[a($e,null,{default:t(()=>[a(te,{cols:"12",md:"6"},{default:t(()=>[u("div",Tl,[u("div",Rl,[e[31]||(e[31]=u("div",{class:"label"},"Order Number",-1)),s.value||k.value?(d(),g(A,{key:0,modelValue:v.value.order_no,"onUpdate:modelValue":e[1]||(e[1]=o=>v.value.order_no=o),variant:"solo",density:"comfortable",placeholder:"AUTO-GENERATED",disabled:!s.value,"hide-details":""},null,8,["modelValue","disabled"])):(d(),h("div",Wl,y(x.value.order_no),1))]),u("div",Bl,[e[32]||(e[32]=u("div",{class:"label"},"Reference",-1)),s.value||k.value?(d(),g(A,{key:0,modelValue:v.value.reference,"onUpdate:modelValue":e[2]||(e[2]=o=>v.value.reference=o),variant:"solo",density:"comfortable",placeholder:"Optional reference","hide-details":""},null,8,["modelValue"])):(d(),h("div",Kl,y(x.value.reference||"-"),1))]),u("div",Ll,[e[33]||(e[33]=u("div",{class:"label"},"Platform",-1)),s.value||k.value?(d(),g(Ae,{key:0,modelValue:v.value.platform,"onUpdate:modelValue":e[3]||(e[3]=o=>v.value.platform=o),items:Me,variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])):(d(),g(V,{key:1,variant:"tonal",size:"small",color:"primary"},{default:t(()=>[i(y(x.value.platform),1)]),_:1}))]),u("div",jl,[e[34]||(e[34]=u("div",{class:"label"},"Status",-1)),s.value||k.value?(d(),g(Ae,{key:0,modelValue:v.value.status,"onUpdate:modelValue":e[4]||(e[4]=o=>v.value.status=o),items:Je,variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])):(d(),g(V,{key:1,color:Oe(x.value.status),variant:"flat",size:"small"},{default:t(()=>[i(y(x.value.status||"Pending"),1)]),_:1},8,["color"]))])])]),_:1}),a(te,{cols:"12",md:"6"},{default:t(()=>{var o,O;return[u("div",Ql,[u("div",Yl,[e[35]||(e[35]=u("div",{class:"label"},"Client",-1)),s.value||k.value?(d(),g(ce,{key:0,modelValue:v.value.client_id,"onUpdate:modelValue":[e[5]||(e[5]=D=>v.value.client_id=D),Le],items:X.value,"item-title":"name","item-value":"id",variant:"solo",density:"comfortable",clearable:"",loading:oe.value,"onUpdate:search":Ke,"hide-details":""},null,8,["modelValue","items","loading"])):(d(),h("div",Gl,y(((o=x.value.client)==null?void 0:o.name)||"-"),1))]),u("div",Hl,[e[36]||(e[36]=u("div",{class:"label"},"Vendor",-1)),s.value||k.value?(d(),g(ce,{key:0,modelValue:v.value.vendor_id,"onUpdate:modelValue":[e[6]||(e[6]=D=>v.value.vendor_id=D),je],items:re.value,"item-title":"company_name","item-value":"id",variant:"solo",density:"comfortable",clearable:"",loading:ie.value,"hide-details":""},null,8,["modelValue","items","loading"])):(d(),h("div",Xl,y(((O=x.value.vendor.name)==null?void 0:O.company_name)||"-"),1))]),u("div",Zl,[e[37]||(e[37]=u("div",{class:"label"},"Delivery Date",-1)),s.value||k.value?(d(),g(A,{key:0,modelValue:v.value.delivery_date,"onUpdate:modelValue":e[7]||(e[7]=D=>v.value.delivery_date=D),type:"date",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])):(d(),h("div",ea,y(Ye(x.value.delivery_date)),1))]),u("div",la,[e[38]||(e[38]=u("div",{class:"label"},"Weight (kg)",-1)),s.value||k.value?(d(),g(A,{key:0,modelValue:v.value.weight,"onUpdate:modelValue":e[8]||(e[8]=D=>v.value.weight=D),type:"number",step:"0.1",variant:"solo",density:"comfortable","hide-details":""},null,8,["modelValue"])):(d(),h("div",aa,y(x.value.weight||0)+" kg",1))])])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(te,{cols:"12",lg:"4"},{default:t(()=>[a(T,{variant:"flat",class:"h-100 elevation-1",style:{background:"linear-gradient(135deg, #e3f2fd 0%, #f8fafc 100%)"}},{default:t(()=>[a(M,{class:"pb-2",style:{"border-bottom":"1px solid #e3e8ee"}},{default:t(()=>[a(r,{icon:"mdi-flash",class:"me-2",color:"primary"}),u("span",ta,y(s.value?"Create Actions":"Quick Actions"),1)]),_:1}),a(J,null,{default:t(()=>{var o;return[u("div",na,[s.value?(d(),g(c,{key:0,color:"success",variant:"flat",block:"",onClick:ve,loading:_.value,disabled:!de.value,class:"rounded-pill",style:{"font-weight":"600"}},{default:t(()=>[a(r,{start:""},{default:t(()=>e[39]||(e[39]=[i("mdi-plus")])),_:1,__:[39]}),e[40]||(e[40]=i(" Create Order "))]),_:1,__:[40]},8,["loading","disabled"])):(d(),h(Ol,{key:1},[a(c,{color:"primary",variant:"flat",block:"",onClick:il,disabled:!((o=x.value.client)!=null&&o.phone_number),class:"rounded-pill",style:{"font-weight":"600"}},{default:t(()=>[a(r,{start:""},{default:t(()=>e[41]||(e[41]=[i("mdi-phone")])),_:1,__:[41]}),e[42]||(e[42]=i(" Call Client "))]),_:1,__:[42]},8,["disabled"]),a(c,{color:"success",variant:"tonal",block:"",onClick:e[9]||(e[9]=O=>Ie("confirmed")),class:"rounded-pill",style:{"font-weight":"600"}},{default:t(()=>[a(r,{start:""},{default:t(()=>e[43]||(e[43]=[i("mdi-check-circle")])),_:1,__:[43]}),e[44]||(e[44]=i(" Confirm Order "))]),_:1,__:[44]}),a(c,{color:"info",variant:"tonal",block:"",onClick:Se,class:"rounded-pill",style:{"font-weight":"600"}},{default:t(()=>[a(r,{start:""},{default:t(()=>e[45]||(e[45]=[i("mdi-printer")])),_:1,__:[45]}),e[46]||(e[46]=i(" Print Order "))]),_:1,__:[46]}),a(c,{color:"warning",variant:"tonal",block:"",onClick:e[10]||(e[10]=O=>Ie("cancelled")),class:"rounded-pill",style:{"font-weight":"600"}},{default:t(()=>[a(r,{start:""},{default:t(()=>e[47]||(e[47]=[i("mdi-cancel")])),_:1,__:[47]}),e[48]||(e[48]=i(" Cancel Order "))]),_:1,__:[48]})],64))])]}),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),a(j,{value:"items",class:"pa-6"},{default:t(()=>[a(T,{variant:"outlined"},{default:t(()=>[a(M,{class:"d-flex align-center justify-space-between"},{default:t(()=>[u("div",oa,[a(r,{icon:"mdi-cart",class:"me-2",color:"primary"}),e[49]||(e[49]=i(" Order Items ")),a(V,{variant:"outlined",size:"small",class:"ml-3"},{default:t(()=>[i(y((x.value.orderItems||[]).length)+" items ",1)]),_:1})]),u("div",ia,[!C.value&&!s.value?(d(),g(c,{key:0,color:"primary",variant:"outlined",size:"small",onClick:Ze},{default:t(()=>[a(r,{start:""},{default:t(()=>e[50]||(e[50]=[i("mdi-pencil")])),_:1,__:[50]}),e[51]||(e[51]=i(" Edit Items "))]),_:1,__:[51]})):N("",!0),a(c,{color:"success",variant:"outlined",size:"small",onClick:ll,disabled:!C.value&&!s.value||!S.value},{default:t(()=>[a(r,{start:""},{default:t(()=>e[52]||(e[52]=[i("mdi-plus")])),_:1,__:[52]}),e[53]||(e[53]=i(" Add Item "))]),_:1,__:[53]},8,["disabled"]),C.value?(d(),h("div",sa,[a(c,{color:"success",variant:"flat",size:"small",onClick:De,loading:_.value},{default:t(()=>[a(r,{start:""},{default:t(()=>e[54]||(e[54]=[i("mdi-check")])),_:1,__:[54]}),e[55]||(e[55]=i(" Save All "))]),_:1,__:[55]},8,["loading"]),a(c,{variant:"outlined",size:"small",onClick:el},{default:t(()=>e[56]||(e[56]=[i(" Cancel ")])),_:1,__:[56]})])):N("",!0)])]),_:1}),a(J,{class:"pa-0"},{default:t(()=>[(C.value||s.value)&&!S.value?(d(),g(_l,{key:0,type:"info",variant:"tonal",class:"ma-4"},{prepend:t(()=>[a(r,null,{default:t(()=>e[57]||(e[57]=[i("mdi-information")])),_:1,__:[57]})]),default:t(()=>[e[58]||(e[58]=i(" Please select a vendor first to add items to this order. "))]),_:1,__:[58]})):(d(),g(wl,{key:1,headers:Te,items:C.value||s.value?b.value:x.value.orderItems||[],class:"order-items-table",loading:_.value||G.value,"loading-text":"Updating items..."},{"item.product":t(({item:o})=>{var O,D;return[C.value||s.value?(d(),h("div",ra,[a(ce,{modelValue:o.product_id,"onUpdate:modelValue":[$=>o.product_id=$,$=>Qe(o)],items:I.value,"item-title":"product_name","item-value":"id",variant:"outlined",density:"compact",style:{"min-width":"200px"},loading:G.value,disabled:!S.value,placeholder:S.value?"Select product":"Select vendor first"},{item:t(({props:$,item:z})=>[a(bl,Vl(Dl($)),{prepend:t(()=>[a(w,{size:"32",rounded:""},{default:t(()=>[a(Fe,{src:z.raw.image_url||"/api/placeholder/32/32",alt:z.raw.product_name},null,8,["src","alt"])]),_:2},1024)]),default:t(()=>[a(gl,null,{default:t(()=>[i(y(z.raw.product_name),1)]),_:2},1024),a(yl,null,{default:t(()=>[i(y(z.raw.sku)+" - "+y(K(z.raw.price)),1)]),_:2},1024)]),_:2},1040)]),_:2},1032,["modelValue","onUpdate:modelValue","items","loading","disabled","placeholder"])])):(d(),h("div",da,[a(w,{size:"40",class:"me-3",rounded:""},{default:t(()=>{var $,z;return[a(Fe,{src:(($=o.product)==null?void 0:$.image_url)||"/api/placeholder/40/40",alt:(z=o.product)==null?void 0:z.product_name},null,8,["src","alt"])]}),_:2},1024),u("div",null,[u("div",ua,y(((O=o.product)==null?void 0:O.product_name)||"-"),1),u("div",va,y(((D=o.product)==null?void 0:D.sku)||"-"),1)])]))]}),"item.quantity":t(({item:o})=>[C.value||s.value?(d(),g(A,{key:0,modelValue:o.quantity,"onUpdate:modelValue":O=>o.quantity=O,modelModifiers:{number:!0},type:"number",min:"1",variant:"outlined",density:"compact",style:{width:"80px"},onInput:O=>le(o)},null,8,["modelValue","onUpdate:modelValue","onInput"])):(d(),g(V,{key:1,variant:"outlined",size:"small"},{default:t(()=>[i(y(o.quantity||0),1)]),_:2},1024))]),"item.price":t(({item:o})=>[C.value||s.value?(d(),g(A,{key:0,modelValue:o.price,"onUpdate:modelValue":O=>o.price=O,modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",variant:"outlined",density:"compact",prefix:"KSh",style:{width:"120px"},onInput:O=>le(o)},null,8,["modelValue","onUpdate:modelValue","onInput"])):(d(),h("div",ca,y(K(o.price)),1))]),"item.discount":t(({item:o})=>[C.value||s.value?(d(),g(A,{key:0,modelValue:o.discount,"onUpdate:modelValue":O=>o.discount=O,modelModifiers:{number:!0},type:"number",step:"0.01",min:"0",variant:"outlined",density:"compact",prefix:"KSh",style:{width:"120px"},onInput:O=>le(o)},null,8,["modelValue","onUpdate:modelValue","onInput"])):(d(),h("div",fa,y(K(o.discount||0)),1))]),"item.total_price":t(({item:o})=>[u("div",ma,y(K(o.total_price)),1)]),"item.actions":t(({item:o})=>[C.value||s.value?(d(),h("div",pa,[a(c,{icon:"mdi-content-duplicate",variant:"text",size:"small",onClick:O=>al(o),disabled:!o.product_id},null,8,["onClick","disabled"]),a(c,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:O=>tl(o)},null,8,["onClick"])])):N("",!0)]),bottom:t(()=>[u("div",_a,[u("div",ga," Total: "+y(K(ue())),1)])]),_:1},8,["items","loading"]))]),_:1})]),_:1})]),_:1}),a(j,{value:"charges",class:"pa-6"}),a(j,{value:"client",class:"pa-6"}),a(j,{value:"fulfillment",class:"pa-6"})]),_:1},8,["modelValue"])]))]),_:1}),a(Pe),a(fe,{class:"pa-6"},{default:t(()=>[s.value?(d(),h("div",ya,[a(c,{variant:"outlined",onClick:ul},{default:t(()=>[a(r,{icon:"mdi-refresh",start:""}),e[59]||(e[59]=i(" Reset Form "))]),_:1,__:[59]}),a(ne),a(c,{variant:"outlined",onClick:ze},{default:t(()=>e[60]||(e[60]=[i(" Cancel ")])),_:1,__:[60]}),a(c,{color:"success",variant:"flat",onClick:ve,loading:_.value,disabled:!de.value},{default:t(()=>[a(r,{icon:"mdi-plus",start:""}),e[61]||(e[61]=i(" Create Order "))]),_:1,__:[61]},8,["loading","disabled"])])):(d(),h("div",ba,[a(c,{color:"error",variant:"outlined",onClick:cl,disabled:!n.value},{default:t(()=>[a(r,{icon:"mdi-delete",start:""}),e[62]||(e[62]=i(" Delete Order "))]),_:1,__:[62]},8,["disabled"]),a(c,{color:"info",variant:"outlined",onClick:sl,disabled:!n.value},{default:t(()=>[a(r,{icon:"mdi-content-duplicate",start:""}),e[63]||(e[63]=i(" Duplicate Order "))]),_:1,__:[63]},8,["disabled"]),a(ne),a(c,{variant:"outlined",onClick:Se,disabled:!n.value,class:"me-3"},{default:t(()=>[a(r,{icon:"mdi-printer",start:""}),e[64]||(e[64]=i(" Print "))]),_:1,__:[64]},8,["disabled"]),a(c,{color:"primary",variant:"flat",onClick:Ue,disabled:!n.value||!Z.value,loading:_.value},{default:t(()=>[a(r,{icon:"mdi-content-save",start:""}),e[65]||(e[65]=i(" Save All Changes "))]),_:1,__:[65]},8,["disabled","loading"])]))]),_:1})]),_:1}),a(me,{modelValue:W.value,"onUpdate:modelValue":e[13]||(e[13]=o=>W.value=o),"max-width":"400"},{default:t(()=>[a(T,null,{default:t(()=>[a(M,{class:"text-h6"},{default:t(()=>[a(r,{icon:"mdi-alert",color:"error",class:"me-2"}),e[66]||(e[66]=i(" Confirm Delete "))]),_:1,__:[66]}),a(J,null,{default:t(()=>e[67]||(e[67]=[i(" Are you sure you want to delete this order? This action cannot be undone. ")])),_:1,__:[67]}),a(fe,null,{default:t(()=>[a(ne),a(c,{variant:"text",onClick:e[12]||(e[12]=o=>W.value=!1)},{default:t(()=>e[68]||(e[68]=[i("Cancel")])),_:1,__:[68]}),a(c,{color:"error",variant:"flat",onClick:fl,loading:_.value},{default:t(()=>e[69]||(e[69]=[i(" Delete ")])),_:1,__:[69]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),a(me,{modelValue:F.value,"onUpdate:modelValue":e[15]||(e[15]=o=>F.value=o),"max-width":"400"},{default:t(()=>[a(T,null,{default:t(()=>[a(M,{class:"text-h6"},{default:t(()=>[a(r,{icon:"mdi-alert",color:"warning",class:"me-2"}),e[70]||(e[70]=i(" Unsaved Changes "))]),_:1,__:[70]}),a(J,null,{default:t(()=>e[71]||(e[71]=[i(" You have unsaved changes. What would you like to do? ")])),_:1,__:[71]}),a(fe,null,{default:t(()=>[a(c,{variant:"text",onClick:rl},{default:t(()=>e[72]||(e[72]=[i(" Discard Changes ")])),_:1,__:[72]}),a(ne),a(c,{variant:"text",onClick:e[14]||(e[14]=o=>F.value=!1)},{default:t(()=>e[73]||(e[73]=[i(" Continue Editing ")])),_:1,__:[73]}),a(c,{color:"primary",variant:"flat",onClick:dl,loading:_.value},{default:t(()=>e[74]||(e[74]=[i(" Save & Close ")])),_:1,__:[74]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"])}}},Oa=hl(wa,[["__scopeId","data-v-adb0b470"]]);export{Oa as default};
