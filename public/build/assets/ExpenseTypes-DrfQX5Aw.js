import{E as $,i as f,r as g,k as N,c as U,o as n,w as T,a as e,d,e as k,u as _,F as E,g as D,t as u,n as z,y as q,A as v,C as I,B as C,D as O}from"./app-BgN-NH3l.js";import{n as m}from"./toast-9uxjh2Uk.js";import{_ as R}from"./AppLayout-BDylVQAm.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-Cw8ZtQEb.js";import"./africastalking-CkgtxRYw.js";import"./IncomingCallDialog-CyiVs-h9.js";/* empty css                                                                           */const P=$("expenseType",{state:()=>({types:[],categories:[],loading:!1,error:null}),getters:{getTypeById:o=>s=>o.types.find(r=>r.id===s),orderLevelTypes:o=>o.types.filter(s=>s.is_order_level),itemLevelTypes:o=>o.types.filter(s=>!s.is_order_level),getTypesByCategory:o=>s=>o.types.filter(r=>r.expense_category_id===s),hasTypes:o=>o.types.length>0},actions:{async fetchTypes(){this.loading=!0,this.error=null;try{const o=await f.get("/api/v1/expense-types");this.types=o.data.data||o.data}catch(o){this.error=o.message,m.error("Failed to fetch expense types"),console.error("Error fetching types:",o)}finally{this.loading=!1}},async fetchCategories(){try{const o=await f.get("/api/v1/expense-categories");this.categories=o.data.data||o.data}catch(o){m.error("Failed to fetch expense categories"),console.error("Error fetching categories:",o)}},async createType(o){this.loading=!0,this.error=null;try{const s=await f.post("/api/v1/expense-types",o);return this.types.push(s.data.data||s.data),m.success("Expense type created successfully"),s.data}catch(s){throw this.error=s.message,m.error("Failed to create expense type"),console.error("Error creating type:",s),s}finally{this.loading=!1}},async updateType(o,s){this.loading=!0,this.error=null;try{const r=await f.put(`/api/v1/expense-types/${o}`,s),p=this.types.findIndex(c=>c.id===o);return p!==-1&&(this.types[p]=r.data.data||r.data),m.success("Expense type updated successfully"),r.data}catch(r){throw this.error=r.message,m.error("Failed to update expense type"),console.error("Error updating type:",r),r}finally{this.loading=!1}},async deleteType(o){this.loading=!0,this.error=null;try{await f.delete(`/api/v1/expense-types/${o}`),this.types=this.types.filter(s=>s.id!==o),m.success("Expense type deleted successfully")}catch(s){throw this.error=s.message,m.error("Failed to delete expense type"),console.error("Error deleting type:",s),s}finally{this.loading=!1}},resetError(){this.error=null}}}),G={class:"py-12"},H={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},J={class:"bg-white overflow-hidden shadow-xl sm:rounded-lg"},K={key:0,class:"p-6 text-center"},Q={key:1,class:"overflow-x-auto"},W={class:"min-w-full divide-y divide-gray-200"},X={class:"bg-white divide-y divide-gray-200"},Y={class:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900"},Z={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ee={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},te={class:"bg-gray-100 px-2 py-1 rounded text-xs"},se={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},oe={class:"px-6 py-4 whitespace-nowrap text-sm text-gray-500"},ae={class:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium"},le=["onClick"],re=["onClick"],ie={key:0},ne={key:0,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},de={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ue={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},pe={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},ce={class:"text-lg leading-6 font-medium text-gray-900 mb-4",id:"modal-title"},me={class:"space-y-4"},ge=["value"],xe={class:"flex items-center"},ye={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},fe=["disabled"],ve={key:0},be={key:1},he=["disabled"],_e={key:1,class:"fixed z-10 inset-0 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},we={class:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},ke={class:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},Ce={class:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},Te={class:"sm:flex sm:items-start"},Ee={class:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left"},De={class:"mt-2"},Me={class:"text-sm text-gray-500"},Fe={class:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},je=["disabled"],Ae={key:0},Le={key:1},Se=["disabled"],Oe={__name:"ExpenseTypes",setup(o){const s=P(),r=g(!1),p=g(!1),c=g(!1),x=g(!1),y=g(!1),b=g(null),l=g({id:null,expense_category_id:"",display_name:"",slug:"",is_order_level:!1,default_vat_rate:16});N(async()=>{await s.fetchCategories(),await s.fetchTypes()});const M=i=>{const t=s.categories.find(h=>h.id===i);return t?t.name:"N/A"},F=()=>{!c.value&&l.value.display_name&&(l.value.slug=l.value.display_name.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,""))},j=()=>{c.value=!1,l.value={id:null,expense_category_id:"",display_name:"",slug:"",is_order_level:!1,default_vat_rate:16},r.value=!0},A=i=>{c.value=!0,l.value={id:i.id,expense_category_id:i.expense_category_id,display_name:i.display_name,slug:i.slug,is_order_level:i.is_order_level,default_vat_rate:parseFloat(i.default_vat_rate)},r.value=!0},w=()=>{r.value=!1,l.value={id:null,expense_category_id:"",display_name:"",slug:"",is_order_level:!1,default_vat_rate:16}},L=async()=>{x.value=!0;try{c.value?await s.updateType(l.value.id,l.value):await s.createType(l.value),w()}catch(i){console.error("Form submission error:",i)}finally{x.value=!1}},S=i=>{b.value=i,p.value=!0},V=async()=>{y.value=!0;try{await s.deleteType(b.value.id),p.value=!1,b.value=null}catch(i){console.error("Delete error:",i)}finally{y.value=!1}};return(i,t)=>(n(),U(R,{title:"Expense Types"},{header:T(()=>t[7]||(t[7]=[e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"}," Expense Types ",-1)])),default:T(()=>{var h;return[e("div",G,[e("div",H,[e("div",J,[e("div",{class:"p-6 sm:px-8 bg-white border-b border-gray-200"},[e("div",{class:"flex justify-between items-center"},[t[8]||(t[8]=e("h3",{class:"text-lg font-medium text-gray-900"}," Manage Expense Types ",-1)),e("button",{onClick:j,class:"inline-flex items-center px-4 py-2 bg-indigo-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-indigo-700 focus:bg-indigo-700 active:bg-indigo-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 transition ease-in-out duration-150"}," Add Expense Type ")])]),_(s).loading?(n(),d("div",K,t[9]||(t[9]=[e("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"},null,-1),e("p",{class:"mt-2 text-sm text-gray-500"},"Loading expense types...",-1)]))):(n(),d("div",Q,[e("table",W,[t[11]||(t[11]=e("thead",{class:"bg-gray-50"},[e("tr",null,[e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Display Name "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Category "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Slug "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Level "),e("th",{scope:"col",class:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," VAT Rate "),e("th",{scope:"col",class:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"}," Actions ")])],-1)),e("tbody",X,[(n(!0),d(E,null,D(_(s).types,a=>(n(),d("tr",{key:a.id},[e("td",Y,u(a.display_name),1),e("td",Z,u(M(a.expense_category_id)),1),e("td",ee,[e("code",te,u(a.slug),1)]),e("td",se,[e("span",{class:z([a.is_order_level?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800","px-2 inline-flex text-xs leading-5 font-semibold rounded-full"])},u(a.is_order_level?"Order":"Item"),3)]),e("td",oe,u(a.default_vat_rate)+"% ",1),e("td",ae,[e("button",{onClick:B=>A(a),class:"text-indigo-600 hover:text-indigo-900 mr-4"}," Edit ",8,le),e("button",{onClick:B=>S(a),class:"text-red-600 hover:text-red-900"}," Delete ",8,re)])]))),128)),_(s).hasTypes?k("",!0):(n(),d("tr",ie,t[10]||(t[10]=[e("td",{colspan:"6",class:"px-6 py-4 text-center text-sm text-gray-500"},' No expense types found. Click "Add Expense Type" to create one. ',-1)])))])])]))])])]),r.value?(n(),d("div",ne,[e("div",de,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:w}),t[20]||(t[20]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",ue,[e("form",{onSubmit:q(L,["prevent"])},[e("div",pe,[e("h3",ce,u(c.value?"Edit":"Create")+" Expense Type ",1),e("div",me,[e("div",null,[t[13]||(t[13]=e("label",{for:"expense_category_id",class:"block text-sm font-medium text-gray-700"},"Expense Category *",-1)),v(e("select",{id:"expense_category_id","onUpdate:modelValue":t[0]||(t[0]=a=>l.value.expense_category_id=a),required:"",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"},[t[12]||(t[12]=e("option",{value:""},"Select a category",-1)),(n(!0),d(E,null,D(_(s).categories,a=>(n(),d("option",{key:a.id,value:a.id},u(a.name),9,ge))),128))],512),[[I,l.value.expense_category_id]])]),e("div",null,[t[14]||(t[14]=e("label",{for:"display_name",class:"block text-sm font-medium text-gray-700"},"Display Name *",-1)),v(e("input",{type:"text",id:"display_name","onUpdate:modelValue":t[1]||(t[1]=a=>l.value.display_name=a),onInput:F,required:"",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., Transportation Cost"},null,544),[[C,l.value.display_name]])]),e("div",null,[t[15]||(t[15]=e("label",{for:"slug",class:"block text-sm font-medium text-gray-700"},"Slug *",-1)),v(e("input",{type:"text",id:"slug","onUpdate:modelValue":t[2]||(t[2]=a=>l.value.slug=a),required:"",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., transportation-cost"},null,512),[[C,l.value.slug]]),t[16]||(t[16]=e("p",{class:"mt-1 text-xs text-gray-500"}," Auto-generated from display name. Use lowercase letters, numbers, and hyphens only. ",-1))]),e("div",null,[t[17]||(t[17]=e("label",{for:"default_vat_rate",class:"block text-sm font-medium text-gray-700"},"Default VAT Rate (%) *",-1)),v(e("input",{type:"number",id:"default_vat_rate","onUpdate:modelValue":t[3]||(t[3]=a=>l.value.default_vat_rate=a),required:"",step:"0.01",min:"0",max:"100",class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"e.g., 16.00"},null,512),[[C,l.value.default_vat_rate,void 0,{number:!0}]])]),e("div",xe,[v(e("input",{type:"checkbox",id:"is_order_level","onUpdate:modelValue":t[4]||(t[4]=a=>l.value.is_order_level=a),class:"h-4 w-4 text-indigo-600 focus:ring-indigo-500 border-gray-300 rounded"},null,512),[[O,l.value.is_order_level]]),t[18]||(t[18]=e("label",{for:"is_order_level",class:"ml-2 block text-sm text-gray-900"}," Order Level Expense ",-1))]),t[19]||(t[19]=e("p",{class:"text-xs text-gray-500 ml-6"}," Check if this expense applies to the entire order rather than individual items. ",-1))])]),e("div",ye,[e("button",{type:"submit",disabled:x.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-indigo-600 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[x.value?(n(),d("span",be,"Processing...")):(n(),d("span",ve,u(c.value?"Update":"Create"),1))],8,fe),e("button",{type:"button",onClick:w,disabled:x.value,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,he)])],32)])])])):k("",!0),p.value?(n(),d("div",_e,[e("div",we,[e("div",{class:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:t[5]||(t[5]=a=>p.value=!1)}),t[23]||(t[23]=e("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​",-1)),e("div",ke,[e("div",Ce,[e("div",Te,[t[22]||(t[22]=e("div",{class:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10"},[e("svg",{class:"h-6 w-6 text-red-600",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})])],-1)),e("div",Ee,[t[21]||(t[21]=e("h3",{class:"text-lg leading-6 font-medium text-gray-900"}," Delete Expense Type ",-1)),e("div",De,[e("p",Me,' Are you sure you want to delete "'+u((h=b.value)==null?void 0:h.display_name)+'"? This action cannot be undone. ',1)])])])]),e("div",Fe,[e("button",{type:"button",onClick:V,disabled:y.value,class:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"},[y.value?(n(),d("span",Le,"Deleting...")):(n(),d("span",Ae,"Delete"))],8,je),e("button",{type:"button",onClick:t[6]||(t[6]=a=>p.value=!1),disabled:y.value,class:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"}," Cancel ",8,Se)])])])])):k("",!0)]}),_:1}))}};export{Oe as default};
