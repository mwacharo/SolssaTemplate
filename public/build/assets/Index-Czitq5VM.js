import{r as g,j as E,k as X,i as M,s as G,l as $,c as A,o as r,w as H,a as e,d as p,e as N,t as l,b as c,f as F,u,A as m,B as b,C as J,F as P,g as D,n as k,y as Y}from"./app-zwK4OLfW.js";import{_ as Z}from"./AppLayout-CLi_itcX.js";import{u as ee}from"./orderStore-C3IdR27d.js";import{P as te,C as se,E as le,S as oe,a as ne}from"./square-pen-DjPY_m6o.js";import{S as ae,F as re}from"./search-CXPwkMq6.js";import{T as ie,P as de}from"./truck-CdjLAajW.js";import{c as ue}from"./createLucideIcon-cjPlHfz9.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-LGI2K5EP.js";import"./africastalking-CqpzLgYV.js";import"./IncomingCallDialog-DnywBCnu.js";/* empty css                                                                           *//**
 * @license lucide-vue-next v0.540.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=ue("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ce={class:"min-h-screen bg-gray-50 p-6"},me={class:"max-w-7xl mx-auto"},ve={class:"bg-white rounded-lg shadow-sm p-6 mb-6"},ge={class:"flex justify-between items-center mb-6"},be={class:"text-gray-600 mt-1"},xe={class:"flex flex-col md:flex-row gap-4"},ye={class:"flex-1 relative"},_e={class:"flex items-center gap-2"},fe={class:"bg-white rounded-lg shadow-sm overflow-hidden"},he={class:"overflow-x-auto"},we={class:"w-full"},ke={class:"px-4 py-3"},Ce={class:"px-4 py-3"},Ve={class:"flex items-center gap-2"},Se={class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white text-sm"},Ee={class:"text-sm"},Pe={class:"px-4 py-3"},De={class:"px-4 py-3"},Ue={class:"px-4 py-3"},qe={class:"text-orange-600 hover:text-orange-700"},ze={class:"px-4 py-3"},Ae={class:"flex items-center gap-2"},Ne={class:"text-2xl"},Fe={class:"text-sm"},Me={class:"px-4 py-3"},$e={class:"px-4 py-3"},je={class:"px-4 py-3"},Te={class:"px-4 py-3"},Oe={class:"px-4 py-3"},Be={class:"px-4 py-3"},Ie={class:"px-4 py-3"},Le={class:"text-sm"},We={class:"px-4 py-3"},Ke={class:"flex gap-2"},Qe=["onClick"],Re={class:"p-2 hover:bg-gray-100 rounded-lg",title:"Edit"},Xe={class:"border-t p-4 flex justify-between items-center"},Ge={class:"text-sm text-gray-600"},He={class:"flex gap-2"},Je=["disabled"],Ye=["onClick"],Ze=["disabled"],et={key:0,class:"fixed inset-0 bg-grey bg-opacity-50 flex items-center justify-center z-50 p-4"},tt={class:"bg-white rounded-lg w-full max-w-2xl max-h-[90vh] overflow-y-auto"},st={class:"grid grid-cols-2 gap-4"},lt={class:"bg-gray-50 rounded-lg p-4"},ot={class:"overflow-x-auto mt-4"},nt={class:"w-full text-sm"},at={class:"px-3 py-2"},rt={class:"px-3 py-2"},it=["onUpdate:modelValue"],dt={class:"px-3 py-2"},ut=["onClick"],pt={key:0},ct={class:"pt-4 flex justify-between items-center"},mt={class:"text-sm text-gray-600"},vt={class:"flex gap-3 justify-end pt-4"},gt={key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4"},bt={class:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] overflow-y-auto"},xt={class:"sticky top-0 bg-white border-b p-6"},yt={class:"flex justify-between items-center"},_t={class:"text-2xl font-bold"},ft={class:"p-6 space-y-6"},ht={class:"bg-gray-50 rounded-lg p-4"},wt={class:"grid grid-cols-2 gap-4"},kt={class:"font-semibold"},Ct={class:"font-semibold"},Vt={class:"font-semibold"},St={class:"font-semibold"},Et={class:"font-semibold"},Pt={class:"font-semibold"},Dt={class:"font-semibold"},Ut={class:"font-semibold"},qt={class:"font-semibold"},zt={class:"bg-gray-50 rounded-lg p-4"},At={class:"font-semibold text-lg mb-4"},Nt={class:"space-y-3"},Ft={class:"font-medium"},Mt={class:"text-sm text-gray-600"},$t={class:"bg-gray-50 rounded-lg p-4"},jt={class:"grid grid-cols-2 gap-4"},Tt={class:"font-semibold"},Ot={class:"font-semibold"},C=6,es={__name:"Index",setup(Bt){const y=ee();g(null);const j=o=>{const t=y.productOptions.find(v=>v.sku===o.product.sku);t&&(o.product.name=t.product_name)},T=o=>{n.value.shipment_items.splice(o,1)},_=g([]),a=g(null),V=g(!1),U=g(!1),f=g(""),h=g("all"),i=g(1),O=E(()=>y.vendorOptions),q=g(null),n=g({source_country:"",destination:"",warehouse_id:null,shipment_date:"",arrival_date:"",transporter_name:"",tracking_number:"",packages_number:1,weight:0,shipment_fees:0,vendor_id:null,shipment_items:[]});X(async()=>{try{await y.fetchDropdownOptions()}catch(o){console.error("Failed to load vendors:",o)}try{const o=await M.get("/api/v1/expeditions");_.value=o.data.expeditions.data??[]}catch(o){console.error("Failed to load expeditions:",o),_.value=[]}});const w=E(()=>{let o=_.value;if(f.value){const t=f.value.toLowerCase();o=o.filter(v=>{var S,s,d;return((S=v.tracking_number)==null?void 0:S.toLowerCase().includes(t))||((s=v.source_country)==null?void 0:s.toLowerCase().includes(t))||((d=v.transporter_name)==null?void 0:d.toLowerCase().includes(t))})}return h.value!=="all"&&(o=o.filter(t=>t.shipment_status===h.value)),o}),z=E(()=>Math.ceil(w.value.length/C)),B=E(()=>{const o=(i.value-1)*C,t=i.value*C;return w.value.slice(o,t)});G([f,h],()=>{i.value=1});const I=o=>({expedited:"bg-orange-500",delivered:"bg-green-500",pending:"bg-yellow-500",cancelled:"bg-red-500"})[o]||"bg-gray-500",L=o=>({approved:"bg-green-500",pending:"bg-yellow-500",draft:"bg-gray-500"})[o]||"bg-gray-500",W=o=>({Nigeria:"ðŸ‡³ðŸ‡¬",China:"ðŸ‡¨ðŸ‡³"})[o]||"ðŸŒ",K=o=>{n.value.vendor_id=o},Q=async()=>{var o;try{const v=(await M.post("/api/v1/expeditions",n.value)).data.expedition;_.value=[v,..._.value],V.value=!1,n.value={source_country:"",destination:"",warehouse_id:null,shipment_date:"",arrival_date:"",transporter_name:"",tracking_number:"",packages_number:1,weight:0,shipment_fees:0,vendor_id:null,shipment_items:[]},q.value=null}catch(t){console.error("Failed to create expedition:",t),((o=t.response)==null?void 0:o.status)===422&&console.log("Validation Errors:",t.response.data.errors)}},R=o=>{a.value=o,U.value=!0};return(o,t)=>{const v=$("v-select"),S=$("v-autocomplete");return r(),A(Z,null,{default:H(()=>[e("div",ce,[e("div",me,[e("div",ve,[e("div",ge,[e("div",null,[t[18]||(t[18]=e("h1",{class:"text-3xl font-bold text-gray-800"}," Expeditions ",-1)),e("p",be,l(w.value.length)+" total expeditions ",1)]),e("button",{onClick:t[0]||(t[0]=s=>V.value=!0),class:"flex items-center gap-2 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition"},[c(u(te),{size:20}),t[19]||(t[19]=F(" Add Expedition "))])]),e("div",xe,[e("div",ye,[c(u(ae),{class:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),m(e("input",{type:"text",placeholder:"Search by tracking, country, or transporter...",class:"w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[1]||(t[1]=s=>f.value=s)},null,512),[[b,f.value]])]),e("div",_e,[c(u(re),{size:20,class:"text-gray-400"}),m(e("select",{class:"border rounded-lg px-4 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[2]||(t[2]=s=>h.value=s)},t[20]||(t[20]=[e("option",{value:"all"},"All Status",-1),e("option",{value:"expedited"},"Expedited",-1),e("option",{value:"pending"},"Pending",-1),e("option",{value:"delivered"},"Delivered",-1),e("option",{value:"cancelled"},"Cancelled",-1)]),512),[[J,h.value]])])])]),e("div",fe,[e("div",he,[e("table",we,[t[21]||(t[21]=e("thead",{class:"bg-blue-600 text-white"},[e("tr",null,[e("th",{class:"px-4 py-3 text-left"},"ID"),e("th",{class:"px-4 py-3 text-left"},"Seller"),e("th",{class:"px-4 py-3 text-left"},"Weight"),e("th",{class:"px-4 py-3 text-left"}," Packages "),e("th",{class:"px-4 py-3 text-left"},"Details"),e("th",{class:"px-4 py-3 text-left"},"From"),e("th",{class:"px-4 py-3 text-left"},"To"),e("th",{class:"px-4 py-3 text-left"}," Expedition Date "),e("th",{class:"px-4 py-3 text-left"}," Arrival Date "),e("th",{class:"px-4 py-3 text-left"},"Fees"),e("th",{class:"px-4 py-3 text-left"},"Status"),e("th",{class:"px-4 py-3 text-left"}," Approval "),e("th",{class:"px-4 py-3 text-left"}," Remittance "),e("th",{class:"px-4 py-3 text-left"},"Actions")])],-1)),e("tbody",null,[(r(!0),p(P,null,D(B.value,(s,d)=>(r(),p("tr",{key:s.id,class:k(d%2===0?"bg-amber-50":"bg-white")},[e("td",ke,l(s.id),1),e("td",Ce,[e("div",Ve,[e("div",Se,l(s.seller.first_name[0]),1),e("span",Ee,l(s.seller.username),1)])]),e("td",Pe,l(s.weight),1),e("td",De,l(s.packages_number),1),e("td",Ue,[e("button",qe,l(s.shipment_items.length)+" products ",1)]),e("td",ze,[e("div",Ae,[e("span",Ne,l(W(s.source_country)),1),e("span",Fe,l(s.source_country),1)])]),e("td",Me,l(s.warehouse.name),1),e("td",$e,l(s.shipment_date),1),e("td",je,l(s.arrival_date.split(" ")[0]),1),e("td",Te,l(s.shipment_fees)+" KES ",1),e("td",Oe,[e("span",{class:k(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs text-white",I(s.shipment_status)])},[c(u(ie),{size:12}),F(" "+l(s.shipment_status),1)],2)]),e("td",Be,[e("span",{class:k(["inline-flex items-center gap-1 px-3 py-1 rounded-full text-xs text-white",L(s.approval_status)])},[s.approval_status==="approved"?(r(),A(u(se),{key:0,size:12})):(r(),A(u(pe),{key:1,size:12})),F(" "+l(s.approval_status),1)],2)]),e("td",Ie,[e("span",Le,l(s.transporter_reimbursement_status==="paid"?"Paid by seller":"Not paid"),1)]),e("td",We,[e("div",Ke,[e("button",{onClick:x=>R(s),class:"p-2 hover:bg-gray-100 rounded-lg",title:"View Details"},[c(u(le),{size:18,class:"text-gray-600"})],8,Qe),e("button",Re,[c(u(oe),{size:18,class:"text-gray-600"})])])])],2))),128))])])]),e("div",Xe,[e("div",Ge," Showing "+l((i.value-1)*C+1)+" to "+l(Math.min(i.value*C,w.value.length))+" of "+l(w.value.length)+" expeditions ",1),e("div",He,[e("button",{onClick:t[3]||(t[3]=s=>i.value=Math.max(1,i.value-1)),disabled:i.value===1,class:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Previous ",8,Je),(r(!0),p(P,null,D(z.value,s=>(r(),p("button",{key:s,onClick:d=>i.value=s,class:k(["px-4 py-2 rounded-lg",i.value===s?"bg-blue-600 text-white":"border hover:bg-gray-50"])},l(s),11,Ye))),128)),e("button",{onClick:t[4]||(t[4]=s=>i.value=Math.min(z.value,i.value+1)),disabled:i.value===z.value,class:"px-4 py-2 border rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"}," Next ",8,Ze)])])])]),V.value?(r(),p("div",et,[e("div",tt,[t[35]||(t[35]=e("div",{class:"sticky top-0 bg-white border-b p-6"},[e("h2",{class:"text-2xl font-bold"},"Add New Expedition")],-1)),e("form",{onSubmit:Y(Q,["prevent"]),class:"p-6 space-y-4"},[e("div",st,[e("div",null,[t[22]||(t[22]=e("label",{class:"block text-sm font-medium mb-2"},"Source Country",-1)),m(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[5]||(t[5]=s=>n.value.source_country=s)},null,512),[[b,n.value.source_country]])]),e("div",null,[t[23]||(t[23]=e("label",{class:"block text-sm font-medium mb-2"},"Destination",-1)),c(v,{modelValue:n.value.warehouse_id,"onUpdate:modelValue":t[6]||(t[6]=s=>n.value.warehouse_id=s),items:u(y).warehouseOptions,"item-title":"name","item-value":"id",label:"Destination Warehouse","prepend-inner-icon":"mdi-warehouse",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),e("div",null,[t[24]||(t[24]=e("label",{class:"block text-sm font-medium mb-2"},"Shipment Date",-1)),m(e("input",{type:"date",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[7]||(t[7]=s=>n.value.shipment_date=s)},null,512),[[b,n.value.shipment_date]])]),e("div",null,[t[25]||(t[25]=e("label",{class:"block text-sm font-medium mb-2"},"Expected Arrival",-1)),m(e("input",{type:"date",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[8]||(t[8]=s=>n.value.arrival_date=s)},null,512),[[b,n.value.arrival_date]])]),e("div",null,[t[26]||(t[26]=e("label",{class:"block text-sm font-medium mb-2"},"Transporter",-1)),m(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[9]||(t[9]=s=>n.value.transporter_name=s)},null,512),[[b,n.value.transporter_name]])]),e("div",null,[t[27]||(t[27]=e("label",{class:"block text-sm font-medium mb-2"},"Tracking Number",-1)),m(e("input",{type:"text",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[10]||(t[10]=s=>n.value.tracking_number=s)},null,512),[[b,n.value.tracking_number]])]),e("div",null,[t[28]||(t[28]=e("label",{class:"block text-sm font-medium mb-2"},"Packages",-1)),m(e("input",{type:"number",min:"1",required:"",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[11]||(t[11]=s=>n.value.packages_number=s)},null,512),[[b,n.value.packages_number,void 0,{number:!0}]])]),e("div",null,[t[29]||(t[29]=e("label",{class:"block text-sm font-medium mb-2"},"Weight (kg)",-1)),m(e("input",{type:"number",min:"0",step:"0.1",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[12]||(t[12]=s=>n.value.weight=s)},null,512),[[b,n.value.weight,void 0,{number:!0}]])]),e("div",null,[t[30]||(t[30]=e("label",{class:"block text-sm font-medium mb-2"},"Shipment Fees (KES)",-1)),m(e("input",{type:"number",min:"0",class:"w-full border rounded-lg px-3 py-2 focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":t[13]||(t[13]=s=>n.value.shipment_fees=s)},null,512),[[b,n.value.shipment_fees,void 0,{number:!0}]])]),e("div",null,[t[31]||(t[31]=e("label",{class:"block text-sm font-medium mb-2"},"Vendor ",-1)),c(v,{modelValue:q.value,"onUpdate:modelValue":[t[14]||(t[14]=s=>q.value=s),K],items:O.value,"item-title":"name","item-value":"id",label:"Vendor","prepend-inner-icon":"mdi-domain",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])])]),e("div",lt,[e("div",ot,[e("table",nt,[t[33]||(t[33]=e("thead",null,[e("tr",{class:"text-left bg-gray-100"},[e("th",{class:"px-3 py-2 w-1/2"}," Product "),e("th",{class:"px-3 py-2 w-32"}," Quantity "),e("th",{class:"px-3 py-2 w-32"}," Actions ")])],-1)),e("tbody",null,[(r(!0),p(P,null,D(n.value.shipment_items,(s,d)=>(r(),p("tr",{key:d,class:"bg-white even:bg-gray-50"},[e("td",at,[c(S,{modelValue:s.product.sku,"onUpdate:modelValue":[x=>s.product.sku=x,x=>j(s)],items:u(y).productOptions,"item-title":"product_name","item-value":"sku",placeholder:"Select product",density:"compact","hide-details":"",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items"])]),e("td",rt,[m(e("input",{type:"number",min:"1",class:"w-full border rounded px-2 py-1","onUpdate:modelValue":x=>s.quantity_sent=x},null,8,it),[[b,s.quantity_sent,void 0,{number:!0}]])]),e("td",dt,[e("button",{type:"button",class:"px-3 py-1 border rounded hover:bg-gray-100",onClick:x=>T(d)}," Remove ",8,ut)])]))),128)),n.value.shipment_items.length?N("",!0):(r(),p("tr",pt,t[32]||(t[32]=[e("td",{colspan:"3",class:"px-3 py-4 text-gray-500 text-center"}," No products added yet. ",-1)])))])])]),e("div",ct,[e("button",{type:"button",class:"px-4 py-2 border rounded-lg bg-white hover:bg-gray-50",onClick:t[15]||(t[15]=s=>{n.value.shipment_items=n.value.shipment_items||[],n.value.shipment_items.push({product:{name:""},quantity_sent:1})})}," + Add Product "),e("div",mt," Total units: "+l((n.value.shipment_items||[]).reduce((s,d)=>s+(Number(d.quantity_sent)||0),0)),1)])]),e("div",vt,[e("button",{type:"button",onClick:t[16]||(t[16]=s=>V.value=!1),class:"px-4 py-2 border rounded-lg hover:bg-gray-50"}," Cancel "),t[34]||(t[34]=e("button",{type:"submit",class:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700"}," Create Expedition ",-1))])],32)])])):N("",!0),U.value&&a.value?(r(),p("div",gt,[e("div",bt,[e("div",xt,[e("div",yt,[e("h2",_t," Expedition Details #"+l(a.value.id),1),e("button",{onClick:t[17]||(t[17]=s=>U.value=!1),class:"text-gray-500 hover:text-gray-700"},[c(u(ne),{size:24})])])]),e("div",ft,[e("div",ht,[t[46]||(t[46]=e("h3",{class:"font-semibold text-lg mb-4"}," Shipment Information ",-1)),e("div",wt,[e("div",null,[t[36]||(t[36]=e("p",{class:"text-sm text-gray-600"}," Tracking Number ",-1)),e("p",kt,l(a.value.tracking_number),1)]),e("div",null,[t[37]||(t[37]=e("p",{class:"text-sm text-gray-600"}," Transporter ",-1)),e("p",Ct,l(a.value.transporter_name),1)]),e("div",null,[t[38]||(t[38]=e("p",{class:"text-sm text-gray-600"}," Source Country ",-1)),e("p",Vt,l(a.value.source_country),1)]),e("div",null,[t[39]||(t[39]=e("p",{class:"text-sm text-gray-600"}," Destination ",-1)),e("p",St,l(a.value.warehouse.name)+", "+l(a.value.warehouse.country.name),1)]),e("div",null,[t[40]||(t[40]=e("p",{class:"text-sm text-gray-600"}," Shipment Date ",-1)),e("p",Et,l(a.value.shipment_date),1)]),e("div",null,[t[41]||(t[41]=e("p",{class:"text-sm text-gray-600"}," Arrival Date ",-1)),e("p",Pt,l(a.value.arrival_date),1)]),e("div",null,[t[42]||(t[42]=e("p",{class:"text-sm text-gray-600"},"Weight",-1)),e("p",Dt,l(a.value.weight)+" kg ",1)]),e("div",null,[t[43]||(t[43]=e("p",{class:"text-sm text-gray-600"}," Packages ",-1)),e("p",Ut,l(a.value.packages_number),1)]),e("div",null,[t[44]||(t[44]=e("p",{class:"text-sm text-gray-600"},"Fees",-1)),e("p",qt,l(a.value.shipment_fees)+" KES ",1)]),e("div",null,[t[45]||(t[45]=e("p",{class:"text-sm text-gray-600"}," Payment Status ",-1)),e("span",{class:k(["inline-block px-2 py-1 rounded text-xs text-white",a.value.transporter_reimbursement_status==="paid"?"bg-green-500":"bg-red-500"])},l(a.value.transporter_reimbursement_status),3)])])]),e("div",zt,[e("h3",At," Products ("+l(a.value.shipment_items.length)+") ",1),e("div",Nt,[(r(!0),p(P,null,D(a.value.shipment_items,(s,d)=>(r(),p("div",{key:d,class:"bg-white rounded-lg p-3 flex justify-between items-center"},[e("div",null,[e("p",Ft,l(s.product.name),1),e("p",Mt," Quantity: "+l(s.quantity_sent)+" units ",1)]),c(u(de),{class:"text-blue-500",size:20})]))),128))])]),e("div",$t,[t[49]||(t[49]=e("h3",{class:"font-semibold text-lg mb-4"}," Seller Information ",-1)),e("div",jt,[e("div",null,[t[47]||(t[47]=e("p",{class:"text-sm text-gray-600"},"Name",-1)),e("p",Tt,l(a.value.seller.first_name)+" "+l(a.value.seller.last_name),1)]),e("div",null,[t[48]||(t[48]=e("p",{class:"text-sm text-gray-600"}," Username ",-1)),e("p",Ot," @"+l(a.value.seller.username),1)])])])])])])):N("",!0)])]),_:1})}}};export{es as default};
