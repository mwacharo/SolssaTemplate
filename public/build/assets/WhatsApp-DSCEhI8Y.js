import{h as b,r as N,j as Ke,P as zt,i as jt,k as f,c as C,o as p,w as s,b as t,u as a,l as Wt,e as y,f as r,t as m,a as i,Q as k,C as ae,d as _,F as ne,g as ie,m as Le,n as Ze,p as He,V as Et}from"./app-D5kpBR_h.js";import{_ as Bt}from"./AppLayout-Ci4KWlGA.js";import{u as Kt}from"./whatsappStore-BK88zh_Z.js";import{u as Lt}from"./WhatsAppConversation.vue_vue_type_style_index_0_scoped_ad86ab47_lang-CETBkb0n.js";import{u as Zt,W as Ht}from"./WhatsAppConversation-Bv5MBxtB.js";import{u as qt,_ as Jt}from"./Sms--s3FAzwl.js";import Qt from"./AssignDialog-CAT7sBVC.js";import{u as ht,O as Gt}from"./OrderDialogs-CgYluzPA.js";import{n as T}from"./toast-BPZ8LykI.js";import{_ as Xt}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./webrtc-CCYleHi0.js";import"./africastalking-BW8G1Lgs.js";import"./IncomingCallDialog-WyGC1ux6.js";/* empty css                                                                           *//* empty css                                                                     */const Yt={class:"d-flex justify-center align-center mt-2"},el={class:"mb-4"},tl={class:"text-h6 text-primary"},ll={class:"text-h6 text-success"},sl={class:"text-h6 text-info"},ol={class:"text-h6 text-error"},al={class:"mb-4"},nl={class:"text-h6 text-primary"},il={class:"text-h6 text-warning"},rl={class:"text-h6 text-success"},dl={key:1,class:"text-center pa-4"},ul={class:"text-caption text-grey"},ml={class:"d-flex align-center gap-2 flex-wrap"},pl={class:"d-flex align-center justify-space-between flex-wrap gap-2"},gl={class:"d-flex align-center gap-2"},vl={class:"d-flex align-center gap-2 flex-wrap"},fl={key:0,class:"text-caption text-grey"},cl={class:"text-caption text-grey"},_l={key:0,class:"text-caption text-grey"},yl={key:0,class:"text-caption text-grey"},bl={key:0},Cl={class:"text-caption text-grey"},kl={key:1,class:"text-grey"},xl={key:0,class:"text-caption text-grey"},wl={key:0,class:"text-caption text-grey"},Vl={class:"d-flex"},Ol={key:1,class:"text-center pa-4"},Sl={key:0,class:"text-caption text-success"},Dl={class:"text-center"},Al={class:"d-flex flex-column gap-2"},Ml={class:"d-flex align-center w-100"},Fl={class:"flex-grow-1"},Ul={class:"text-h6 mb-0"},$l={class:"text-caption text-grey"},Il={key:1,class:"messages-container",ref:"messagesContainer"},Pl={key:0,class:"pa-4"},Nl={key:0,class:"message-sender text-caption font-weight-medium mb-1"},Tl={class:"message-content"},Rl={key:1,class:"message-media mt-2"},zl={key:2,class:"message-media mt-2"},jl={class:"audio-container"},Wl=["src","onEnded"],El={class:"message-meta d-flex align-center justify-end mt-1"},Bl={class:"text-caption text-grey mr-2"},Kl={key:1,class:"empty-state pa-8 text-center"},Ll={key:0,class:"attachment-preview mb-3"},Zl={class:"message-input-container"},Hl={class:"input-actions d-flex align-center mt-2"},ql={class:"d-flex align-center flex-grow-1"},Jl={key:0,class:"text-caption text-grey ml-2"},Ql={key:0,class:"emoji-picker mt-3 pa-3"},hl={class:"emoji-grid"},Gl={__name:"WhatsApp",setup(Xl){const d=Kt(),Se=Zt(),qe=qt(),n=ht(),G=b(()=>n.tableItems||[]),De=N(null),re=N(!1),E=N([]),X=b(()=>{var o,e;return!((o=E.value)!=null&&o.length)||!((e=G.value)!=null&&e.length)?[]:G.value.filter(g=>E.value.includes(g.id))});Ke(E,(o,e)=>{if(console.log("🔵 Selection changed from:",e,"to:",o),console.log("🔵 Selected orders count:",(o==null?void 0:o.length)||0),(o==null?void 0:o.length)>0){const g=X.value;n.selectedOrders=g,console.log("🔵 Updated orderStore.selectedOrders:",g)}else n.selectedOrders=[]},{deep:!0,immediate:!0});const de=(o,e=[])=>{console.log("🚀 openDialog called with mode:",o),De.value=o,re.value=!0;const g=e.length>0?e:X.value;g&&g.length>0?(console.log("✅ Using orders for dialog:",g.length,"orders"),n.selectedOrders=g):console.log("⚠️ No orders selected for dialog")},Ae=(o=[])=>{console.log("📨 openNewMessageDialog called");const e=o.length>0?o:X.value;if(e.length===0){console.warn("⚠️ No orders selected for messaging"),T.warning("Please select at least one order to send messages.");return}console.log("📨 Opening message dialog for",e.length,"orders"),d.openNewMessageDialog(e)},Je=b(()=>{var o,e;return{selectedIds:E.value,selectedCount:((o=E.value)==null?void 0:o.length)||0,selectedOrders:X.value,tableItemsCount:((e=G.value)==null?void 0:e.length)||0}}),Qe=({mode:o,selected:e,orders:g})=>{console.log("handleConfirm called with:",JSON.stringify({mode:o,selected:e,orders:g})),o==="rider"?he(e,g):o==="agent"?Ge(e,g):o==="status"&&Xe(e,g)},he=async(o,e)=>{try{const g=await axios.post("/api/v1/assign-rider",{rider_id:o,order_ids:e});T.success(g.data.message||"Rider assigned successfully")}catch{T.error("Failed to assign rider")}},Ge=async(o,e)=>{var g,u;try{const w=await axios.post("/api/v1/assign-agent",{agent_id:o,order_ids:e});T.success(w.data.message||"Agent assigned successfully")}catch(w){T.error(((u=(g=w.response)==null?void 0:g.data)==null?void 0:u.message)||"Failed to assign agent")}},Xe=async(o,e)=>{var g,u;try{const w=await axios.post("/api/v1/update-status",{status:o,order_ids:e});T.success(w.data.message||"Status updated successfully")}catch(w){T.error(((u=(g=w.response)==null?void 0:g.data)==null?void 0:u.message)||"Failed to update status")}},Ye=o=>{n.openDialog(o)},B=N(null),ue=N(!1),me=N([]),et=Lt(),Me=b(()=>et.user),K=b(()=>{var o;return(o=Me.value)==null?void 0:o.id});console.log("User:",JSON.stringify(Me.value)),console.log("User ID:",K.value);const tt=[{title:"Order #",key:"order_no"},{title:"Customer",key:"client"},{title:"Vendor",key:"vendor"},{title:"Status",key:"status"},{title:"Delivery Status",key:"delivery_status"},{title:"Items",key:"order_items"},{title:"Total Price",key:"total_price"},{title:"Date Created",key:"created_at"},{title:"Actions",key:"actions",sortable:!1}],lt=[{title:"All Types",value:"all"},{title:"Customer",value:"customer"},{title:"Vendor",value:"vendor"},{title:"Partner",value:"partner"},{title:"Employee",value:"employee"}],st=[{title:"All Statuses",value:"all"},{title:"Active",value:1},{title:"Inactive",value:0}],Fe=b(()=>!n.orderDateRange||n.orderDateRange.length===0?"":n.orderDateRange.length===1?q(n.orderDateRange[0]):`${q(n.orderDateRange[0])} - ${q(n.orderDateRange[1])}`);b(()=>{const o=!!(n.orderFilterStatus||n.orderFilterProduct||n.orderFilterZone||n.orderFilterAgent||n.orderFilterRider||n.orderFilterVendor||n.orderDateRange&&n.orderDateRange.length>0||n.orderSearch);return console.log("🔍 hasActiveFilters:",o),o});const{attachment:U,replyMessage:L,messages:Yl,contacts:ot,orders:at,templates:es,selectedContacts:ts,selectedOrders:Y,selectedTemplate:pe,messageText:ge,currentPage:ls,perPage:ss,totalMessages:nt,totalOrders:os,loading:O,showImportDialog:Z,showNewMessageDialog:as,showOrderImportDialog:H,showOrderMessageDialog:ee,activeTab:R,search:te,filterType:ve,filterStatus:fe,orderFilters:ns,errorMessage:Ue,successMessage:$e,stats:$,whatsappStatus:I,csvFile:ce,orderFile:_e}=zt(d),ye=b(()=>d.filteredContacts);b(()=>d.filteredOrders);const be=b(()=>d.filteredMessages);b(()=>d.validWhatsappContacts),b(()=>d.totalPages),b(()=>d.totalOrderPages),b(()=>d.allTemplates);const le=o=>d.formatPhoneNumber(o),Ie=(o=1)=>d.loadMessages(o),it=()=>d.resetFilters(),Ce=()=>d.sendMessage(K.value),Pe=()=>d.sendOrderMessage({userId:K.value}),rt=()=>d.importContacts({userId:K.value}),dt=()=>d.importOrders({userId:K.value}),ut=()=>d.openOrderMessageDialog(),mt=o=>d.deleteMessage(o),pt=o=>o.reduce((e,g)=>e+(g.quantity||0),0),gt=o=>{window.open(`/api/v1/orders/${o}/print-waybill`,"_blank")},q=o=>o?new Date(o).toLocaleDateString("en-US",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}):"-",vt=(o=!1,e=null)=>{d.errorMessage="",d.messageText="",o?d.selectedContacts=d.selectedContacts:e?d.selectedContacts=[e]:d.selectedContacts=[],(!Array.isArray(d.templates)||d.templates.length===0)&&!d.loading.templates&&d.loadTemplates(),d.showNewMessageDialog=!0},ft=o=>{var e;console.log("sendSms called with:",JSON.stringify(o)),console.log("store methods:",Object.keys(d)),o&&((e=o.client)!=null&&e.phone_number)?(console.log("Calling openDialog with:",o.client.phone_number),qe.openDialog(o.client.phone_number)):(console.log("Missing recipient phone number in item",o),d.errorMessage="Recipient phone number is required.")},ct=o=>{console.log("viewMessageDetails called with:",o),console.log("conversationStore:",Se),o.to?(console.log("Calling openDialog with:",o.to),Se.openDialog(o.to)):console.log("Missing contact ID in message",o)},_t=o=>!!(o.whatsapp||o.alt_phone||o.phone),yt=o=>{alert(`Contact: ${o.name}
Phone: ${o.phone||"N/A"}
WhatsApp: ${o.whatsapp||"N/A"}
Type: ${o.type||"N/A"}
Company: ${o.company_name||"N/A"}
Country: ${o.country_name||"N/A"}`)},bt=o=>({active:"success",inactive:"grey",pending:"warning",processing:"primary",cancelled:"error"})[o==null?void 0:o.toLowerCase()]||"grey",Ct=o=>({inprogress:"warning",delivered:"success",cancelled:"error",pending:"primary",shipped:"info"})[o==null?void 0:o.toLowerCase()]||"grey";Ke(()=>d.search,o=>{o===""&&d.loadMessages(d.currentPage)});function Ne(){var e;if(!B.value)return"Unknown";const o=(e=ot.value)==null?void 0:e.find(g=>g.phone===B.value||g.whatsapp===B.value);return(o==null?void 0:o.name)||B.value}function kt(){return B.value||"-"}function xt(){return I.value==="Connected"?"success":I.value==="Connecting..."?"warning":"error"}function wt(){return I.value||"Unknown"}const z=()=>{j()},Vt=()=>{orderDateMenu.value=!1,j()},Ot=()=>{n.orderDateRange=[],j()},St=()=>{n.clearAllFilters(),j()},j=async()=>{try{console.log("🔍 Applying filters..."),n.loading.orders=!0;const o={status:n.orderFilterStatus,product:n.orderFilterProduct,zone:n.orderFilterZone,agent:n.orderFilterAgent,rider:n.orderFilterRider,vendor:n.orderFilterVendor,dateRange:n.orderDateRange,search:n.orderSearch},e=Object.fromEntries(Object.entries(o).filter(([g,u])=>u!=null&&u!==""&&!(Array.isArray(u)&&u.length===0)));console.log("🧹 Clean filters:",e),await n.loadOrdersWithFilters(e),console.log("✅ Filters applied successfully. Orders loaded:",n.orders.length)}catch(o){handleError(o,"applyFilters")}finally{n.loading.orders=!1}},se=N(!1);function Dt(){se.value=!0}async function At({page:o,itemsPerPage:e,sortBy:g,search:u}){if(e!==n.pagination.itemsPerPage){const S=(n.pagination.page-1)*n.pagination.itemsPerPage+1;n.pagination.page=Math.ceil(S/e)}else n.pagination.page=o;n.pagination.itemsPerPage=e,n.search=u,g&&g.length>0&&(n.sort=g[0]);const w={...n.activeFilters,search:n.search};await n.loadOrdersWithFilters(w)}return jt(async()=>{try{await d.initialize(),await n.initialize(),console.log("✅ All stores initialized successfully"),console.log("🔍 Initial selection state:",Je.value)}catch(o){console.error("❌ Error during initialization:",o)}}),(o,e)=>{const g=f("v-alert"),u=f("v-icon"),w=f("v-avatar"),S=f("v-chip"),J=f("v-divider"),A=f("v-col"),ke=f("v-row"),v=f("v-btn"),x=f("v-card-text"),M=f("v-card"),xe=f("v-tab"),Mt=f("v-tabs"),we=f("v-text-field"),D=f("v-card-title"),oe=f("v-progress-linear"),Ft=f("v-data-table"),Ve=f("v-window-item"),Ut=f("v-data-table-server"),V=f("v-select"),$t=f("v-table"),It=f("v-window"),Pt=f("v-date-picker"),Te=f("v-menu"),W=f("v-spacer"),Q=f("v-card-actions"),P=f("v-dialog"),Oe=f("v-textarea"),Re=f("v-file-input"),ze=f("v-img"),je=f("v-list-item-icon"),We=f("v-list-item-title"),Ee=f("v-list-item-content"),Be=f("v-list-item"),Nt=f("v-list"),Tt=f("v-expand-transition"),Rt=f("v-container");return p(),C(Bt,null,{default:s(()=>[t(a(Wt),{title:"WhatsApp Business - Courier Management"}),t(Rt,{fluid:""},{default:s(()=>[a(Ue)?(p(),C(g,{key:0,type:"error",closable:"",class:"mb-4"},{default:s(()=>[r(m(a(Ue)),1)]),_:1})):y("",!0),a($e)?(p(),C(g,{key:1,type:"success",closable:"",class:"mb-4"},{default:s(()=>[r(m(a($e)),1)]),_:1})):y("",!0),t(ke,null,{default:s(()=>[t(A,{cols:"12",lg:"3"},{default:s(()=>[t(M,{class:"mb-4"},{default:s(()=>[t(x,{class:"text-center"},{default:s(()=>[t(w,{size:"80",color:a(I)==="Connected"?"green":"grey",class:"mb-3"},{default:s(()=>[t(u,{size:"48",color:"white"},{default:s(()=>e[59]||(e[59]=[r("mdi-whatsapp")])),_:1,__:[59]})]),_:1},8,["color"]),e[77]||(e[77]=i("h2",{class:"text-h6"},"WhatsApp Business",-1)),e[78]||(e[78]=i("h3",{class:"text-subtitle-2 text-grey"},"Courier Management System",-1)),i("div",Yt,[t(S,{color:a(I)==="Connected"?"success":a(I)==="Connecting..."?"warning":"error",class:"mr-2"},{default:s(()=>[r(m(a(I)),1)]),_:1},8,["color"])]),t(J,{class:"my-4"}),i("div",el,[e[64]||(e[64]=i("h4",{class:"text-subtitle-1 mb-2"},"Message Stats",-1)),t(ke,null,{default:s(()=>[t(A,{cols:"6",class:"py-1"},{default:s(()=>[e[60]||(e[60]=i("div",{class:"text-subtitle-2"},"Sent",-1)),i("div",tl,m(a($).sent),1)]),_:1,__:[60]}),t(A,{cols:"6",class:"py-1"},{default:s(()=>[e[61]||(e[61]=i("div",{class:"text-subtitle-2"},"Delivered",-1)),i("div",ll,m(a($).delivered),1)]),_:1,__:[61]}),t(A,{cols:"6",class:"py-1"},{default:s(()=>[e[62]||(e[62]=i("div",{class:"text-subtitle-2"},"Read",-1)),i("div",sl,m(a($).read),1)]),_:1,__:[62]}),t(A,{cols:"6",class:"py-1"},{default:s(()=>[e[63]||(e[63]=i("div",{class:"text-subtitle-2"},"Failed",-1)),i("div",ol,m(a($).failed),1)]),_:1,__:[63]})]),_:1})]),t(J,{class:"my-4"}),i("div",al,[e[68]||(e[68]=i("h4",{class:"text-subtitle-1 mb-2"},"Order Stats",-1)),t(ke,null,{default:s(()=>[t(A,{cols:"6",class:"py-1"},{default:s(()=>[e[65]||(e[65]=i("div",{class:"text-subtitle-2"},"Total Orders",-1)),i("div",nl,m(a($).totalOrders),1)]),_:1,__:[65]}),t(A,{cols:"6",class:"py-1"},{default:s(()=>[e[66]||(e[66]=i("div",{class:"text-subtitle-2"},"Pending",-1)),i("div",il,m(a($).pendingOrders),1)]),_:1,__:[66]}),t(A,{cols:"12",class:"py-1"},{default:s(()=>[e[67]||(e[67]=i("div",{class:"text-subtitle-2"},"Delivered",-1)),i("div",rl,m(a($).deliveredOrders),1)]),_:1,__:[67]})]),_:1})]),t(J,{class:"my-4"}),t(v,{color:"primary",block:"",class:"mb-2",onClick:Ae},{default:s(()=>[t(u,{class:"mr-2"},{default:s(()=>e[69]||(e[69]=[r("mdi-message-text")])),_:1,__:[69]}),e[70]||(e[70]=r(" New Message "))]),_:1,__:[70]}),t(v,{color:"success",block:"",class:"mb-2",onClick:ut},{default:s(()=>[t(u,{class:"mr-2"},{default:s(()=>e[71]||(e[71]=[r("mdi-package-variant")])),_:1,__:[71]}),e[72]||(e[72]=r(" Order Messages "))]),_:1,__:[72]}),t(v,{color:"info",block:"",class:"mb-2",onClick:e[0]||(e[0]=l=>Z.value=!0)},{default:s(()=>[t(u,{class:"mr-2"},{default:s(()=>e[73]||(e[73]=[r("mdi-file-import")])),_:1,__:[73]}),e[74]||(e[74]=r(" Import Contacts "))]),_:1,__:[74]}),t(v,{color:"orange",block:"",class:"mb-2",onClick:e[1]||(e[1]=l=>H.value=!0)},{default:s(()=>[t(u,{class:"mr-2"},{default:s(()=>e[75]||(e[75]=[r("mdi-file-excel")])),_:1,__:[75]}),e[76]||(e[76]=r(" Import Orders "))]),_:1,__:[76]})]),_:1,__:[77,78]})]),_:1})]),_:1}),t(A,{cols:"12",lg:"9"},{default:s(()=>[t(M,null,{default:s(()=>[t(Mt,{modelValue:a(R),"onUpdate:modelValue":e[2]||(e[2]=l=>k(R)?R.value=l:null),color:"primary"},{default:s(()=>[t(xe,{value:"messages"},{default:s(()=>[t(u,{class:"mr-2"},{default:s(()=>e[79]||(e[79]=[r("mdi-message-text")])),_:1,__:[79]}),e[80]||(e[80]=r(" Messages "))]),_:1,__:[80]}),t(xe,{value:"orders"},{default:s(()=>[t(u,{class:"mr-2"},{default:s(()=>e[81]||(e[81]=[r("mdi-package-variant")])),_:1,__:[81]}),e[82]||(e[82]=r(" Orders "))]),_:1,__:[82]}),t(xe,{value:"contacts"},{default:s(()=>[t(u,{class:"mr-2"},{default:s(()=>e[83]||(e[83]=[r("mdi-account-multiple")])),_:1,__:[83]}),e[84]||(e[84]=r(" Contacts "))]),_:1,__:[84]})]),_:1},8,["modelValue"]),t(It,{modelValue:a(R),"onUpdate:modelValue":e[18]||(e[18]=l=>k(R)?R.value=l:null)},{default:s(()=>[t(Ve,{value:"messages"},{default:s(()=>[t(D,{class:"d-flex flex-wrap justify-space-between align-center"},{default:s(()=>[e[85]||(e[85]=i("div",{class:"text-h6"},"Recent Messages",-1)),t(we,{modelValue:a(te),"onUpdate:modelValue":e[3]||(e[3]=l=>k(te)?te.value=l:null),"append-icon":"mdi-magnify",label:"Search messages","single-line":"","hide-details":"",density:"compact",class:"max-w-xs mt-2 mt-sm-0",loading:a(O).messages,onKeyup:e[4]||(e[4]=ae(l=>Ie(1),["enter"])),"onClick:clear":e[5]||(e[5]=()=>{te.value="",Ie(1)}),clearable:""},null,8,["modelValue","loading"])]),_:1,__:[85]}),t(x,null,{default:s(()=>[a(O).messages?(p(),C(oe,{key:0,indeterminate:"",color:"primary"})):!Array.isArray(be.value)||be.value.length===0?(p(),_("div",dl,[t(u,{size:"large",color:"grey"},{default:s(()=>e[86]||(e[86]=[r("mdi-message-text-outline")])),_:1,__:[86]}),e[87]||(e[87]=i("p",{class:"text-body-1 mt-2"},"No messages found. Try sending one!",-1))])):(p(),C(Ft,{key:2,headers:[{title:"Content",value:"content",sortable:!1},{title:"Recipient",value:"recipient_name",sortable:!1},{title:"Order #",value:"order_number",sortable:!1},{title:"Status",value:"status",sortable:!0},{title:"Date",value:"sent_at",sortable:!0},{title:"Actions",value:"actions",sortable:!1}],items:be.value,options:o.messageTableOptions,"server-items-length":a(nt),loading:a(O).messages,"item-key":"id",class:"elevation-1","onUpdate:options":o.onMessageTableOptionsChange},{"item.content":s(({item:l})=>[i("span",null,m(l.content),1)]),"item.recipient_name":s(({item:l})=>[i("div",null,m(l.recipient_name||"N/A"),1),i("div",ul,m(le(l.to)),1)]),"item.order_number":s(({item:l})=>[r(m(l.order_number||"-"),1)]),"item.status":s(({item:l})=>{var c;return[t(S,{color:{sent:"primary",delivered:"success",read:"info",failed:"error",pending:"warning"}[(c=l.status)==null?void 0:c.toLowerCase()]||"grey",small:""},{default:s(()=>[r(m(l.status||"Unknown"),1)]),_:2},1032,["color"])]}),"item.sent_at":s(({item:l})=>{var c;return[r(m(l.sent_at||((c=l.created_at)==null?void 0:c.split("T")[0])||"-"),1)]}),"item.actions":s(({item:l})=>[t(v,{icon:"",size:"small",onClick:c=>ct(l)},{default:s(()=>[t(u,null,{default:s(()=>e[88]||(e[88]=[r("mdi-eye")])),_:1,__:[88]})]),_:2},1032,["onClick"]),t(v,{icon:"",size:"small",color:"error",onClick:c=>mt(l.id)},{default:s(()=>[t(u,null,{default:s(()=>e[89]||(e[89]=[r("mdi-delete")])),_:1,__:[89]})]),_:2},1032,["onClick"])]),_:1},8,["items","options","server-items-length","loading","onUpdate:options"]))]),_:1})]),_:1}),t(Ve,{value:"orders"},{default:s(()=>[t(D,{class:"d-flex flex-wrap justify-space-between align-center"},{default:s(()=>[e[91]||(e[91]=i("div",{class:"text-h6"},"Orders",-1)),t(we,{modelValue:a(n).orderSearch,"onUpdate:modelValue":e[6]||(e[6]=l=>a(n).orderSearch=l),"append-icon":"mdi-magnify",label:"Search orders",placeholder:"Client, Order #, Phone","single-line":"","hide-details":"",density:"compact",clearable:"",class:"max-w-xs",loading:a(n).loading.orders,onKeyup:ae(j,["enter"]),"onClick:clear":e[7]||(e[7]=()=>{a(n).orderSearch="",j()})},null,8,["modelValue","loading"]),i("div",ml,[t(v,{icon:"",onClick:Dt,loading:a(n).loading.orders,color:"primary",title:"Apply Filters"},{default:s(()=>[t(u,null,{default:s(()=>e[90]||(e[90]=[r("mdi-filter")])),_:1,__:[90]})]),_:1},8,["loading"])])]),_:1,__:[91]}),a(n).selectedOrders&&a(n).selectedOrders.length>0?(p(),C(x,{key:0,class:"py-2"},{default:s(()=>[t(g,{type:"info",variant:"tonal",class:"mb-0"},{default:s(()=>[i("div",pl,[i("div",gl,[t(u,null,{default:s(()=>e[92]||(e[92]=[r("mdi-checkbox-marked")])),_:1,__:[92]}),i("span",null,m(a(n).selectedOrders.length)+" order(s) selected",1),t(v,{variant:"text",size:"small",onClick:e[8]||(e[8]=l=>a(n).selectedOrders=[])},{default:s(()=>e[93]||(e[93]=[r(" Clear Selection ")])),_:1,__:[93]})]),i("div",vl,[t(v,{color:"error",variant:"outlined",size:"small",onClick:e[9]||(e[9]=l=>o.showBulkDeleteDialog=!0)},{default:s(()=>[t(u,{start:""},{default:s(()=>e[94]||(e[94]=[r("mdi-delete")])),_:1,__:[94]}),e[95]||(e[95]=r(" Delete Selected "))]),_:1,__:[95]}),t(v,{color:"primary",variant:"outlined",size:"small",onClick:e[10]||(e[10]=l=>de("rider",a(n).selectedOrders))},{default:s(()=>[t(u,{start:""},{default:s(()=>e[96]||(e[96]=[r("mdi-motorbike")])),_:1,__:[96]}),e[97]||(e[97]=r(" Assign Rider "))]),_:1,__:[97]}),t(v,{color:"secondary",variant:"outlined",size:"small",onClick:e[11]||(e[11]=l=>de("agent",a(n).selectedOrders))},{default:s(()=>[t(u,{start:""},{default:s(()=>e[98]||(e[98]=[r("mdi-account-tie")])),_:1,__:[98]}),e[99]||(e[99]=r(" Assign Agent "))]),_:1,__:[99]}),t(v,{color:"success",variant:"outlined",size:"small",onClick:e[12]||(e[12]=l=>Ae(a(n).selectedOrders))},{default:s(()=>[t(u,{start:""},{default:s(()=>e[100]||(e[100]=[r("mdi-whatsapp")])),_:1,__:[100]}),e[101]||(e[101]=r(" Send Messages "))]),_:1,__:[101]}),t(v,{color:"warning",variant:"outlined",size:"small",onClick:e[13]||(e[13]=l=>de("status",a(n).selectedOrders))},{default:s(()=>[t(u,{start:""},{default:s(()=>e[102]||(e[102]=[r("mdi-update")])),_:1,__:[102]}),e[103]||(e[103]=r(" Update Status "))]),_:1,__:[103]})])])]),_:1})]),_:1})):y("",!0),t(x,null,{default:s(()=>[a(n).loading.orders?(p(),C(oe,{key:0,indeterminate:"",color:"primary"})):y("",!0),t(Ut,{modelValue:a(n).selectedOrders,"onUpdate:modelValue":e[14]||(e[14]=l=>a(n).selectedOrders=l),"items-per-page":a(n).pagination.itemsPerPage,"onUpdate:itemsPerPage":e[15]||(e[15]=l=>a(n).pagination.itemsPerPage=l),headers:tt,items:G.value,"items-length":a(n).pagination.totalItems,loading:a(n).loading.orders,search:a(n).search,"show-select":"","item-value":"id",class:"elevation-1","onUpdate:options":At},{"item.order_no":s(({item:l})=>[i("strong",null,m(l.order_no),1),l.reference?(p(),_("div",fl," Ref: "+m(l.reference),1)):y("",!0)]),"item.client":s(({item:l})=>{var c,F,h;return[i("div",null,m(((c=l.client)==null?void 0:c.name)||"N/A"),1),i("div",cl,m(le((F=l.client)==null?void 0:F.phone_number)),1),(h=l.client)!=null&&h.city?(p(),_("div",_l,m(l.client.city),1)):y("",!0)]}),"item.vendor":s(({item:l})=>{var c,F;return[i("div",null,m(((c=l.vendor)==null?void 0:c.name)||"N/A"),1),(F=l.vendor)!=null&&F.company_name?(p(),_("div",yl,m(l.vendor.company_name),1)):y("",!0)]}),"item.status":s(({item:l})=>[t(S,{color:bt(l.status),small:""},{default:s(()=>[r(m(l.status||"Unknown"),1)]),_:2},1032,["color"])]),"item.delivery_status":s(({item:l})=>[t(S,{color:Ct(l.delivery_status),small:""},{default:s(()=>[r(m(l.delivery_status||"Unknown"),1)]),_:2},1032,["color"])]),"item.order_items":s(({item:l})=>{var c;return[(c=l.orderItems)!=null&&c.length?(p(),_("div",bl,[r(m(l.orderItems.length)+" item(s) ",1),i("div",Cl," Qty: "+m(pt(l.orderItems)),1),(p(!0),_(ne,null,ie(l.orderItems,F=>{var h;return p(),_("div",{key:F.id,class:"text-caption text-grey"},m(((h=F.product)==null?void 0:h.product_name)||"Product")+" (x"+m(F.quantity)+") ",1)}),128))])):(p(),_("div",kl,"No items"))]}),"item.total_price":s(({item:l})=>[i("div",null," KSH"+m(parseFloat(l.total_price||l.invoice_value||0).toFixed(2)),1),l.shipping_charges&&l.shipping_charges!=="0.00"?(p(),_("div",xl," Shipping: KSH"+m(parseFloat(l.shipping_charges).toFixed(2)),1)):y("",!0)]),"item.created_at":s(({item:l})=>[r(m(q(l.created_at))+" ",1),l.delivery_date?(p(),_("div",wl," Delivery: "+m(q(l.delivery_date)),1)):y("",!0)]),"item.actions":s(({item:l})=>[t(v,{icon:"",size:"small",onClick:c=>Ye(l)},{default:s(()=>[t(u,null,{default:s(()=>e[104]||(e[104]=[r("mdi-eye")])),_:1,__:[104]})]),_:2},1032,["onClick"]),t(v,{icon:"",size:"small",color:"primary",onClick:c=>Pe([l])},{default:s(()=>[t(u,null,{default:s(()=>e[105]||(e[105]=[r("mdi-whatsapp")])),_:1,__:[105]})]),_:2},1032,["onClick"]),t(v,{icon:"",size:"small",color:"info",onClick:c=>gt(l.id)},{default:s(()=>[t(u,null,{default:s(()=>e[106]||(e[106]=[r("mdi-printer")])),_:1,__:[106]})]),_:2},1032,["onClick"]),t(v,{icon:"",size:"small",onClick:c=>ft(l)},{default:s(()=>[t(u,null,{default:s(()=>e[107]||(e[107]=[r("mdi-message-text")])),_:1,__:[107]})]),_:2},1032,["onClick"])]),_:1},8,["modelValue","items-per-page","items","items-length","loading","search"])]),_:1})]),_:1}),t(Ve,{value:"contacts"},{default:s(()=>[t(D,{class:"d-flex flex-wrap justify-space-between align-center"},{default:s(()=>[e[109]||(e[109]=i("div",{class:"text-h6"},"Contacts",-1)),i("div",Vl,[t(V,{modelValue:a(ve),"onUpdate:modelValue":e[16]||(e[16]=l=>k(ve)?ve.value=l:null),items:lt,"item-title":"title","item-value":"value",label:"Type","hide-details":"",density:"compact",class:"mr-2"},null,8,["modelValue"]),t(V,{modelValue:a(fe),"onUpdate:modelValue":e[17]||(e[17]=l=>k(fe)?fe.value=l:null),items:st,"item-title":"title","item-value":"value",label:"Status","hide-details":"",density:"compact"},null,8,["modelValue"]),t(v,{icon:"",class:"ml-2",onClick:it},{default:s(()=>[t(u,null,{default:s(()=>e[108]||(e[108]=[r("mdi-filter-remove")])),_:1,__:[108]})]),_:1})])]),_:1,__:[109]}),t(x,null,{default:s(()=>[a(O).contacts?(p(),C(oe,{key:0,indeterminate:"",color:"primary"})):!Array.isArray(ye.value)||ye.value.length===0?(p(),_("div",Ol,[t(u,{size:"large",color:"grey"},{default:s(()=>e[110]||(e[110]=[r("mdi-account-multiple")])),_:1,__:[110]}),e[111]||(e[111]=i("p",{class:"text-body-1 mt-2"},"No contacts found.",-1))])):(p(),C($t,{key:2},{default:s(()=>[e[114]||(e[114]=i("thead",null,[i("tr",null,[i("th",null,"Name"),i("th",null,"Phone"),i("th",null,"Type"),i("th",null,"Status"),i("th",null,"Company"),i("th",null,"Country"),i("th",{class:"text-center"},"Actions")])],-1)),i("tbody",null,[(p(!0),_(ne,null,ie(ye.value,l=>(p(),_("tr",{key:l.id},[i("td",null,m(l.name),1),i("td",null,[i("div",null,m(le(l.phone)),1),l.whatsapp?(p(),_("div",Sl," WhatsApp: "+m(le(l.whatsapp)),1)):y("",!0)]),i("td",null,m(l.type||"-"),1),i("td",null,[t(S,{color:l.status===1?"success":"grey",small:""},{default:s(()=>[r(m(l.status===1?"Active":"Inactive"),1)]),_:2},1032,["color"])]),i("td",null,m(l.company_name||"-"),1),i("td",null,m(l.country_name||"-"),1),i("td",Dl,[t(v,{icon:"",size:"small",onClick:c=>yt(l)},{default:s(()=>[t(u,null,{default:s(()=>e[112]||(e[112]=[r("mdi-eye")])),_:1,__:[112]})]),_:2},1032,["onClick"]),t(v,{icon:"",size:"small",color:"primary",disabled:!_t(l),onClick:c=>vt(!1,l)},{default:s(()=>[t(u,null,{default:s(()=>e[113]||(e[113]=[r("mdi-whatsapp")])),_:1,__:[113]})]),_:2},1032,["disabled","onClick"])])]))),128))])]),_:1,__:[114]}))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1}),t(P,{modelValue:se.value,"onUpdate:modelValue":e[29]||(e[29]=l=>se.value=l),"max-width":"400","content-class":"custom-filter-dialog",persistent:"",scrollable:""},{default:s(()=>[t(M,null,{default:s(()=>[t(D,null,{default:s(()=>e[115]||(e[115]=[i("span",{class:"text-h6"},"Order Filters",-1)])),_:1,__:[115]}),t(x,null,{default:s(()=>[i("div",Al,[t(V,{modelValue:a(n).orderFilterStatus,"onUpdate:modelValue":[e[19]||(e[19]=l=>a(n).orderFilterStatus=l),z],items:a(n).orderStatusOptions,"item-title":"title","item-value":"value",label:"Status","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(V,{modelValue:a(n).orderFilterProduct,"onUpdate:modelValue":[e[20]||(e[20]=l=>a(n).orderFilterProduct=l),z],items:a(n).productOptions,"item-title":"name","item-value":"id",label:"Product","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(V,{modelValue:a(n).orderFilterZone,"onUpdate:modelValue":[e[21]||(e[21]=l=>a(n).orderFilterZone=l),z],items:a(n).zoneOptions,"item-title":"name","item-value":"id",label:"Zone","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(V,{modelValue:a(n).orderFilterAgent,"onUpdate:modelValue":[e[22]||(e[22]=l=>a(n).orderFilterAgent=l),z],items:a(n).agentOptions,"item-title":"name","item-value":"id",label:"Agent","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(V,{modelValue:a(n).orderFilterRider,"onUpdate:modelValue":[e[23]||(e[23]=l=>a(n).orderFilterRider=l),z],items:a(n).riderOptions,"item-title":"name","item-value":"id",label:"Rider","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(V,{modelValue:a(n).orderFilterVendor,"onUpdate:modelValue":[e[24]||(e[24]=l=>a(n).orderFilterVendor=l),z],items:a(n).vendorOptions,"item-title":"name","item-value":"id",label:"Vendor","hide-details":"",density:"compact",clearable:"",class:"mb-2"},null,8,["modelValue","items"]),t(Te,{modelValue:o.orderDateMenu,"onUpdate:modelValue":e[27]||(e[27]=l=>o.orderDateMenu=l),"close-on-content-click":!1,transition:"scale-transition","offset-y":"","min-width":"auto"},{activator:s(({props:l})=>[t(we,Le({modelValue:Fe.value,"onUpdate:modelValue":e[25]||(e[25]=c=>Fe.value=c),label:"Date Range","prepend-icon":"mdi-calendar",readonly:""},l,{"hide-details":"",density:"compact",clearable:"",class:"mb-2","onClick:clear":Ot}),null,16,["modelValue"])]),default:s(()=>[t(Pt,{modelValue:a(n).orderDateRange,"onUpdate:modelValue":[e[26]||(e[26]=l=>a(n).orderDateRange=l),Vt],range:""},null,8,["modelValue"])]),_:1},8,["modelValue"])])]),_:1}),t(Q,null,{default:s(()=>[t(v,{text:"",color:"primary",onClick:St},{default:s(()=>e[116]||(e[116]=[r("Clear All")])),_:1,__:[116]}),t(W),t(v,{text:"",onClick:e[28]||(e[28]=l=>se.value=!1)},{default:s(()=>e[117]||(e[117]=[r("Close")])),_:1,__:[117]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(P,{modelValue:a(d).showNewMessageDialog,"onUpdate:modelValue":e[34]||(e[34]=l=>a(d).showNewMessageDialog=l),"max-width":"600"},{default:s(()=>[t(M,null,{default:s(()=>[t(D,null,{default:s(()=>e[118]||(e[118]=[i("span",{class:"text-h6"},"Send WhatsApp Message",-1)])),_:1,__:[118]}),t(x,null,{default:s(()=>[t(V,{modelValue:a(d).selectedContacts,"onUpdate:modelValue":e[30]||(e[30]=l=>a(d).selectedContacts=l),items:a(d).validWhatsappContacts,"item-title":"name","item-value":"id",label:"Select Recipients",multiple:"",chips:"",disabled:a(d).loading.contacts,loading:a(d).loading.contacts,"return-object":""},null,8,["modelValue","items","disabled","loading"]),t(V,{modelValue:a(d).selectedTemplate,"onUpdate:modelValue":[e[31]||(e[31]=l=>a(d).selectedTemplate=l),a(d).onTemplateSelect],items:a(d).allTemplates,"item-title":"name","item-value":"id",label:"Select Template","return-object":"",disabled:a(d).loading.templates,loading:a(d).loading.templates,class:"mt-3",clearable:""},null,8,["modelValue","items","disabled","loading","onUpdate:modelValue"]),t(Oe,{modelValue:a(d).messageText,"onUpdate:modelValue":e[32]||(e[32]=l=>a(d).messageText=l),label:"Message",rows:"4","auto-grow":"",class:"mt-3",placeholder:"Type your message or select a template above"},null,8,["modelValue"])]),_:1}),t(Q,null,{default:s(()=>[t(W),t(v,{color:"primary",loading:a(d).loading.sending,onClick:Ce,disabled:!a(d).messageText.trim()},{default:s(()=>e[119]||(e[119]=[r(" Send ")])),_:1,__:[119]},8,["loading","disabled"]),t(v,{text:"",onClick:e[33]||(e[33]=l=>a(d).showNewMessageDialog=!1)},{default:s(()=>e[120]||(e[120]=[r("Cancel")])),_:1,__:[120]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(P,{modelValue:a(ee),"onUpdate:modelValue":e[39]||(e[39]=l=>k(ee)?ee.value=l:null),"max-width":"600"},{default:s(()=>[t(M,null,{default:s(()=>[t(D,null,{default:s(()=>e[121]||(e[121]=[i("span",{class:"text-h6"},"Send Order Message",-1)])),_:1,__:[121]}),t(x,null,{default:s(()=>[t(V,{modelValue:a(Y),"onUpdate:modelValue":e[35]||(e[35]=l=>k(Y)?Y.value=l:null),items:a(at),"item-title":"order_no","item-value":"id",label:"Select Orders",multiple:"",chips:"",disabled:a(O).orders,loading:a(O).orders,"return-object":""},null,8,["modelValue","items","disabled","loading"]),t(V,{modelValue:a(pe),"onUpdate:modelValue":e[36]||(e[36]=l=>k(pe)?pe.value=l:null),items:o.orderTemplates,"item-title":"name","item-value":"name",label:"Select Order Template",onChange:o.p,class:"mt-3","return-object":""},null,8,["modelValue","items","onChange"]),t(Oe,{modelValue:a(ge),"onUpdate:modelValue":e[37]||(e[37]=l=>k(ge)?ge.value=l:null),label:"Message",rows:"4","auto-grow":"",class:"mt-3"},null,8,["modelValue"])]),_:1}),t(Q,null,{default:s(()=>[t(W),t(v,{color:"success",loading:a(O).sending,onClick:Pe},{default:s(()=>e[122]||(e[122]=[r(" Send ")])),_:1,__:[122]},8,["loading"]),t(v,{text:"",onClick:e[38]||(e[38]=l=>ee.value=!1)},{default:s(()=>e[123]||(e[123]=[r("Cancel")])),_:1,__:[123]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(P,{modelValue:a(Z),"onUpdate:modelValue":e[42]||(e[42]=l=>k(Z)?Z.value=l:null),"max-width":"500"},{default:s(()=>[t(M,null,{default:s(()=>[t(D,null,{default:s(()=>e[124]||(e[124]=[i("span",{class:"text-h6"},"Import Contacts",-1)])),_:1,__:[124]}),t(x,null,{default:s(()=>[t(Re,{modelValue:a(ce),"onUpdate:modelValue":e[40]||(e[40]=l=>k(ce)?ce.value=l:null),label:"Select CSV File",accept:".csv","prepend-icon":"mdi-file"},null,8,["modelValue"])]),_:1}),t(Q,null,{default:s(()=>[t(W),t(v,{color:"info",loading:a(O).importing,onClick:rt},{default:s(()=>e[125]||(e[125]=[r(" Import ")])),_:1,__:[125]},8,["loading"]),t(v,{text:"",onClick:e[41]||(e[41]=l=>Z.value=!1)},{default:s(()=>e[126]||(e[126]=[r("Cancel")])),_:1,__:[126]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(P,{modelValue:a(H),"onUpdate:modelValue":e[45]||(e[45]=l=>k(H)?H.value=l:null),"max-width":"500"},{default:s(()=>[t(M,null,{default:s(()=>[t(D,null,{default:s(()=>e[127]||(e[127]=[i("span",{class:"text-h6"},"Import Orders",-1)])),_:1,__:[127]}),t(x,null,{default:s(()=>[t(Re,{modelValue:a(_e),"onUpdate:modelValue":e[43]||(e[43]=l=>k(_e)?_e.value=l:null),label:"Select Excel or CSV File",accept:".csv,.xlsx,.xls","prepend-icon":"mdi-file"},null,8,["modelValue"])]),_:1}),t(Q,null,{default:s(()=>[t(W),t(v,{color:"orange",loading:a(O).uploadingOrders,onClick:dt},{default:s(()=>e[128]||(e[128]=[r(" Import ")])),_:1,__:[128]},8,["loading"]),t(v,{text:"",onClick:e[44]||(e[44]=l=>H.value=!1)},{default:s(()=>e[129]||(e[129]=[r("Cancel")])),_:1,__:[129]})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(P,{modelValue:ue.value,"onUpdate:modelValue":e[57]||(e[57]=l=>ue.value=l),"max-width":"800",persistent:""},{default:s(()=>[t(M,{class:"conversation-dialog"},{default:s(()=>[t(D,{class:"conversation-header pa-4"},{default:s(()=>[i("div",Ml,[t(w,{color:"primary",size:"40",class:"mr-3"},{default:s(()=>[t(u,{color:"white"},{default:s(()=>e[130]||(e[130]=[r("mdi-account")])),_:1,__:[130]})]),_:1}),i("div",Fl,[i("div",Ul,m(Ne()),1),i("div",$l,m(kt()),1)]),t(S,{color:xt(),small:"",outlined:"",class:"mr-2"},{default:s(()=>[r(m(wt()),1)]),_:1},8,["color"]),t(v,{icon:"",onClick:e[46]||(e[46]=l=>ue.value=!1)},{default:s(()=>[t(u,null,{default:s(()=>e[131]||(e[131]=[r("mdi-close")])),_:1,__:[131]})]),_:1})])]),_:1}),t(J),t(x,{class:"pa-0"},{default:s(()=>[a(O).value?(p(),C(oe,{key:0,indeterminate:"",color:"primary"})):(p(),_("div",Il,[Array.isArray(me.value)&&me.value.length?(p(),_("div",Pl,[(p(!0),_(ne,null,ie(me.value,l=>(p(),_("div",{key:l.id,class:Ze(["message-wrapper mb-3",o.getMessageAlignment(l)])},[i("div",{class:Ze(["message-bubble elevation-1",o.getMessageBubbleClass(l)])},[o.isIncomingMessage(l)?(p(),_("div",Nl,m(l.sender_name||Ne()),1)):y("",!0),i("div",Tl,m(l.content),1),l.image_url?(p(),_("div",Rl,[t(ze,{src:l.image_url,"max-height":"200","max-width":"300",contain:"",class:"rounded",onClick:c=>o.openImagePreview(l.image_url),style:{cursor:"pointer"}},null,8,["src","onClick"])])):y("",!0),l.audio_url?(p(),_("div",zl,[i("div",jl,[t(v,{icon:"",small:"",onClick:c=>o.toggleAudio(l.id),class:"mr-2"},{default:s(()=>[t(u,null,{default:s(()=>{var c;return[r(m((c=o.audioStates[l.id])!=null&&c.playing?"mdi-pause":"mdi-play"),1)]}),_:2},1024)]),_:2},1032,["onClick"]),i("audio",{ref_for:!0,ref:`audio-${l.id}`,src:l.audio_url,onEnded:c=>o.onAudioEnded(l.id),style:{display:"none"}},null,40,Wl),e[132]||(e[132]=i("span",{class:"text-caption"},"Voice message",-1))])])):y("",!0),i("div",El,[i("span",Bl,m(o.formatTimestamp(l.created_at||l.timestamp)),1),o.isOutgoingMessage(l)?(p(),C(u,{key:0,color:o.getStatusIconColor(l.message_status),size:"14"},{default:s(()=>[r(m(o.getStatusIcon(l.message_status)),1)]),_:2},1032,["color"])):y("",!0)])],2)],2))),128))])):(p(),_("div",Kl,[t(u,{size:"64",color:"grey lighten-2"},{default:s(()=>e[133]||(e[133]=[r("mdi-message-outline")])),_:1,__:[133]}),e[134]||(e[134]=i("div",{class:"text-h6 mt-4 text-grey"},"No messages yet",-1)),e[135]||(e[135]=i("div",{class:"text-caption text-grey"},"Start the conversation below",-1))]))],512))]),_:1}),t(J),t(x,{class:"reply-section pa-4"},{default:s(()=>[o.hasAttachment?(p(),_("div",Ll,[a(U).image&&a(U).image.length?(p(),C(S,{key:0,close:"","onClick:close":e[47]||(e[47]=l=>a(U).image=null),color:"blue lighten-4",class:"mr-2"},{default:s(()=>{var l;return[t(u,{left:"",small:""},{default:s(()=>e[136]||(e[136]=[r("mdi-image")])),_:1,__:[136]}),r(" "+m((l=a(U).image[0])==null?void 0:l.name),1)]}),_:1})):y("",!0),a(U).audio&&a(U).audio.length?(p(),C(S,{key:1,close:"","onClick:close":e[48]||(e[48]=l=>a(U).audio=null),color:"green lighten-4"},{default:s(()=>{var l;return[t(u,{left:"",small:""},{default:s(()=>e[137]||(e[137]=[r("mdi-microphone")])),_:1,__:[137]}),r(" "+m((l=a(U).audio[0])==null?void 0:l.name),1)]}),_:1})):y("",!0)])):y("",!0),i("div",Zl,[t(Oe,{modelValue:a(L),"onUpdate:modelValue":e[49]||(e[49]=l=>k(L)?L.value=l:null),label:"Type your message...",rows:"2","auto-grow":"",outlined:"",dense:"","hide-details":"",class:"message-input",onKeydown:[ae(He(Ce,["exact","prevent"]),["enter"]),ae(He(o.addNewLine,["shift","exact"]),["enter"])]},null,8,["modelValue","onKeydown"]),i("div",Hl,[i("div",ql,[t(v,{icon:"",small:"",onClick:e[50]||(e[50]=l=>o.showEmojiPicker=!o.showEmojiPicker),class:"mr-2"},{default:s(()=>[t(u,null,{default:s(()=>e[138]||(e[138]=[r("mdi-emoticon-happy-outline")])),_:1,__:[138]})]),_:1}),t(Te,{"offset-y":""},{activator:s(({on:l,attrs:c})=>[t(v,Le({icon:"",small:""},c,Et(l),{class:"mr-2"}),{default:s(()=>[t(u,null,{default:s(()=>e[139]||(e[139]=[r("mdi-attachment")])),_:1,__:[139]})]),_:2},1040)]),default:s(()=>[t(Nt,{dense:""},{default:s(()=>[t(Be,{onClick:e[51]||(e[51]=l=>o.$refs.imageInput.click())},{default:s(()=>[t(je,null,{default:s(()=>[t(u,null,{default:s(()=>e[140]||(e[140]=[r("mdi-image")])),_:1,__:[140]})]),_:1}),t(Ee,null,{default:s(()=>[t(We,null,{default:s(()=>e[141]||(e[141]=[r("Image")])),_:1,__:[141]})]),_:1})]),_:1}),t(Be,{onClick:e[52]||(e[52]=l=>o.$refs.audioInput.click())},{default:s(()=>[t(je,null,{default:s(()=>[t(u,null,{default:s(()=>e[142]||(e[142]=[r("mdi-microphone")])),_:1,__:[142]})]),_:1}),t(Ee,null,{default:s(()=>[t(We,null,{default:s(()=>e[143]||(e[143]=[r("Voice Note")])),_:1,__:[143]})]),_:1})]),_:1})]),_:1})]),_:1}),i("input",{ref:"imageInput",type:"file",accept:"image/*",onChange:e[53]||(e[53]=(...l)=>o.handleImageUpload&&o.handleImageUpload(...l)),style:{display:"none"}},null,544),i("input",{ref:"audioInput",type:"file",accept:"audio/*",onChange:e[54]||(e[54]=(...l)=>o.handleAudioUpload&&o.handleAudioUpload(...l)),style:{display:"none"}},null,544),a(L).length>0?(p(),_("span",Jl,m(a(L).length),1)):y("",!0)]),t(v,{color:"primary",disabled:!o.canSendMessage,onClick:Ce,class:"ml-2",loading:o.sending},{default:s(()=>[t(u,null,{default:s(()=>e[144]||(e[144]=[r("mdi-send")])),_:1,__:[144]})]),_:1},8,["disabled","loading"])]),t(Tt,null,{default:s(()=>[o.showEmojiPicker?(p(),_("div",Ql,[i("div",hl,[(p(!0),_(ne,null,ie(o.commonEmojis,l=>(p(),C(v,{key:l,text:"","x-small":"",onClick:c=>o.appendEmoji(l),class:"emoji-btn"},{default:s(()=>[r(m(l),1)]),_:2},1032,["onClick"]))),128))])])):y("",!0)]),_:1})])]),_:1})]),_:1}),t(P,{modelValue:o.imagePreviewDialog,"onUpdate:modelValue":e[56]||(e[56]=l=>o.imagePreviewDialog=l),"max-width":"90vw"},{default:s(()=>[t(M,null,{default:s(()=>[t(D,{class:"pa-2"},{default:s(()=>[t(W),t(v,{icon:"",onClick:e[55]||(e[55]=l=>o.imagePreviewDialog=!1)},{default:s(()=>[t(u,null,{default:s(()=>e[145]||(e[145]=[r("mdi-close")])),_:1,__:[145]})]),_:1})]),_:1}),t(x,{class:"pa-2"},{default:s(()=>[t(ze,{src:o.previewImageUrl,contain:"","max-height":"80vh"},null,8,["src"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["modelValue"]),t(Qt,{modelValue:re.value,"onUpdate:modelValue":e[58]||(e[58]=l=>re.value=l),mode:De.value,"selected-orders":a(Y),onConfirmed:Qe},null,8,["modelValue","mode","selected-orders"]),t(Ht),t(Jt),t(Gt)]),_:1})]),_:1})}}},xs=Xt(Gl,[["__scopeId","data-v-8bdde92c"]]);export{xs as default};
