import{u as be}from"./countries-bDkwBaJW.js";import{_ as we}from"./AppLayout-mTM0nnTR.js";import{_ as xe}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{r as u,j as ke,k as Se,l as n,c as Ue,o as I,w as a,b as l,a as b,f as r,u as h,t as _,d as J,z as K}from"./app-CmrUdva9.js";import"./webrtc-CyShKedN.js";import"./africastalking-CLbNbfTw.js";import"./IncomingCallDialog-B6537nO8.js";/* empty css                                                                           */const Ae={class:"d-flex justify-space-between align-center"},De={class:"text-center pa-4"},qe={key:0,class:"text-center pa-4"},ze={key:1},Fe={__name:"ViewBranches",setup(Ne){const i=be(),w=u(""),g=u(!1),y=u(!1),x=u(!1),k=u(!1),S=u(!1),D=u(null),q=u(null),V=u(!1),U=u(null),C=u(null),z=u(!1),F=u(!1),d=u({id:null,name:"",code:"",phone_code:"",is_active:!0}),s=u({template_name:"",name:"",phone:"",email:"",address:"",terms:"",footer:""}),p=u({color:"#1976d2",size:"A4"}),Q=[{title:"A4",value:"A4"},{title:"A5",value:"A5"},{title:"Letter",value:"Letter"},{title:"Legal",value:"Legal"}],f=u({show:!1,message:"",color:"success"}),X=[{title:"Name",key:"name",sortable:!0},{title:"Code",key:"code",sortable:!0},{title:"Phone Code",key:"phone_code",sortable:!0},{title:"Status",key:"is_active",sortable:!0},{title:"Actions",key:"actions",sortable:!1,width:"150px"}],Y=[o=>!!o||"Country name is required",o=>o&&o.length>=2||"Country name must be at least 2 characters"],ee=[o=>!!o||"Country code is required",o=>o&&o.length===3||"Country code must be exactly 3 characters",o=>/^[A-Z]{3}$/.test(o)||"Country code must be 3 uppercase letters"],le=[o=>!!o||"Phone code is required",o=>/^\+\d{1,4}$/.test(o)||"Phone code must start with + followed by 1-4 digits"],N=[o=>!!o||"This field is required"],te=[o=>!!o||"Email is required",o=>/.+@.+\..+/.test(o)||"Email must be valid"],oe=[o=>!!o||"Phone is required",o=>/^[\+]?[0-9\-\(\)\s]+$/.test(o)||"Phone must be valid"],ae=ke(()=>{if(!w.value)return i.countries;const o=w.value.toLowerCase();return i.countries.filter(e=>e.name.toLowerCase().includes(o)||e.code.toLowerCase().includes(o)||e.phone_code.includes(o))}),ne=()=>{V.value=!1,M(),g.value=!0},se=o=>{V.value=!0,d.value={...o},g.value=!0},ue=o=>{U.value=o,y.value=!0},re=async o=>{C.value=o,x.value=!0,await me(o.id)},j=()=>{g.value=!1,M()},$=()=>{x.value=!1,C.value=null,L()},M=()=>{d.value={id:null,name:"",code:"",phone_code:"",is_active:!0},K(()=>{D.value&&D.value.resetValidation()})},L=()=>{s.value={template_name:"",name:"",phone:"",email:"",address:"",terms:"",footer:""},p.value={color:"#1976d2",size:"A4"},K(()=>{q.value&&q.value.resetValidation()})},ie=async()=>{if(k.value)try{V.value?(await i.updateCountry(d.value.id,d.value),v("Country updated successfully","success")):(await i.createCountry(d.value),v("Country created successfully","success")),j()}catch(o){v(o.message||"An error occurred","error")}},de=async()=>{try{await i.deleteCountry(U.value.id),v("Country deleted successfully","success"),y.value=!1,U.value=null}catch(o){v(o.message||"An error occurred","error")}},me=async o=>{z.value=!0;try{if(i.getCountrySettings){const e=await i.getCountrySettings(o);e&&(s.value={template_name:e.template_name||"",name:e.name||"",phone:e.phone||"",email:e.email||"",address:e.address||"",terms:e.terms||"",footer:e.footer||""},p.value={color:e.color||"#1976d2",size:e.size||"A4"})}else console.warn("getCountrySettings method not found in store, using default values"),L()}catch(e){console.error("Failed to load settings:",e),v("Failed to load settings","error"),L()}finally{z.value=!1}},ve=async()=>{if(S.value){F.value=!0;try{const o={...s.value,...p.value,country_id:C.value.id};i.saveCountrySettings?(await i.saveCountrySettings(C.value.id,o),v("Settings saved successfully","success"),$()):(console.warn("saveCountrySettings method not found in store, simulating save"),console.log("Would save settings:",o),v("Settings saved successfully (simulated)","success"),$())}catch(o){console.error("Failed to save settings:",o),v(o.message||"Failed to save settings","error")}finally{F.value=!1}}},v=(o,e="success")=>{f.value={show:!0,message:o,color:e}};return Se(()=>{i.fetchCountries()}),(o,e)=>{const m=n("v-btn"),O=n("v-col"),Z=n("v-row"),c=n("v-text-field"),ce=n("v-chip"),pe=n("v-icon"),fe=n("v-data-table"),A=n("v-card"),T=n("v-card-title"),_e=n("v-switch"),G=n("v-form"),E=n("v-card-text"),P=n("v-spacer"),B=n("v-card-actions"),R=n("v-dialog"),ge=n("v-progress-circular"),W=n("v-textarea"),ye=n("v-select"),Ve=n("v-snackbar"),Ce=n("v-container");return I(),Ue(we,{title:"Countries Management"},{default:a(()=>[l(Ce,{fluid:""},{default:a(()=>[l(Z,{class:"mb-4"},{default:a(()=>[l(O,null,{default:a(()=>[b("div",Ae,[e[23]||(e[23]=b("h2",{class:"text-h4"},"Countries",-1)),l(m,{color:"primary","prepend-icon":"mdi-plus",onClick:ne},{default:a(()=>e[22]||(e[22]=[r(" Add Country ")])),_:1,__:[22]})])]),_:1})]),_:1}),l(Z,{class:"mb-4"},{default:a(()=>[l(O,{cols:"12",md:"4"},{default:a(()=>[l(c,{modelValue:w.value,"onUpdate:modelValue":e[0]||(e[0]=t=>w.value=t),"prepend-inner-icon":"mdi-magnify",label:"Search countries...",variant:"outlined",density:"compact",clearable:""},null,8,["modelValue"])]),_:1})]),_:1}),l(A,null,{default:a(()=>[l(fe,{headers:X,items:ae.value,loading:h(i).loading,"items-per-page":10,class:"elevation-1"},{"item.is_active":a(({item:t})=>[l(ce,{color:t.is_active?"success":"error",size:"small"},{default:a(()=>[r(_(t.is_active?"Active":"Inactive"),1)]),_:2},1032,["color"])]),"item.actions":a(({item:t})=>[l(m,{icon:"mdi-pencil",variant:"text",size:"small",color:"primary",onClick:H=>se(t)},null,8,["onClick"]),l(m,{icon:"mdi-cog",variant:"text",size:"small",color:"secondary",onClick:H=>re(t)},null,8,["onClick"]),l(m,{icon:"mdi-delete",variant:"text",size:"small",color:"error",onClick:H=>ue(t)},null,8,["onClick"])]),"no-data":a(()=>[b("div",De,[l(pe,{size:"64",color:"grey"},{default:a(()=>e[24]||(e[24]=[r("mdi-database-off")])),_:1,__:[24]}),e[25]||(e[25]=b("p",{class:"text-h6 mt-2"},"No countries found",-1))])]),_:1},8,["items","loading"])]),_:1}),l(R,{modelValue:g.value,"onUpdate:modelValue":e[6]||(e[6]=t=>g.value=t),"max-width":"500px",persistent:""},{default:a(()=>[l(A,null,{default:a(()=>[l(T,{class:"text-h5"},{default:a(()=>[r(_(V.value?"Edit Country":"Add New Country"),1)]),_:1}),l(E,null,{default:a(()=>[l(G,{ref_key:"form",ref:D,modelValue:k.value,"onUpdate:modelValue":e[5]||(e[5]=t=>k.value=t)},{default:a(()=>[l(c,{modelValue:d.value.name,"onUpdate:modelValue":e[1]||(e[1]=t=>d.value.name=t),label:"Country Name",rules:Y,variant:"outlined",required:""},null,8,["modelValue"]),l(c,{modelValue:d.value.code,"onUpdate:modelValue":e[2]||(e[2]=t=>d.value.code=t),label:"Country Code (ISO 3166-1 alpha-3)",rules:ee,variant:"outlined",maxlength:"3",counter:"3",required:""},null,8,["modelValue"]),l(c,{modelValue:d.value.phone_code,"onUpdate:modelValue":e[3]||(e[3]=t=>d.value.phone_code=t),label:"Phone Code",rules:le,variant:"outlined",placeholder:"+1",required:""},null,8,["modelValue"]),l(_e,{modelValue:d.value.is_active,"onUpdate:modelValue":e[4]||(e[4]=t=>d.value.is_active=t),label:"Active Status",color:"primary",inset:""},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),l(B,null,{default:a(()=>[l(P),l(m,{text:"",onClick:j},{default:a(()=>e[26]||(e[26]=[r(" Cancel ")])),_:1,__:[26]}),l(m,{color:"primary",loading:h(i).loading,disabled:!k.value,onClick:ie},{default:a(()=>[r(_(V.value?"Update":"Create"),1)]),_:1},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:y.value,"onUpdate:modelValue":e[8]||(e[8]=t=>y.value=t),"max-width":"400px"},{default:a(()=>[l(A,null,{default:a(()=>[l(T,{class:"text-h5"},{default:a(()=>e[27]||(e[27]=[r(" Confirm Delete ")])),_:1,__:[27]}),l(E,null,{default:a(()=>{var t;return[e[28]||(e[28]=r(" Are you sure you want to delete ")),b("strong",null,_((t=U.value)==null?void 0:t.name),1),e[29]||(e[29]=r("? This action cannot be undone. "))]}),_:1,__:[28,29]}),l(B,null,{default:a(()=>[l(P),l(m,{text:"",onClick:e[7]||(e[7]=t=>y.value=!1)},{default:a(()=>e[30]||(e[30]=[r(" Cancel ")])),_:1,__:[30]}),l(m,{color:"error",loading:h(i).loading,onClick:de},{default:a(()=>e[31]||(e[31]=[r(" Delete ")])),_:1,__:[31]},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(R,{modelValue:x.value,"onUpdate:modelValue":e[19]||(e[19]=t=>x.value=t),"max-width":"600px",persistent:""},{default:a(()=>[l(A,null,{default:a(()=>[l(T,{class:"text-h5"},{default:a(()=>{var t;return[r(" Waybill Settings for "+_(((t=C.value)==null?void 0:t.name)||""),1)]}),_:1}),l(E,null,{default:a(()=>[z.value?(I(),J("div",qe,[l(ge,{indeterminate:"",color:"primary"})])):(I(),J("div",ze,[l(G,{ref_key:"settingsForm",ref:q,modelValue:S.value,"onUpdate:modelValue":e[18]||(e[18]=t=>S.value=t)},{default:a(()=>[l(c,{modelValue:s.value.template_name,"onUpdate:modelValue":e[9]||(e[9]=t=>s.value.template_name=t),label:"Template Name",rules:N,variant:"outlined",required:""},null,8,["modelValue"]),l(c,{modelValue:s.value.name,"onUpdate:modelValue":e[10]||(e[10]=t=>s.value.name=t),label:"Company Name",rules:N,variant:"outlined",required:""},null,8,["modelValue"]),l(c,{modelValue:s.value.phone,"onUpdate:modelValue":e[11]||(e[11]=t=>s.value.phone=t),label:"Phone",rules:oe,variant:"outlined",required:""},null,8,["modelValue"]),l(c,{modelValue:s.value.email,"onUpdate:modelValue":e[12]||(e[12]=t=>s.value.email=t),label:"Email",rules:te,variant:"outlined",required:""},null,8,["modelValue"]),l(W,{modelValue:s.value.address,"onUpdate:modelValue":e[13]||(e[13]=t=>s.value.address=t),label:"Address",rules:N,variant:"outlined",rows:"2",required:""},null,8,["modelValue"]),l(W,{modelValue:s.value.terms,"onUpdate:modelValue":e[14]||(e[14]=t=>s.value.terms=t),label:"Terms",variant:"outlined",rows:"2"},null,8,["modelValue"]),l(W,{modelValue:s.value.footer,"onUpdate:modelValue":e[15]||(e[15]=t=>s.value.footer=t),label:"Footer",variant:"outlined",rows:"2"},null,8,["modelValue"]),l(c,{modelValue:p.value.color,"onUpdate:modelValue":e[16]||(e[16]=t=>p.value.color=t),label:"Waybill Color",variant:"outlined",placeholder:"#1976d2"},null,8,["modelValue"]),l(ye,{modelValue:p.value.size,"onUpdate:modelValue":e[17]||(e[17]=t=>p.value.size=t),label:"Waybill Size",items:Q,variant:"outlined"},null,8,["modelValue"])]),_:1},8,["modelValue"])]))]),_:1}),l(B,null,{default:a(()=>[l(P),l(m,{text:"",onClick:$},{default:a(()=>e[32]||(e[32]=[r(" Cancel ")])),_:1,__:[32]}),l(m,{color:"primary",loading:F.value,disabled:!S.value,onClick:ve},{default:a(()=>e[33]||(e[33]=[r(" Save Settings ")])),_:1,__:[33]},8,["loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]),l(Ve,{modelValue:f.value.show,"onUpdate:modelValue":e[21]||(e[21]=t=>f.value.show=t),color:f.value.color,timeout:3e3,top:""},{actions:a(()=>[l(m,{text:"",onClick:e[20]||(e[20]=t=>f.value.show=!1)},{default:a(()=>e[34]||(e[34]=[r(" Close ")])),_:1,__:[34]})]),default:a(()=>[r(_(f.value.message)+" ",1)]),_:1},8,["modelValue","color"])]),_:1})]),_:1})}}},Ie=xe(Fe,[["__scopeId","data-v-2a7be5d9"]]);export{Ie as default};
