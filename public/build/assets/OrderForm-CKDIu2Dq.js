import{r as h,R as ke,j as g,s as q,l as p,c as Z,o as z,w as d,b as a,a as r,u as V,f as _,t as O,y as we,e as $,d as P,F as Ue,g as ze,U as Ce}from"./app-EpHsFsPD.js";import{u as xe}from"./orderStore-DO9KDrxZ.js";import{n as D}from"./toast-CcoxBNz6.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";const qe={class:"text-h6"},Oe={class:"mb-6"},Ne={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},Fe={class:"mb-6"},Se={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},Ae={class:"mb-6"},Pe={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},Ie={key:0},Ee={key:1},Re={class:"mb-6"},Te={class:"text-subtitle-1 font-weight-medium mb-3 text-primary"},Be={class:"mt-4"},Me={__name:"OrderForm",emits:["order-saved","dialog-closed","open-call-dialog"],setup(We,{emit:ee}){const I=ee,le=()=>{I("open-call-dialog",l.value.customer_address.phone)},y=xe(),H=h(null),E=h(!1),{dialog:N,isCreateMode:c,selectedOrder:R}=ke(y),F=h(!1),k=h("customer"),m={required:t=>!!t||"This field is required",phone:t=>t?/^[\d\s\-\+\(\)]+$/.test(t)||"Invalid phone number format":!0},te=[{title:"API",value:"api"},{title:"Web",value:"web"},{title:"Mobile App",value:"mobile"},{title:"WhatsApp",value:"whatsapp"},{title:"Facebook",value:"facebook"},{title:"Instagram",value:"instagram"},{title:"Tiktok",value:"tiktok"}],oe=[{title:"Vendor API",value:"vendor_api"},{title:"Customer Web",value:"customer_web"},{title:"Customer Mobile",value:"customer_mobile"},{title:"Agent",value:"agent"},{title:"Call Center",value:"call_center"}],ae=g(()=>y.vendorOptions);g(()=>y.categoryOptions);const T=g(()=>y.cityOptions),B=g(()=>y.zoneOptions),de=g(()=>y.warehouseOptions),K=g(()=>y.statusOptions),j=g(()=>y.selectedOrder),x=g(()=>{if(!l.value.status_id)return[];const t=K.value.find(e=>e.id===l.value.status_id);return(t==null?void 0:t.status_categories)||[]}),se=g(()=>x.value.length?[m.required]:[]),ie=g(()=>l.value.status_category_id?x.value.find(t=>t.id===l.value.status_category_id):null),ue=g(()=>{const t=ie.value,e=t&&t.name==="Follow Up",s=!!l.value.recall_date,i=x.value.find(w=>w.id===l.value.status_category_id),f=i&&i.name==="Follow Up";return e||s||f}),l=h({id:null,order_no:"",reference:"",customer_id:null,vendor_id:null,warehouse_id:null,country_id:null,source:"vendor_api",platform:"api",currency:"KSH",sub_total:"0.00",total_price:"",shipping_charges:"0.00",amount_paid:"0.00",weight:"",paid:!1,tracking_no:null,waybill_no:null,distance:"",geocoded:0,archived_at:null,delivery_date:"",status_id:"",status_category_id:null,status_notes:"",recall_date:"",customer_notes:"",order_items:[],user_total_override:null,customer_address:{full_name:"",phone:"",city_id:"",zone_id:null,address:"",region:"",zipcode:"",email:""},pickup_address:{full_name:"",phone:"",city_id:"",zone_id:null,address:"",region:"",zipcode:"",email:""},dropoff_address:{full_name:"",phone:"",city_id:"",zone_id:null,address:"",region:"",zipcode:"",email:""}}),G=t=>{var U,u,n,v;if(!t)return;let e=t.pickup_address||((U=t.addresses)==null?void 0:U.find(b=>b.type==="pickup"))||{},s=t.dropoff_address||((u=t.addresses)==null?void 0:u.find(b=>b.type==="shipping"))||{},i=t.customer||t.customer_address||t.shipping_address||{};e.full_name||s.full_name?k.value="pickup_dropoff":k.value="customer";let f="",w=t.recall_date||"";t.latest_status?(f=t.latest_status.status_id||"",t.latest_status.status_category_id,t.latest_status.status_notes):(f=t.status_id||"",t.status_category_id,t.status_notes),l.value={id:t.id??null,order_no:t.order_no??"",reference:t.reference??"",customer_id:t.customer_id??null,vendor_id:t.vendor_id??null,warehouse_id:t.warehouse_id??null,country_id:t.country_id??null,source:t.source??"vendor_api",platform:t.platform??"api",currency:t.currency??"KSH",sub_total:t.sub_total??"0.00",total_price:t.total_price??"0.00",shipping_charges:t.shipping_charges??"0.00",amount_paid:t.amount_paid??"0.00",weight:t.weight??"",paid:t.paid??!1,tracking_no:t.tracking_no??null,waybill_no:t.waybill_no??null,distance:t.distance??"",geocoded:t.geocoded??0,archived_at:t.archived_at??null,delivery_date:t.delivery_date??"",status_id:f,status_category_id:((n=t.latest_status)==null?void 0:n.status_category_id)??t.status_category_id??null,status_notes:((v=t.latest_status)==null?void 0:v.status_notes)??t.status_notes??"",recall_date:w,customer_notes:t.customer_notes??"",order_items:(t.order_items||[]).map(b=>({...b,quantity:Number(b.quantity)||1,unit_price:Number(b.unit_price)||0,editable:!0})),customer_address:{full_name:i.full_name??"",phone:i.phone??"",city_id:i.city_id??"",zone_id:i.zone_id??null,address:i.address??"",region:i.region??"",zipcode:i.zipcode??"",email:i.email??""},pickup_address:{full_name:e.full_name??"",phone:e.phone??"",city_id:e.city_id??"",zone_id:e.zone_id??null,address:e.address??"",region:e.region??"",zipcode:e.zipcode??"",email:e.email??""},dropoff_address:{full_name:s.full_name??"",phone:s.phone??"",city_id:s.city_id??"",zone_id:s.zone_id??null,address:s.address??"",region:s.region??"",zipcode:s.zipcode??"",email:s.email??""}}},L=()=>{l.value={order_no:"",total_price:"",sub_total:"0.00",shipping_charges:"0.00",amount_paid:"0.00",reference:"",platform:"api",source:"vendor_api",vendor_id:null,warehouse_id:null,delivery_date:"",status_id:"",status_category_id:null,status_notes:"",recall_date:"",customer_notes:"",order_items:[],customer_address:{full_name:"",phone:"",city_id:"",zone_id:null,address:"",region:"",zipcode:"",email:""},pickup_address:{full_name:"",phone:"",city_id:"",zone_id:null,address:"",region:"",zipcode:"",email:""},dropoff_address:{full_name:"",phone:"",city_id:"",zone_id:null,address:"",region:"",zipcode:"",email:""}},k.value="customer"},ne=t=>{t&&y.fetchDropdownOptions(t)},re=t=>{t==="customer"?(l.value.from_warehouse_id=null,l.value.to_warehouse_id=null,l.value.from_address={city:""},l.value.to_address={city:""}):l.value.customer_address={full_name:"",phone:"",city_id:"",zone_id:null,address:""}},M=()=>{y.closeDialog(),I("dialog-closed")},Q=async()=>{var t,e;if(await((t=H.value)==null?void 0:t.validate())){F.value=!0;try{let s={...l.value};if(k.value==="customer"?(s.customer={...s.customer_address},delete s.customer_address,delete s.pickup_address,delete s.dropoff_address):k.value==="pickup_dropoff"&&(s.pickup_address={...s.pickup_address},s.dropoff_address={...s.dropoff_address},s.addresses=[{type:"pickup",...s.pickup_address},{type:"shipping",...s.dropoff_address}],delete s.customer_address),Array.isArray(s.order_items)&&(s.order_items=s.order_items.map(i=>({...i,quantity:Number(i.quantity)||1,unit_price:Number(i.unit_price)||0}))),c.value)await y.createOrder(s);else if((e=j.value)!=null&&e.id)await y.updateOrder(j.value.id,s);else throw new Error("No order selected for editing.");D.success(c.value?"Order created successfully":"Order updated successfully"),I("order-saved"),M()}catch(s){D.error(c.value?"Failed to create order":"Failed to update order"),console.error("Error saving order:",s)}finally{F.value=!1}}},Y=()=>{const t=l.value.order_items;return!t||t.length===0?"0.00":t.some(i=>i.unit_price===null||i.unit_price===void 0)&&!l.value.user_total_override?Number(l.value.total_price||0).toFixed(2):t.reduce((i,f)=>{const w=Number(f.unit_price)||0,U=Number(f.quantity)||0;return i+w*U},0).toFixed(2)},me=t=>{l.value.user_total_override=Number(t),l.value.total_price=Number(t).toFixed(2),l.value.sub_total=Number(t).toFixed(2)},S=()=>{if(!l.value.user_total_override){const t=Y();l.value.total_price=t,l.value.sub_total=t}},pe=()=>{l.value.order_items.push({sku:"",quantity:1,unit_price:0,editable:!0}),S()},_e=t=>{l.value.order_items.splice(t,1),S()};return q(()=>l.value.order_items,t=>{t&&t.length>0&&S()},{deep:!0}),q(()=>R.value,t=>{t&&!c.value&&(console.log("Selected order changed:",t),G(t))},{immediate:!0,deep:!0}),q(()=>c.value,t=>{t&&(console.log("Switching to create mode"),L())},{immediate:!0}),q(()=>N.value,t=>{t&&(c.value?L():R.value&&G(R.value))}),q(()=>l.value.status_id,(t,e)=>{t!==e&&e!==void 0&&(x.value.some(i=>i.id===l.value.status_category_id)||(l.value.status_category_id=null))}),(t,e)=>{const s=p("v-icon"),i=p("v-spacer"),f=p("v-btn"),w=p("v-card-title"),U=p("v-divider"),u=p("v-text-field"),n=p("v-col"),v=p("v-select"),b=p("v-row"),A=p("v-textarea"),J=p("v-radio"),ce=p("v-radio-group"),W=p("v-card"),ve=p("v-autocomplete"),fe=p("v-table"),ye=p("v-form"),be=p("v-card-text"),Ve=p("v-card-actions"),ge=p("v-dialog");return z(),Z(ge,{modelValue:V(N),"onUpdate:modelValue":e[39]||(e[39]=o=>Ce(N)?N.value=o:null),"max-width":"800",persistent:""},{default:d(()=>[a(W,null,{default:d(()=>[a(w,{class:"d-flex align-center"},{default:d(()=>[a(s,{class:"mr-2",color:V(c)?"success":"primary"},{default:d(()=>[_(O(V(c)?"mdi-plus-circle":"mdi-pencil"),1)]),_:1},8,["color"]),r("span",qe,O(V(c)?"Create New Order":"Edit Order"),1),a(i),a(f,{icon:"mdi-close",variant:"text",onClick:M})]),_:1}),a(U),a(be,{class:"pa-6"},{default:d(()=>[a(ye,{ref_key:"formRef",ref:H,modelValue:E.value,"onUpdate:modelValue":e[38]||(e[38]=o=>E.value=o),onSubmit:we(Q,["prevent"])},{default:d(()=>[r("div",Oe,[r("h3",Ne,[a(s,{class:"mr-1",size:"small"},{default:d(()=>e[40]||(e[40]=[_("mdi-information")])),_:1,__:[40]}),e[41]||(e[41]=_(" Basic Information "))]),a(b,null,{default:d(()=>[a(n,{cols:"12",md:"6"},{default:d(()=>[a(u,{modelValue:l.value.order_no,"onUpdate:modelValue":e[0]||(e[0]=o=>l.value.order_no=o),label:"Order Number",placeholder:"Enter order number"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.status_id,"onUpdate:modelValue":e[1]||(e[1]=o=>l.value.status_id=o),items:K.value,"item-title":"name","item-value":"id",label:"Status","prepend-inner-icon":"mdi-flag",variant:"outlined",density:"comfortable",rules:[m.required],clearable:"",placeholder:"Select status"},null,8,["modelValue","items","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.status_category_id,"onUpdate:modelValue":e[2]||(e[2]=o=>l.value.status_category_id=o),items:x.value,"item-title":"name","item-value":"id",label:"Status Category","prepend-inner-icon":"mdi-flag",variant:"outlined",density:"comfortable",rules:se.value,clearable:"",placeholder:"Select status category"},null,8,["modelValue","items","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(u,{modelValue:l.value.status_notes,"onUpdate:modelValue":e[3]||(e[3]=o=>l.value.status_notes=o),label:"Status Notes",placeholder:"Enter status notes",type:"text","prepend-inner-icon":"mdi-note-text",variant:"outlined",density:"comfortable",clearable:""},null,8,["modelValue"])]),_:1}),ue.value?(z(),Z(n,{key:0,cols:"12",md:"6"},{default:d(()=>[a(u,{modelValue:l.value.recall_date,"onUpdate:modelValue":e[4]||(e[4]=o=>l.value.recall_date=o),label:"Recall Date",type:"datetime-local","prepend-inner-icon":"mdi-calendar",variant:"outlined",density:"comfortable",clearable:"",rules:[m.required]},null,8,["modelValue","rules"])]),_:1})):$("",!0),a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.platform,"onUpdate:modelValue":e[5]||(e[5]=o=>l.value.platform=o),items:te,label:"Platform","prepend-inner-icon":"mdi-devices",variant:"outlined",density:"comfortable",rules:[m.required]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.source,"onUpdate:modelValue":e[6]||(e[6]=o=>l.value.source=o),items:oe,label:"Order Source","prepend-inner-icon":"mdi-source-branch",variant:"outlined",density:"comfortable",rules:[m.required]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(u,{modelValue:l.value.delivery_date,"onUpdate:modelValue":e[7]||(e[7]=o=>l.value.delivery_date=o),label:"Delivery Date",type:"datetime-local","prepend-inner-icon":"mdi-calendar-clock",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),_:1}),a(n,{cols:"12"},{default:d(()=>[a(A,{modelValue:l.value.customer_notes,"onUpdate:modelValue":e[8]||(e[8]=o=>l.value.customer_notes=o),label:"Customer Notes",placeholder:"Enter any special instructions or notes",rows:"4",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1})]),r("div",Fe,[r("h3",Se,[a(s,{class:"mr-1",size:"small"},{default:d(()=>e[42]||(e[42]=[_("mdi-store")])),_:1,__:[42]}),e[43]||(e[43]=_(" Vendor & Warehouse "))]),a(b,null,{default:d(()=>[a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.vendor_id,"onUpdate:modelValue":[e[9]||(e[9]=o=>l.value.vendor_id=o),ne],items:ae.value,"item-title":"name","item-value":"id",label:"Vendor","prepend-inner-icon":"mdi-domain",variant:"outlined",density:"comfortable",rules:[m.required]},null,8,["modelValue","items","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.warehouse_id,"onUpdate:modelValue":e[10]||(e[10]=o=>l.value.warehouse_id=o),items:de.value,"item-title":"name","item-value":"id",label:"Warehouse","prepend-inner-icon":"mdi-warehouse",variant:"outlined",density:"comfortable",rules:[m.required]},null,8,["modelValue","items","rules"])]),_:1})]),_:1})]),r("div",Ae,[r("h3",Pe,[a(s,{class:"mr-1",size:"small"},{default:d(()=>e[44]||(e[44]=[_("mdi-map-marker")])),_:1,__:[44]}),e[45]||(e[45]=_(" Address Information "))]),a(ce,{modelValue:k.value,"onUpdate:modelValue":[e[11]||(e[11]=o=>k.value=o),re],inline:"",class:"mb-4"},{default:d(()=>[a(J,{label:"Pickup & Drop-off",value:"pickup_dropoff",color:"primary"}),a(J,{label:"Customer Delivery",value:"customer",color:"primary"})]),_:1},8,["modelValue"]),k.value==="pickup_dropoff"?(z(),P("div",Ie,[a(b,null,{default:d(()=>[a(n,{cols:"12",md:"6"},{default:d(()=>[a(W,{variant:"outlined",class:"pa-4"},{default:d(()=>[a(w,{class:"text-subtitle-2 pa-0 mb-3"},{default:d(()=>[a(s,{class:"mr-1",color:"orange"},{default:d(()=>e[46]||(e[46]=[_("mdi-map-marker-up")])),_:1,__:[46]}),e[47]||(e[47]=_(" Pickup Address "))]),_:1,__:[47]}),a(u,{modelValue:l.value.pickup_address.full_name,"onUpdate:modelValue":e[12]||(e[12]=o=>l.value.pickup_address.full_name=o),label:"Full Name","prepend-inner-icon":"mdi-account",variant:"outlined",density:"comfortable",rules:[m.required],class:"mb-3"},null,8,["modelValue","rules"]),a(u,{modelValue:l.value.pickup_address.phone,"onUpdate:modelValue":e[13]||(e[13]=o=>l.value.pickup_address.phone=o),label:"Phone Number","prepend-inner-icon":"mdi-phone",variant:"outlined",density:"comfortable",rules:[m.required,m.phone],class:"mb-3"},null,8,["modelValue","rules"]),a(u,{modelValue:l.value.pickup_address.email,"onUpdate:modelValue":e[14]||(e[14]=o=>l.value.pickup_address.email=o),label:"Email","prepend-inner-icon":"mdi-email",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),a(v,{modelValue:l.value.pickup_address.city_id,"onUpdate:modelValue":e[15]||(e[15]=o=>l.value.pickup_address.city_id=o),items:T.value,"item-title":"name","item-value":"id",label:"City","prepend-inner-icon":"mdi-city",variant:"outlined",density:"comfortable",rules:[m.required],class:"mb-3"},null,8,["modelValue","items","rules"]),a(v,{modelValue:l.value.pickup_address.zone_id,"onUpdate:modelValue":e[16]||(e[16]=o=>l.value.pickup_address.zone_id=o),items:B.value,"item-title":"name","item-value":"id",label:"Zone","prepend-inner-icon":"mdi-map-marker-radius",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue","items"]),a(u,{modelValue:l.value.pickup_address.region,"onUpdate:modelValue":e[17]||(e[17]=o=>l.value.pickup_address.region=o),label:"Region","prepend-inner-icon":"mdi-map",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),a(u,{modelValue:l.value.pickup_address.zipcode,"onUpdate:modelValue":e[18]||(e[18]=o=>l.value.pickup_address.zipcode=o),label:"Zip Code","prepend-inner-icon":"mdi-numeric",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),a(A,{modelValue:l.value.pickup_address.address,"onUpdate:modelValue":e[19]||(e[19]=o=>l.value.pickup_address.address=o),label:"Full Address","prepend-inner-icon":"mdi-home",variant:"outlined",density:"comfortable",rows:"2",rules:[m.required]},null,8,["modelValue","rules"])]),_:1})]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(W,{variant:"outlined",class:"pa-4"},{default:d(()=>[a(w,{class:"text-subtitle-2 pa-0 mb-3"},{default:d(()=>[a(s,{class:"mr-1",color:"green"},{default:d(()=>e[48]||(e[48]=[_("mdi-map-marker-down")])),_:1,__:[48]}),e[49]||(e[49]=_(" Drop-off Address "))]),_:1,__:[49]}),a(u,{modelValue:l.value.dropoff_address.full_name,"onUpdate:modelValue":e[20]||(e[20]=o=>l.value.dropoff_address.full_name=o),label:"Full Name","prepend-inner-icon":"mdi-account",variant:"outlined",density:"comfortable",rules:[m.required],class:"mb-3"},null,8,["modelValue","rules"]),a(u,{modelValue:l.value.dropoff_address.phone,"onUpdate:modelValue":e[21]||(e[21]=o=>l.value.dropoff_address.phone=o),label:"Phone Number","prepend-inner-icon":"mdi-phone",variant:"outlined",density:"comfortable",rules:[m.required,m.phone],class:"mb-3"},null,8,["modelValue","rules"]),a(u,{modelValue:l.value.dropoff_address.email,"onUpdate:modelValue":e[22]||(e[22]=o=>l.value.dropoff_address.email=o),label:"Email","prepend-inner-icon":"mdi-email",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),a(v,{modelValue:l.value.dropoff_address.city_id,"onUpdate:modelValue":e[23]||(e[23]=o=>l.value.dropoff_address.city_id=o),items:T.value,"item-title":"name","item-value":"id",label:"City","prepend-inner-icon":"mdi-city",variant:"outlined",density:"comfortable",rules:[m.required],class:"mb-3"},null,8,["modelValue","items","rules"]),a(v,{modelValue:l.value.dropoff_address.zone_id,"onUpdate:modelValue":e[24]||(e[24]=o=>l.value.dropoff_address.zone_id=o),items:B.value,"item-title":"name","item-value":"id",label:"Zone","prepend-inner-icon":"mdi-map-marker-radius",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue","items"]),a(u,{modelValue:l.value.dropoff_address.region,"onUpdate:modelValue":e[25]||(e[25]=o=>l.value.dropoff_address.region=o),label:"Region","prepend-inner-icon":"mdi-map",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),a(u,{modelValue:l.value.dropoff_address.zipcode,"onUpdate:modelValue":e[26]||(e[26]=o=>l.value.dropoff_address.zipcode=o),label:"Zip Code","prepend-inner-icon":"mdi-numeric",variant:"outlined",density:"comfortable",class:"mb-3"},null,8,["modelValue"]),a(A,{modelValue:l.value.dropoff_address.address,"onUpdate:modelValue":e[27]||(e[27]=o=>l.value.dropoff_address.address=o),label:"Full Address","prepend-inner-icon":"mdi-home",variant:"outlined",density:"comfortable",rows:"2",rules:[m.required]},null,8,["modelValue","rules"])]),_:1})]),_:1})]),_:1})])):k.value==="customer"?(z(),P("div",Ee,[a(b,null,{default:d(()=>[a(n,{cols:"12",md:"6"},{default:d(()=>[a(u,{modelValue:l.value.customer_address.full_name,"onUpdate:modelValue":e[28]||(e[28]=o=>l.value.customer_address.full_name=o),label:"Customer Name","prepend-inner-icon":"mdi-account",variant:"outlined",density:"comfortable",rules:[m.required]},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(u,{modelValue:l.value.customer_address.phone,"onUpdate:modelValue":e[29]||(e[29]=o=>l.value.customer_address.phone=o),label:"Phone Number","prepend-inner-icon":"mdi-phone",variant:"outlined",density:"comfortable",rules:[m.required,m.phone],"onClick:prependInner":e[30]||(e[30]=o=>le(l.value.customer_address.phone))},null,8,["modelValue","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.customer_address.city_id,"onUpdate:modelValue":e[31]||(e[31]=o=>l.value.customer_address.city_id=o),items:T.value,"item-title":"name","item-value":"id",label:"City","prepend-inner-icon":"mdi-city",variant:"outlined",density:"comfortable",rules:[m.required]},null,8,["modelValue","items","rules"])]),_:1}),a(n,{cols:"12",md:"6"},{default:d(()=>[a(v,{modelValue:l.value.customer_address.zone_id,"onUpdate:modelValue":e[32]||(e[32]=o=>l.value.customer_address.zone_id=o),items:B.value,"item-title":"name","item-value":"id",label:"Zone","prepend-inner-icon":"mdi-map-marker-radius",variant:"outlined",density:"comfortable"},null,8,["modelValue","items"])]),_:1}),a(n,{cols:"12"},{default:d(()=>[a(A,{modelValue:l.value.customer_address.address,"onUpdate:modelValue":e[33]||(e[33]=o=>l.value.customer_address.address=o),label:"Full Address","prepend-inner-icon":"mdi-home",variant:"outlined",density:"comfortable",rows:"2",rules:[m.required]},null,8,["modelValue","rules"])]),_:1})]),_:1})])):$("",!0)]),r("div",Re,[r("h3",Te,[a(s,{class:"mr-1",size:"small"},{default:d(()=>e[50]||(e[50]=[_("mdi-package-variant")])),_:1,__:[50]}),e[51]||(e[51]=_(" Order Items "))]),a(fe,{density:"comfortable",class:"mb-2"},{default:d(()=>[e[52]||(e[52]=r("thead",null,[r("tr",null,[r("th",{style:{width:"30%"}},"Product"),r("th",{style:{width:"15%"}},"Quantity"),r("th",{style:{width:"15%"}},"Unit Price"),r("th",{style:{width:"15%"}},"Total"),r("th",{style:{width:"10%"}})])],-1)),r("tbody",null,[(z(!0),P(Ue,null,ze(l.value.order_items||[],(o,X)=>(z(),P("tr",{key:o.id||X},[r("td",null,[a(ve,{modelValue:o.sku,"onUpdate:modelValue":C=>o.sku=C,items:V(y).productOptions,"item-title":"product_name","item-value":"sku",placeholder:"Product name",density:"compact","hide-details":"",variant:"outlined",readonly:!V(c)&&!o.editable},null,8,["modelValue","onUpdate:modelValue","items","readonly"])]),r("td",null,[a(u,{modelValue:o.quantity,"onUpdate:modelValue":C=>o.quantity=C,modelModifiers:{number:!0},type:"number",min:"1",density:"compact","hide-details":"",variant:"outlined",readonly:!V(c)&&!o.editable},null,8,["modelValue","onUpdate:modelValue","readonly"])]),r("td",null,[a(u,{modelValue:o.unit_price,"onUpdate:modelValue":C=>o.unit_price=C,modelModifiers:{number:!0},type:"number",min:"0",step:"0.01",density:"compact","hide-details":"",variant:"outlined",readonly:!V(c)&&!o.editable},null,8,["modelValue","onUpdate:modelValue","readonly"])]),r("td",null,O((o.quantity*o.unit_price).toFixed(2)),1),r("td",null,[V(c)||o.editable!==!1?(z(),Z(f,{key:0,icon:"mdi-delete",size:"small",color:"error",variant:"text",onClick:C=>_e(X)},null,8,["onClick"])):$("",!0)])]))),128))])]),_:1,__:[52]}),a(f,{color:"primary",variant:"text","prepend-icon":"mdi-plus",onClick:pe,class:"mt-2"},{default:d(()=>e[53]||(e[53]=[_(" Add Item ")])),_:1,__:[53]})]),r("div",Be,[a(b,null,{default:d(()=>[a(n,{cols:"12",md:"4"},{default:d(()=>[a(u,{modelValue:l.value.user_total_override,"onUpdate:modelValue":e[34]||(e[34]=o=>l.value.user_total_override=o),label:"Total",type:"number",variant:"outlined",density:"comfortable",onInput:e[35]||(e[35]=o=>me(o)),readonly:l.value.is_imported&&l.value.order_items.some(o=>o.unit_price===null),hint:"You can override manually if all prices are available"},null,8,["modelValue","readonly"])]),_:1}),a(n,{cols:"12",md:"4"},{default:d(()=>[a(u,{modelValue:l.value.shipping_charges,"onUpdate:modelValue":[e[36]||(e[36]=o=>l.value.shipping_charges=o),e[37]||(e[37]=o=>S())],label:"Shipping Charges",type:"number",min:"0",step:"0.01",variant:"outlined",density:"comfortable"},null,8,["modelValue"])]),_:1}),a(n,{cols:"12",md:"4"},{default:d(()=>[a(u,{"model-value":(parseFloat(Y())+parseFloat(l.value.shipping_charges||0)).toFixed(2),label:"Grand Total",variant:"outlined",density:"comfortable",readonly:""},null,8,["model-value"])]),_:1})]),_:1})])]),_:1},8,["modelValue"])]),_:1}),a(U),a(Ve,{class:"pa-4"},{default:d(()=>[a(i),a(f,{variant:"outlined",onClick:M,disabled:F.value},{default:d(()=>e[54]||(e[54]=[_(" Cancel ")])),_:1,__:[54]},8,["disabled"]),a(f,{color:V(c)?"success":"primary",variant:"flat",onClick:Q,loading:F.value,disabled:!E.value},{default:d(()=>[a(s,{class:"mr-1"},{default:d(()=>[_(O(V(c)?"mdi-plus":"mdi-content-save"),1)]),_:1}),_(" "+O(V(c)?"Create Order":"Save Changes"),1)]),_:1},8,["color","loading","disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},je=he(Me,[["__scopeId","data-v-43c71fcb"]]);export{je as default};
